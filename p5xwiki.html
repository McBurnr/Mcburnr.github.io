<!DOCTYPE html>
<html lang="en">
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Teko:wght@500;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <title>P5X Wiki - by McBurn</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Text:wght@400;600&display=swap');
    
:root {
    --primary-color: #ff0000;
    --primary-color-dark: #cc0000;
    --gradient-primary: rgba(255, 0, 0, 0.9);
    --shadow-color-light: rgba(255, 0, 0, 0.3);
    --shadow-color-medium: rgba(255, 0, 0, 0.4);
    /* New background image */
    --background-image: url('https://cdn.imgchest.com/files/yrgcn9bo2q4.png');
}

    body.theme-blue {
        --primary-color: #0055ff;
        --primary-color-dark: #0033cc;
        --gradient-primary: rgba(0, 85, 255, 0.9);
        --shadow-color-light: rgba(0, 85, 255, 0.3);
        --shadow-color-medium: rgba(0, 85, 255, 0.4);
        --background-image: url('https://cdn.imgchest.com/files/4jdcv9p3ko4.png');
    }

    html {
        scrollbar-width: thin;
        scrollbar-color: var(--primary-color) #0a0a0a;
    }

    html::-webkit-scrollbar {
        width: 10px;
    }
    html::-webkit-scrollbar-track {
        background: #0a0a0a;
    }
    html::-webkit-scrollbar-thumb {
        background-color: var(--primary-color);
        border-radius: 5px;
    }
    html::-webkit-scrollbar-thumb:hover {
        background-color: var(--primary-color-dark);
    }
    
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

body {
    font-family: 'Crimson Text', serif;
    background: #0a0a0a;
    color: #fff;
    overflow-x: hidden;
    min-height: 100vh;
    padding-top: 90px; 
}
    .background {
        position: fixed;
        top: 0;
        left: 0;
        width: 200%;
        height: 100%;
        background-image: var(--background-image);
        background-repeat: repeat-x;
        background-size: auto 100%;
        z-index: -1;
        opacity: 0.3;
    }

.header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    padding: 0.75rem 1.5rem;
    background: linear-gradient(135deg, var(--gradient-primary), rgba(15, 15, 15, 0.95));
    box-shadow: 0 4px 20px var(--shadow-color-light);
    z-index: 50;
    display: flex;
    align-items: center;
}

.header-text {
    display: flex;
    flex-wrap: wrap; /* Allows items to wrap on smaller screens */
    align-items: center;
    gap: 1rem; /* Adds space between the title, author, and badge */
}

.header-text h1 {
    font-size: 1.3rem;
    margin-bottom: 0; /* Removed margin to help with alignment */
}

.header-text p {
    font-size: 0.8rem;
    margin-bottom: 0; /* Removed margin */
}
    
    .header h1 {
        font-family: 'Cinzel', serif;
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary-color);
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        margin-bottom: 0.1rem;
    }

    .header p {
        font-size: 0.9rem;
        color: #ccc;
        font-weight: 600;
    }
	
	#header-info img {
    height: 24px;
}
.site-wrapper {
    width: 100%; /* THIS BROKE THE ENTIRE WEBSITE WTF */
    padding: 0; /* THIS TOO */
    transition: margin-left 0.3s ease-in-out;
}

.guide-card:not(:nth-child(2n)) {
    border-right-color: var(--primary-color);
}

.guide-card:nth-child(-n+2) {
    border-bottom-color: var(--primary-color);
}

.side-nav {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.25rem;
    position: sticky;
    top: 81px;
    align-self: start;
}
.main-content-area {
    min-width: 0;
}
.main-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 1.5rem 1.5rem 1.5rem;
}

.guide-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    background: rgba(30,30,30,0.5);
    border: 2px solid var(--shadow-color-light);
    padding: 0.5rem;
    aspect-ratio: 1 / 1;
}

.guide-card:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 12px 30px var(--shadow-color-medium);
    z-index: 10;
}
    
.guide-card.active {
    border-color: var(--primary-color);
    box-shadow: 0 8px 25px var(--shadow-color-medium);
}

.guide-card-icon {
    width: 50px;
    height: 50px;
    object-fit: cover;
    border-radius: 50%;
    transition: all 0.3s ease;
    margin-bottom: 0.25rem;
    border: 2px solid transparent;
}

.guide-card-name {
    font-family: 'Cinzel', serif;
    font-size: 0.8rem;
    font-weight: 600;
    color: #fff;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
    text-align: center;
    width: 100%;
}

.guide-content-panel {
    display: none;
    padding: 1.5rem;
    margin-top: 0; /* This is important. Or is it? */
    background: rgba(10, 10, 10, 0.85);
    border-radius: 15px;
    border: 1px solid var(--shadow-color-light);
    animation: fadeIn 0.5s ease;
}


    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .guide-content-panel.active {
        display: block;
    }

    .guide-content-panel h2 {
        font-size: 1.8rem;
        margin-bottom: 1.5rem;
        color: var(--primary-color);
        border-left: 4px solid var(--primary-color);
        padding-left: 1rem;
    }
    
    .guide-content-panel h3 {
        font-size: 1.4rem;
        margin-top: 2rem;
        margin-bottom: 1rem;
    }

    .arcana-tabs {
        display: flex;
        border-bottom: 2px solid var(--shadow-color-medium);
        margin-bottom: 2rem;
    }

    .arcana-tab {
        padding: 1rem 1.5rem;
        cursor: pointer;
        background: transparent;
        border: none;
        color: #ccc;
        font-family: 'Cinzel', serif;
        font-size: 1.1rem;
        font-weight: 600;
        border-bottom: 3px solid transparent;
        transition: all 0.3s ease;
    }

    .arcana-tab:hover { color: var(--primary-color); }
    .arcana-tab.active {
        color: var(--primary-color);
        border-bottom-color: var(--primary-color);
    }

    .arcana-tab-content { display: none; }
    .arcana-tab-content.active {
        display: block;
        animation: fadeIn 0.5s ease;
    }
    
.arcana-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
}

.arcana-card {
    background: linear-gradient(145deg, rgba(30, 30, 30, 0.9), rgba(45, 45, 45, 0.9));
    border-radius: 10px;
    border: 1px solid var(--shadow-color-light);
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    transition: all 0.3s ease;
}

    
    .arcana-card:hover {
        transform: scale(1.03);
        box-shadow: 0 8px 25px var(--shadow-color-medium);
        border-color: var(--primary-color);
    }

.arcana-card-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    border-bottom: 1px solid var(--shadow-color-medium);
    padding-bottom: 0.75rem;
}


.arcana-card-image {
    width: 50px; /* Originally, I was going to use larger images, but settled on scaling it down to 50px */
    height: 50px;
    object-fit: contain;
    flex-shrink: 0;
}

    .arcana-card-title-wrapper {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

.arcana-card-title {
    font-family: 'Cinzel', serif;
    font-size: 1.1rem;
    font-weight: bold;
    color: var(--primary-color);
}

    .global-note {
        background-color: #c00;
        color: #fff;
        padding: 0.2rem 0.6rem;
        border-radius: 5px;
        font-size: 0.8rem;
        font-weight: bold;
        text-transform: uppercase;
    }
    
.arcana-card-effect {
    font-size: 0.9rem;
    line-height: 1.5;
}

    .arcana-card-effect strong { color: #fff; font-weight: bold; }
    .highlight-number { color: #ff9900; font-weight: bold; }
    
    /* If you have not watched that one moushley video from resident evil you are missing out */
    .confidant-grid-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 1.25rem;
    }
	
.accordion-container {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.accordion-item {
    border: 1px solid var(--shadow-color-light);
    border-radius: 10px;
    background: rgba(20, 20, 20, 0.7);
    transition: background-color 0.25s ease-in-out;
}

.accordion-item.active {
    background: rgba(30, 30, 30, 0.9);
}

.accordion-trigger {
    font-size: 1.5rem !important;
    color: #fff !important;
    background: transparent;
    border: none;
    border-bottom: 1px solid var(--shadow-color-light);
    padding: 1rem 1.5rem !important;
    width: 100%;
    text-align: left;
    cursor: pointer;
    position: relative;
    transition: color 0.25s ease-in-out;
    margin: 0 !important;
    display: flex;
    align-items: center;
}

.accordion-item.active .accordion-trigger,
.accordion-trigger:hover {
    color: var(--primary-color) !important;
}

.accordion-item.active .accordion-trigger {
    border-bottom-color: var(--primary-color);
}

.accordion-icon {
    width: 30px;
    height: 30px;
    margin-right: 1rem;
    object-fit: contain;
    transition: transform 0.25s ease-in-out;
}

.accordion-trigger:hover .accordion-icon {
    transform: scale(1.1);
}

.accordion-trigger::after {
    content: '+';
    position: absolute;
    right: 1.5rem;
    top: 50%;
    transform: translateY(-50%);
    font-size: 2rem;
    font-weight: bold;
    transition: transform 0.25s ease-in-out;
}

.accordion-item.active .accordion-trigger::after {
    transform: translateY(-50%) rotate(45deg);
}

.accordion-content {
    max-height: 0;
    overflow: hidden;
    /* If I ever tried to load Prydwen I would be assaulted by ads for womens underwear */
    transition: max-height 0.25s ease-in-out, padding 0.25s ease-in-out;
    padding: 0 1.5rem;
}

.accordion-item.active .accordion-content {
    max-height: 2000px; 
    padding: 1.5rem;
}
	
	.guide-credits {
        font-style: italic;
        color: #ccc;
        margin-bottom: 2rem;
        text-align: center;
        font-size: 0.9rem;
    }
    
    .guide-credits strong {
        color: var(--primary-color);
        font-weight: bold;
    }

    .accordion-content ul {
        list-style-position: inside;
        padding-left: 1rem;
        margin-bottom: 1rem;
    }

    .accordion-content li {
        margin-bottom: 0.5rem;
        line-height: 1.6;
    }

    .guide-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1.5rem;
        font-size: 0.9rem;
    }

    .guide-table th, .guide-table td {
        padding: 0.75rem;
        text-align: left;
        border-bottom: 1px solid var(--shadow-color-light);
    }

    .guide-table th {
        font-family: 'Cinzel', serif;
        color: var(--primary-color);
        font-weight: bold;
    }

    .guide-table img {
        width: 60px;
        height: 60px;
        object-fit: contain;
        vertical-align: middle;
        margin-right: 1rem;
    }
    
    .guide-table .item-name {
        font-weight: bold;
        color: #fff;
        display: block;
        margin-bottom: 0.25rem;
    }

    .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
    }

    .feature-item {
        background: rgba(10, 10, 10, 0.5);
        border: 1px solid var(--shadow-color-light);
        border-radius: 8px;
        padding: 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .feature-item strong {
        font-family: 'Cinzel', serif;
        font-size: 1.1rem;
        color: var(--primary-color);
        padding-bottom: 0.5rem;
        border-bottom: 1px solid var(--shadow-color-medium);
        margin-bottom: 0.5rem;
        display: block;
    }

    .feature-item p {
        font-size: 0.9rem;
        line-height: 1.6;
        margin: 0;
    }
	
    /* Considering adding filtering for element and name previews like in the main site. It's on the list. */
    .search-container-arcana {
        margin-bottom: 1.5rem;
    }

    #arcanaSearchInput {
        width: 100%;
        padding: 10px 15px;
        font-size: 1rem;
        font-family: 'Crimson Text', serif;
        color: #fff;
        background-color: rgba(20, 20, 20, 0.7);
        border: 1px solid var(--shadow-color-light);
        border-radius: 8px;
        outline: none;
        transition: all 0.3s ease;
    }

    #arcanaSearchInput::placeholder {
        color: #888;
    }

    #arcanaSearchInput:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 10px var(--shadow-color-medium);
    }
    .confidant-grid-card {
        position: relative;
        border-radius: 15px;
        overflow: hidden;
        cursor: pointer;
        transition: all 0.3s ease;
        background: linear-gradient(135deg, rgba(20, 20, 20, 0.8), rgba(40, 40, 40, 0.8));
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        border: 3px solid transparent;
        text-align: center;
        padding: 0.5rem 0.5rem 0.25rem;
    }

    .confidant-grid-card:hover { transform: translateY(-5px); border-color: var(--shadow-color-medium); }
    .confidant-grid-card:active { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); }

    .confidant-grid-icon {
        width: 100%;
        height: 140px;
        margin-bottom: 0.25rem;
        object-fit: cover;
        object-position: top;
        border-radius: 10px;
    }

    .confidant-grid-name {
        font-family: 'Cinzel', serif;
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
    }

    .modal {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .modal.show { display: flex; opacity: 1; }

    .modal-content {
        background: linear-gradient(135deg, rgba(20, 20, 20, 0.95), rgba(40, 40, 40, 0.95));
        border: 2px solid var(--primary-color);
        border-radius: 20px;
        max-width: 95%;
        max-height: 90vh;
        width: 800px;
        display: flex;
        flex-direction: column;
        box-shadow: 0 20px 50px var(--shadow-color-light);
        backdrop-filter: blur(10px);
    }

    .modal-header {
        padding: 1rem 1.5rem;
        border-bottom: 2px solid var(--primary-color);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .modal-title {
        font-family: 'Cinzel', serif;
        font-size: 1.3rem;
        font-weight: 600;
        color: var(--primary-color);
    }

    .close-btn {
        background: var(--primary-color);
        border: none;
        color: white;
        font-size: 1.5rem;
        width: 35px;
        height: 35px;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .close-btn:hover { background: var(--primary-color-dark); }

    .modal-body { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
    .tabs { display: flex; flex-wrap: wrap; border-bottom: 2px solid var(--primary-color); background: rgba(20, 20, 20, 0.3); }

    .tab {
        padding: 0.8rem 1rem;
        font-size: 0.9rem;
        cursor: pointer;
        background: transparent;
        border: none;
        color: #ccc;
        font-family: 'Cinzel', serif;
        font-weight: 600;
        transition: all 0.3s ease;
        border-bottom: 3px solid transparent;
    }
    
    .tab:hover { color: var(--primary-color); }
    .tab.active { color: var(--primary-color); border-bottom-color: var(--primary-color); }

    .tab-content-container { flex: 1; overflow-y: auto; padding: 1.5rem; }
    .tab-content-container .tab-content {
        display: none;
    }
    .tab-content-container .tab-content.active {
        display: block;
    }
    .confidant-table { font-size: 0.9rem; width: 100%; border-collapse: collapse; }
    .confidant-table th, .confidant-table td { padding: 0.8rem 1rem; text-align: left; border-bottom: 1px solid var(--shadow-color-light); }

#quick-nav-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #0a0a0a url('https://cdn.imgchest.com/files/yrgcn9bo2q4.png') no-repeat center center;
    background-size: cover;
    backdrop-filter: blur(5px);
    z-index: 2000;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
}

#quick-nav-overlay.hidden {
    opacity: 0;
    visibility: hidden;
}

.quick-nav-content {
    text-align: center;
    animation: fadeIn 0.8s ease-out;
    width: 90vw;
    max-width: 1200px;
}


.quick-nav-header {
    margin-bottom: 3rem;
}

.quick-nav-header h1 {
    font-family: 'Cinzel', serif;
    font-size: 2.5rem;
    color: var(--primary-color);
    margin-bottom: 0.5rem;
}

.quick-nav-header p {
    font-size: 1.1rem;
    color: #ccc;
}

.quick-nav-grid {
    display: grid;
    /* Default to a responsive column layout for mobile and medium screens */
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 1.5rem;
}

.quick-nav-card {
    position: relative;
    width: 200px;
    height: 250px;
    border-radius: 15px;
    cursor: pointer;
    border: 2px solid var(--shadow-color-light);
    transition: all 0.3s ease;
    display: flex;
    align-items: flex-end; /* Pushes content to the bottom */
    justify-content: center;
    padding: 1rem 1rem 1.5rem; /* Added extra bottom padding */
}

.quick-nav-card-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: top;
    opacity: 1;
    transition: opacity 0.3s ease, transform 0.3s ease;
}


/* Adds a nice hover effect */
.quick-nav-card:hover .quick-nav-card-bg {
    transform: scale(1.1);
    filter: brightness(0.7);
}
#guide-calculator {
    font-family: 'Inter', sans-serif;
}
#guide-calculator h1, #guide-calculator h2 {
    font-family: 'Teko', sans-serif;
    letter-spacing: 0.05em;
}
#guide-calculator .calculator-card {
    background-color: #1f2937;
    border: 1px solid #374151;
    border-left-width: 4px;
}
#guide-calculator .input-group {
    display: flex;
    align-items: center;
    background-color: #374151;
    border-radius: 0.25rem;
    border: 1px solid #4b5563;
}
#guide-calculator .input-group:focus-within {
    border-color: #ef4444;
    box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.5);
}
#guide-calculator .input-field {
    background-color: transparent;
    border: none;
    color: white;
    padding: 0.75rem;
    width: 100%;
    outline: none;
}
#guide-calculator .input-adornment {
    color: #9ca3af;
    padding-right: 0.75rem;
    font-weight: 700;
}
#guide-calculator select.input-field {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 0.5rem center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
    padding-right: 2.5rem;
}
#guide-calculator .output-field {
    background-color: #111827;
    color: #f87171;
    font-weight: 700;
    font-size: 1.5rem;
}
#guide-calculator .formula-box, #guide-calculator .comments-section {
    display: none;
    background-color: #111827;
    border: 1px solid #374151;
    padding: 0.75rem;
    margin-top: 1rem;
    border-radius: 0.25rem;
}
#guide-calculator .formula-box code {
    font-family: 'Courier New', Courier, monospace;
    color: #a5f3fc;
    word-break: break-all;
}
#guide-calculator .toggle-btn {
    background-color: #374151;
    color: #d1d5db;
    border: 1px solid #4b5563;
    transition: background-color 0.2s;
}
#guide-calculator .toggle-btn:hover {
    background-color: #4b5563;
}
#guide-calculator .toggle-btn.active {
    background-color: #ef4444;
    color: white;
}


@media (min-width: 992px) {
    .quick-nav-grid {
        grid-template-columns: repeat(4, 1fr);
    }

    /* Set a consistent max-width for modals on large screens */
    .modal-content {
        max-width: 90vw; /* Use viewport width for better scaling */
    }

    /* Custom scrollbar styling for modal content areas */
    .modal-body, .tab-content-container {
        scrollbar-width: thin;
        scrollbar-color: var(--primary-color) #1a1a1a;
    }
    .modal-body::-webkit-scrollbar, .tab-content-container::-webkit-scrollbar {
        width: 8px;
    }
    .modal-body::-webkit-scrollbar-track, .tab-content-container::-webkit-scrollbar-track {
        background: #1a1a1a;
    }
    .modal-body::-webkit-scrollbar-thumb, .tab-content-container::-webkit-scrollbar-thumb {
        background-color: var(--primary-color);
        border-radius: 4px;
    }
    .modal-body::-webkit-scrollbar-thumb:hover, .tab-content-container::-webkit-scrollbar-thumb:hover {
        background-color: var(--primary-color-dark);
    }
}


 @media (max-width: 768px) {
    /* General Mobile Body & Header Styles */
    body { padding-top: 60px; }
    body.sidebar-open { overflow: hidden; }
    body.sidebar-open .site-wrapper { margin-left: 0; }
    
    .header { padding: 0.4rem 1.5rem; }
    .header-text { gap: 0.5rem; }
    .header-text h1, .header h1 { font-size: 1.2rem; }
    .header-text p, .header p { font-size: 0.7rem; }

    /* General Layout & Font Adjustments */
    .main-content { padding: 1rem; }
    .guide-content-panel { padding: 1rem; }
    .guide-content-panel h1 { font-size: 1.8rem; }
    .guide-content-panel h2 { font-size: 1.5rem; }
    .guide-content-panel h3 { font-size: 1.1rem; }
    p, li, .confidant-notes { font-size: 0.9rem; }

    /* Responsive Grids */
    .quick-nav-grid {
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 1rem;
    }
.quick-nav-card {
    position: relative; /* Needed for child positioning */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    background: rgba(30, 30, 30, 0.5);
    border: 2px solid var(--shadow-color-light);
    overflow: hidden; /* Keeps the background contained */
    aspect-ratio: 4 / 5; /* A more appropriate ratio for the cards */
}

.quick-nav-card-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: contain; /* This is the correct value */
    background-position: center;
    background-repeat: no-repeat; /* Also ensure this is present */
    z-index: 1; 
    transition: transform 0.4s ease, filter 0.4s ease;
}

/* Adds a nice hover effect */
.quick-nav-card:hover .quick-nav-card-bg {
    transform: scale(1.1);
    filter: brightness(0.7);
}
    .p5-letter-box { font-size: 1.2rem; margin: 0 -0.15em; padding: 0.1em 0.3em; }
    .persona-grid-container, .confidant-grid-container { 
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 0.75rem; 
    }
    .arcana-grid, .feature-grid { grid-template-columns: 1fr; }
    .arcana-tabs { flex-wrap: wrap; justify-content: center; }
    .arcana-tab { font-size: 1rem; padding: 0.8rem; }
    .confidant-grid-name { font-size: 0.9rem; }

    /* --- Modal Optimizations --- */
    .modal-content {
        width: 95vw;
        max-height: 85vh;
        max-width: 600px;
    }
    .modal-header { padding: 0.75rem 1rem; }
    .modal-title { font-size: 1.1rem; }
    .tabs { justify-content: center; }
    .tab { padding: 0.75rem; font-size: 0.8rem; }
    .close-btn {
        width: 40px; /* Larger touch target */
        height: 40px;
        font-size: 1.8rem;
    }

    /* Persona Modal Specifics */
    .persona-modal-body h4 { font-size: 1.1rem; } /* Compact headings */
    
    /* Confidant Modal Specifics */
    .tab-content-container { 
        padding: 1rem; 
        overflow-x: auto; /* Allows wide tables to be scrolled horizontally */
    }
    .confidant-table th, .confidant-table td { 
        padding: 0.5rem; 
        font-size: 0.85rem; 
        white-space: nowrap; /* Prevents text from wrapping awkwardly in tables */
    }
}

.header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    padding: 0.75rem 1.5rem;
    background: linear-gradient(135deg, var(--gradient-primary), rgba(15, 15, 15, 0.95));
    box-shadow: 0 4px 20px var(--shadow-color-light);
    z-index: 50;
    display: flex;
    align-items: center;
    justify-content: space-between; 
}

.menu-toggle {
    background: transparent;
    border: none;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    justify-content: space-around;
    width: 30px;
    height: 24px;
    padding: 0;
    z-index: 1100;
    flex-shrink: 0;
}

.menu-toggle span {
    width: 100%;
    height: 3px;
    background: #fff;
    border-radius: 2px;
    transition: all 0.3s ease-in-out;
}

.menu-toggle.open span:nth-child(1) {
    transform: rotate(45deg) translate(7px, 7px);
}

.menu-toggle.open span:nth-child(2) {
    opacity: 0;
}

.menu-toggle.open span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -7px);
}

.collapsible-sidebar {
    position: fixed;
    top: 0;
    left: 0;
    width: 280px;
    height: 100vh;
    background: #1a1a1a url('https://cdn.imgchest.com/files/p7bwcnq5gq7.png') no-repeat center center;
    background-size: cover;
    z-index: 1000;
    transform: translateX(-100%);
    transition: transform 0.3s ease-in-out;
    display: flex;
    flex-direction: column;
    border-right: 2px solid var(--primary-color);
}

.collapsible-sidebar.open {
    transform: translateX(0);
}

.sidebar-header {
    padding: 1.25rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    background: rgba(0,0,0,0.5);
    border-bottom: 1px solid var(--shadow-color-medium);
}

.sidebar-logo {
    width: 50px;
    height: 50px;
}

.sidebar-title {
    font-family: 'Cinzel', serif;
    font-size: 1.5rem;
    color: #fff;
}

.sidebar-nav {
    display: flex;
    flex-direction: column;
    padding: 1rem;
    gap: 0.5rem;
    flex-grow: 1; /* GROW MY CHILD */
    overflow-y: auto; /* Y U NO VERTICAL SCROLL */
}

.sidebar-nav .guide-card {
    flex-direction: row;
    justify-content: flex-start;
    aspect-ratio: auto;
    padding: 0.75rem 1rem;
    gap: 1rem;
}

.sidebar-nav .guide-card-icon {
    width: 35px;
    height: 35px;
    margin-bottom: 0;
}

.sidebar-nav .guide-card-name {
    font-size: 1.1rem;
    text-align: left;
}

.main-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    z-index: 999;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
}

.main-overlay.show {
    opacity: 1;
    visibility: visible;
}

body.sidebar-open .site-wrapper {
    margin-left: 280px;
    transition: margin-left 0.3s ease-in-out;
}

@media (max-width: 768px) {
    /* Not as much CSS as the character site, which may change later. */
    body.sidebar-open .site-wrapper {
        margin-left: 0;
    }
    
    body.sidebar-open {
        overflow: hidden;
    }
}

.quick-nav-card::after,
.sidebar-nav .guide-card::after,
.sidebar-nav a.guide-card::after {
    content: attr(data-preview);
    position: absolute;
    bottom: -50px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.9);
    color: #fff;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-size: 0.85rem;
    font-family: 'Crimson Text', serif;
    white-space: nowrap;
    z-index: 10;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, bottom 0.3s ease;
    pointer-events: none; /* It's pronounced Rules Card */
}

.quick-nav-card:hover::after,
.sidebar-nav .guide-card:hover::after,
.sidebar-nav a.guide-card:hover::after {
    opacity: 1;
    visibility: visible;
    bottom: 10px;
}

.sidebar-nav .guide-card:hover::after,
.sidebar-nav a.guide-card:hover::after {
    bottom: auto;
    top: 105%;
    left: 50%;
}

.persona-grid-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 1.25rem;
}

.persona-card {
    position: relative;
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s ease;
    background: linear-gradient(135deg, rgba(20, 20, 20, 0.8), rgba(40, 40, 40, 0.8));
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
    border: 3px solid transparent;
    text-align: center;
    padding: 0.5rem 0.5rem 0.25rem;
}

.persona-card:hover { 
    transform: translateY(-5px); 
    border-color: var(--shadow-color-medium); 
}

.persona-card-icon {
    width: 100%;
    height: 140px;
    margin-bottom: 0.25rem;
    object-fit: contain; /* Use contain to see the whole image */
    border-radius: 10px;
}

.persona-card-name {
    font-family: 'Cinzel', serif;
    font-size: 1.1rem;
    font-weight: 600;
    color: #fff;
}

.persona-modal-content {
    width: 900px; /* Wider modal for persona details */
    max-width: 95%;
}

.persona-modal-body {
    padding: 1.5rem;
    overflow-y: auto;
}

.persona-detail-card {
    background: rgba(10, 10, 10, 0.85);
    border-radius: 15px;
    border: 1px solid var(--shadow-color-light);
    padding: 1.5rem;
    margin-bottom: 1.5rem;
}

.persona-detail-card h4 {
    font-family: 'Cinzel', serif;
    font-size: 1.3rem;
    color: var(--primary-color);
    margin-bottom: 1rem;
    border-bottom: 1px solid var(--shadow-color-medium);
    padding-bottom: 0.5rem;
}

.persona-skill-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.5rem;
}

@media (min-width: 768px) {
    .persona-skill-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

.persona-skill-item {
    background: rgba(30, 30, 30, 0.7);
    padding: 1rem;
    border-radius: 10px;
}

.persona-skill-item strong {
    display: block;
    color: #fff;
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.persona-skill-item p {
    font-size: 0.9rem;
    color: #ccc;
    line-height: 1.6;
}

.persona-recommended-skills .skill {
    margin-bottom: 1rem;
}

.persona-recommended-skills .skill:last-child {
    margin-bottom: 0;
}

.persona-footer-note {
    margin-top: 1.5rem;
    font-style: italic;
    color: #aaa;
    text-align: center;
    font-size: 0.9rem;
    background: rgba(10, 10, 10, 0.85);
    padding: 0.75rem;
    border-radius: 10px;
}

.persona-card-details {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 0.5rem;
    background: linear-gradient(to top, rgba(0,0,0,0.85) 20%, transparent);
    text-align: center;
    border-radius: 0 0 12px 12px;
}

.persona-rarity {
    display: flex;
    justify-content: center;
    gap: 2px;
    margin-bottom: 0.25rem;
    text-shadow: 1px 1px 3px #000;
}

.persona-rarity-star {
    font-size: 1.1rem;
    line-height: 1;
    color: #4a5568; /* Hollow/empty star color */
    transition: color 0.3s;
}

.persona-rarity-star.filled {
    animation: star-pulse 2s infinite ease-in-out;
}

/* Rarity 2: Green */
.rarity-2 .persona-rarity-star.filled { color: #48bb78; animation-delay: 0.1s; }
.rarity-2 { animation: subtle-pulse-green 3s infinite alternate; } /* Keep border pulse on hover */

/* Rarity 3: Silver */
.rarity-3 .persona-rarity-star.filled { color: #c0c0c0; animation-delay: 0.2s; }
.rarity-3 { animation: subtle-pulse-silver 2.5s infinite alternate; } /* Keep border pulse on hover */

/* Rarity 4: Gold */
.rarity-4 .persona-rarity-star.filled { color: #f6e05e; animation-delay: 0.3s; }
.rarity-4 {
    animation: pulse-gold 2s infinite;
}

/* Rarity 5: Double Rainbow All The Way */
.rarity-5 .persona-rarity-star.filled {
    background: linear-gradient(90deg, #ff4b4b, #ffb44b, #fffb8b, #4bff8d, #4bffff, #4b7aff, #b54bff);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 0 0 1px rgba(255,255,255,0.2); /* Fallback for visibility */
    animation: rainbow-text 3s ease infinite, star-pulse 2s infinite ease-in-out;
    animation-delay: 0.4s;
}

.rarity-5 {
    position: relative;
}

.rarity-5::before {
    content: '';
    position: absolute;
    top: -3px; left: -3px; right: -3px; bottom: -3px;
    border-radius: 18px;
    border: 3px solid transparent;
    background: linear-gradient(45deg, #ff4b4b, #ffb44b, #fffb8b, #4bff8d, #4bffff, #4b7aff, #b54bff) border-box;
    -webkit-mask: 
        linear-gradient(#fff 0 0) padding-box, 
        linear-gradient(#fff 0 0);
    -webkit-mask-composite: destination-out;
    mask-composite: exclude;
    z-index: -1;
    animation: pulse-rainbow 2s infinite;
}

@keyframes star-pulse {
    0%, 100% { transform: scale(1); opacity: 0.8; }
    50% { transform: scale(1.15); opacity: 1; }
}

@keyframes subtle-pulse-green {
    from { border-color: #2f855a; }
    to { border-color: #68d391; }
}

@keyframes subtle-pulse-silver {
    from { border-color: #a0aec0; }
    to { border-color: #e2e8f0; }
}

@keyframes pulse-gold {
    0% { box-shadow: 0 0 4px #f6e05e, inset 0 0 4px #f6e05e; }
    50% { box-shadow: 0 0 12px #f6e05e, inset 0 0 8px #f6e05e; }
    100% { box-shadow: 0 0 4px #f6e05e, inset 0 0 4px #f6e05e; }
}

@keyframes pulse-rainbow {
    0% { opacity: 0.7; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.03); }
    100% { opacity: 0.7; transform: scale(1); }
}

@keyframes rainbow-text { 
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
}

.rarity-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  background: var(--primary-color);
  cursor: pointer;
  border-radius: 50%;
  border: 2px solid #fff;
  transition: background-color 0.2s;
}

.rarity-slider::-moz-range-thumb {
  width: 20px;
  height: 20px;
  background: var(--primary-color);
  cursor: pointer;
  border-radius: 50%;
  border: 2px solid #fff;
}

.rarity-slider:hover::-webkit-slider-thumb {
    background: var(--primary-color-dark);
}

.rarity-ticks {
    position: absolute;
    top: 0;
    left: 10px; /* Half the width of the thumb */
    right: 10px; /* Half the width of the thumb */
    height: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    pointer-events: none; /* Allows clicks to go through to the slider track */
}

.rarity-tick {
    pointer-events: auto; /* Makes the ticks themselves clickable */
    cursor: pointer;
    font-size: 1.5rem; /* Larger stars */
    color: #4a5568; /* Default color for inactive stars */
    transition: color 0.3s ease, transform 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
}

.rarity-tick:hover {
    color: var(--primary-color-dark);
    transform: scale(1.2);
}

.rarity-tick[data-value="6"] {
    font-size: 1rem;
    font-weight: bold;
}
.rarity-tick[data-value="6"].active-tick {
    color: var(--primary-color);
}

@keyframes tick-pulse {
    0%, 100% { transform: scale(1.1); }
    50% { transform: scale(1.3); }
}

.persona-card-icon-wrapper {
    position: relative; /* Container for positioning the element icon */
    width: 100%;
    height: 140px;
    margin-bottom: 0.25rem;
}

.persona-card-icon {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 10px;
}

.persona-element-icon-container {
    position: absolute;
    top: -5px;
    left: -5px;
    width: 40px;
    height: 40px;
    z-index: 3;
}

.persona-element-icon {
    width: 100%;
    height: 100%;
    object-fit: contain;
    transform: rotate(-15deg); /* Slight tilt */
}

.element-physical { filter: drop-shadow(0 0 6px #ffa500); }
.element-gun { filter: drop-shadow(0 0 6px #ffa500); }
.element-fire { filter: drop-shadow(0 0 6px #ff0000); }
.element-ice { filter: drop-shadow(0 0 6px #40e0d0); }
.element-electric { filter: drop-shadow(0 0 6px #ffff00); }
.element-wind { filter: drop-shadow(0 0 6px #00ff00); }
.element-psychokinesis { filter: drop-shadow(0 0 6px #8a2be2); }
.element-nuclear { filter: drop-shadow(0 0 6px #add8e6); }
.element-bless { filter: drop-shadow(0 0 6px #ffffe0); }
.element-curse { filter: drop-shadow(0 0 6px #8b0000); }
.element-almighty { filter: drop-shadow(0 0 6px #ffffff); }

.element-filter-btn {
    background-color: rgba(40, 40, 40, 0.7);
    border: 2px solid #4a5568;
    border-radius: 50%;
    width: 44px;
    height: 44px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem;
    transition: all 0.2s ease-in-out;
}
.element-filter-btn:hover {
    transform: scale(1.1);
    border-color: var(--primary-color-dark);
}
.element-filter-btn img {
    width: 100%;
    height: 100%;
    object-fit: contain;
}

.rarity-tick.active-tick-2 { color: #48bb78; animation: tick-pulse-green 1.5s infinite; }
.rarity-tick.active-tick-3 { color: #c0c0c0; animation: tick-pulse-silver 1.5s infinite; }
.rarity-tick.active-tick-4 { color: #f6e05e; animation: tick-pulse-gold 1.5s infinite; }
.rarity-tick.active-tick-5 {
    background: linear-gradient(90deg, #ff4b4b, #ffb44b, #fffb8b, #4bff8d, #4bffff, #4b7aff, #b54bff);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: rainbow-text 3s ease infinite, tick-pulse-rainbow 1.5s infinite;
}
.rarity-tick[data-value="6"].active-tick { color: var(--primary-color); transform: scale(1.1); }

@keyframes tick-pulse-green { 0%, 100% { transform: scale(1.1); filter: drop-shadow(0 0 3px #48bb78); } 50% { transform: scale(1.3); filter: drop-shadow(0 0 8px #48bb78); } }
@keyframes tick-pulse-silver { 0%, 100% { transform: scale(1.1); filter: drop-shadow(0 0 3px #c0c0c0); } 50% { transform: scale(1.3); filter: drop-shadow(0 0 8px #c0c0c0); } }
@keyframes tick-pulse-gold { 0%, 100% { transform: scale(1.1); filter: drop-shadow(0 0 3px #f6e05e); } 50% { transform: scale(1.3); filter: drop-shadow(0 0 8px #f6e05e); } }
@keyframes tick-pulse-rainbow { 0%, 100% { transform: scale(1.1); filter: drop-shadow(0 0 3px #ff4b4b); } 50% { transform: scale(1.3); filter: drop-shadow(0 0 8px #4bffff); } }

.element-filter-btn.active { transform: scale(1.1); }

.element-filter-btn.active.all { border-color: var(--primary-color); box-shadow: 0 0 8px var(--primary-color); }
.element-filter-btn.active.physical { border-color: #ffa500; box-shadow: 0 0 8px #ffa500; }
.element-filter-btn.active.gun { border-color: #ffa500; box-shadow: 0 0 8px #ffa500; }
.element-filter-btn.active.fire { border-color: #ff0000; box-shadow: 0 0 8px #ff0000; }
.element-filter-btn.active.ice { border-color: #40e0d0; box-shadow: 0 0 8px #40e0d0; }
.element-filter-btn.active.electric { border-color: #ffff00; box-shadow: 0 0 8px #ffff00; }
.element-filter-btn.active.wind { border-color: #00ff00; box-shadow: 0 0 8px #00ff00; }
.element-filter-btn.active.psychokinesis { border-color: #8a2be2; box-shadow: 0 0 8px #8a2be2; }
.element-filter-btn.active.nuclear { border-color: #add8e6; box-shadow: 0 0 8px #add8e6; }
.element-filter-btn.active.bless { border-color: #ffffe0; box-shadow: 0 0 8px #ffffe0; }
.element-filter-btn.active.curse { border-color: #8b0000; box-shadow: 0 0 8px #8b0000; }
.element-filter-btn.active.almighty { border-color: #ffffff; box-shadow: 0 0 8px #ffffff; }

.p5-funky-text {
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.3s ease;
    position: relative;
    z-index: 2;
    /* Adedd some padding to the container to prevent clipping */
    padding-bottom: 10px; 
}

.quick-nav-card:hover .p5-funky-text {
    transform: scale(1.1);
}

.p5-letter-box {
    display: inline-block;
    padding: 0.1em 0.4em;
    font-family: 'Teko', sans-serif;
    font-weight: 700;
    /* This new line makes the font size responsive */
    font-size: clamp(1.1rem, 4vw, 1.8rem); 
    text-transform: uppercase;
    line-height: 1;
    margin: 0 -0.25em; /* Adjusted overlap */
    transition: all 0.2s ease-in-out;
    border: 2px solid black;
}

.p5-letter-box {
    background-color: white;
    color: black;
}

.p5-letter-box.first-letter {
    background-color: black;
    color: var(--primary-color);
    z-index: 10;
    font-weight: 700;
}

.p5-letter-box.last-letter {
    background-color: transparent;
    color: white;
    border: none;
    font-weight: 700; /* Bold */
    text-shadow: 2px 2px 4px #000;
    margin-right: 0; /* No negative margin on the last letter */
}

/* Individual letter rotations for that uneven look */
.p5-funky-text > span:nth-child(1) { transform: rotate(-5deg) translateY(2px); }
.p5-funky-text > span:nth-child(2) { transform: rotate(3deg) translateY(-3px); }
.p5-funky-text > span:nth-child(3) { transform: rotate(-2deg) translateY(3px); }
.p5-funky-text > span:nth-child(4) { transform: rotate(4deg); }
.p5-funky-text > span:nth-child(5) { transform: rotate(-3deg) translateY(-2px); }
.p5-funky-text > span:nth-child(6) { transform: rotate(2deg) translateY(2px); }
.p5-funky-text > span:nth-child(7) { transform: rotate(-4deg) translateY(-1px); }
.p5-funky-text > span:nth-child(8) { transform: rotate(3deg) translateY(3px); }
.p5-funky-text > span:nth-child(9) { transform: rotate(-2deg); }
.p5-funky-text > span:nth-child(10) { transform: rotate(5deg) translateY(-2px); }


.quick-nav-card:hover .p5-letter-box {
    background-color: var(--primary-color);
    color: black;
}
.quick-nav-card:hover .p5-letter-box.first-letter {
    background-color: black;
    color: white;
}
.quick-nav-card:hover .p5-letter-box.last-letter {
    color: var(--primary-color);
}

.p5-button, .p5-button-secondary {
    display: inline-flex;
    align-items: center;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    border: 2px solid var(--primary-color);
    background: var(--primary-color);
    color: white;
    font-family: 'Cinzel', serif;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 2px 5px rgba(0,0,0,0.4);
}
.p5-button-secondary {
    background: rgba(30,30,30,0.8);
    color: var(--primary-color);
    padding: 0.5rem;
}
.p5-button:hover, .p5-button-secondary:hover {
    background: var(--primary-color-dark);
    border-color: var(--primary-color-dark);
    color: white;
    transform: translateY(-2px);
}

#persona-filters-wrapper {
    transition: all 0.4s ease-in-out;
    background: rgba(15, 15, 15, 0.9);
    backdrop-filter: blur(5px);
    border-radius: 15px;
}

#guide-personas.layout-top #persona-filters-wrapper {
    padding: 1.5rem;
    border: 1px solid var(--shadow-color-light);
    margin-bottom: 1.5rem;
}
#guide-personas.layout-top #persona-filters-wrapper.collapsed {
    max-height: 0;
    padding-top: 0;
    padding-bottom: 0;
    overflow: hidden;
    border-width: 0;
    margin-bottom: 0;
}
#guide-personas.layout-top #filter-toggle-indicator {
    transform: rotate(90deg);
}
#guide-personas.layout-top #persona-filters-wrapper.collapsed ~ #persona-filter-controls #filter-toggle-indicator {
    transform: rotate(0deg);
}

#guide-personas.layout-side #persona-filters-wrapper {
    position: fixed;
    top: 100px;
    right: 0;
    width: 300px;
    height: auto;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
    z-index: 100;
    border: 2px solid var(--primary-color);
    border-right: none;
    border-radius: 15px 0 0 15px;
    padding: 1.5rem;
    transform: translateX(0);
}
#guide-personas.layout-side #persona-filters-wrapper.collapsed {
    transform: translateX(100%);
    padding: 0;
    border-width: 0;
}
#guide-personas.layout-side #persona-filter-controls {
    position: fixed;
    top: 80px; /* Changed from 100px */
    right: 0px;
    z-index: 101;
    margin-bottom: 0; 
}
#guide-personas.layout-side #filter-panel-toggle {
    border-radius: 8px 0 0 8px;
    border-right: none;
}
#guide-personas.layout-side #filter-toggle-indicator {
    transform: rotate(180deg);
}
#guide-personas.layout-side #persona-filters-wrapper.collapsed ~ #persona-filter-controls #filter-toggle-indicator {
    transform: rotate(0deg);
}

/* --- Layout & Scaling Fixes --- */

/* This rule ensures the entire sidebar disappears, allowing the main content to expand fully */
#guide-forum-container.sidebar-hidden #guide-forum-sidebar {
    display: none;
}

/* Reduces the main gap for a tighter layout */
#guide-forum-container {
    gap: 1rem; /* Was gap-6 (1.5rem) */
}

/* --- Button Redesign & Clipping Fix --- */

/* Styles the new cog button to be square and compact */
#sort-view-btn {
    padding: 0.5rem;
    width: 42px;
    height: 42px;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Prevents the quick category switcher title from pushing the button off-screen */
#guide-controls-content h2#forum-title {
    min-width: 0; /* Allows the title to shrink and truncate if needed */
}

@media (max-width: 992px) {
    #guide-personas.layout-side #persona-filters-wrapper {
        position: relative;
        width: 100%;
        max-height: none;
        transform: none !important;
        border: 1px solid var(--shadow-color-light);
        border-radius: 15px;
        margin-bottom: 1.5rem;
    }
    #guide-personas.layout-side #persona-filters-wrapper.collapsed {
        max-height: 0;
        padding-top: 0;
        padding-bottom: 0;
        overflow: hidden;
        border-width: 0;
        margin-bottom: 0;
    }
    #guide-personas.layout-side #persona-filter-controls {
        position: static;
    }
}

.modal-header-controls {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.copy-guide-btn {
    background-color: rgba(74, 85, 104, 0.5); /* #4a5568 with opacity */
    color: white;
    padding: 0.35rem 0.75rem;
    font-size: 0.8rem;
    font-family: 'Cinzel', serif;
    border-radius: 6px;
    border: 1px solid #718096;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative; /* For the notification */
}
.copy-guide-btn:hover {
    background-color: #2d3748;
}
.copy-guide-btn .copy-notification {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #48bb78;
    color: white;
    padding: 0.35rem 0.75rem;
    border-radius: 6px;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease;
    white-space: nowrap;
    pointer-events: none;
}
.copy-guide-btn.copied .copy-notification {
    opacity: 1;
    visibility: visible;
}


.news-accordion-item {
    border: 1px solid var(--shadow-color-light);
    border-radius: 10px;
    background: rgba(20, 20, 20, 0.7);
    transition: background-color 0.25s ease-in-out;
}

.news-accordion-item.active {
    background: rgba(30, 30, 30, 0.9);
}

.news-accordion-trigger {
    font-size: 1.2rem;
    color: #fff;
    background: transparent;
    border: none;
    padding: 1rem 1.5rem;
    width: 100%;
    text-align: left;
    cursor: pointer;
    position: relative;
    transition: color 0.25s ease-in-out;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
}

.news-accordion-item.active .news-accordion-trigger,
.news-accordion-trigger:hover {
    color: var(--primary-color);
}

.news-accordion-trigger::after {
    content: '+';
    font-size: 2rem;
    font-weight: bold;
    transition: transform 0.25s ease-in-out;
    flex-shrink: 0;
}

.news-accordion-item.active .news-accordion-trigger::after {
    transform: rotate(45deg);
}

.news-accordion-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out;
    padding: 0 1.5rem;
    font-size: 0.9rem;
    line-height: 1.6;
}

.newsDetailTextBox {
    color: #ccc;
}
.newsDetailTextBox h2, .newsDetailTextBox h3 {
    font-family: 'Cinzel', serif;
    color: var(--primary-color);
    margin-top: 1.5rem;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--shadow-color-medium);
}
.newsDetailTextBox p {
    margin-bottom: 1rem;
}
.newsDetailTextBox strong {
    color: #fff;
    font-weight: bold;
}
.newsDetailTextBox a {
    color: var(--primary-color);
    text-decoration: underline;
}

.news-accordion-item.active .news-accordion-content {
    max-height: 5000px; /* Large value to accommodate long articles */
    padding: 1.5rem;
}

/* Reusing some old styles for consistency */
.news-title {
    font-family: 'Cinzel', serif;
    font-size: 1.4rem;
    font-weight: bold;
}
.news-date, .news-category-badge {
    font-family: 'Inter', sans-serif;
    font-size: 0.8rem;
    font-weight: 500;
    color: #ccc;
    background-color: rgba(255, 255, 255, 0.1);
    padding: 0.25rem 0.5rem;
    border-radius: 6px;
    flex-shrink: 0;
}
.news-category-badge {
    color: var(--primary-color);
    background-color: rgba(255, 0, 0, 0.1);
}
.news-meta {
    display: flex;
    gap: 0.75rem;
    align-items: center;
}
.copy-article-btn {
    margin-bottom: 1.5rem;
    display: block;
}

/* === DYNAMIC FORUM STYLES V7 - Final Layout === */

/* Static Controls (Default) */
#guide-controls-wrapper {
    position: sticky;
    top: 100px;
    z-index: 20; /* Ensures it's above the content area */
}

/* Floating Controls State */
#guide-controls-wrapper.is-floating {
    background: rgba(15, 15, 15, 0.9);
    backdrop-filter: blur(8px);
    border: 2px solid var(--primary-color);
    border-radius: 15px;
    padding: 1rem;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

/* Compact Floating Controls Layout */
#guide-controls-wrapper.is-floating #guide-controls-content { padding-right: 0.5rem; }
#guide-controls-wrapper.is-floating #forum-title { font-size: 1.25rem; }
#guide-controls-wrapper.is-floating #sort-view-btn { padding: 0.5rem; font-size: 0.8rem; }

/* When a guide is side-loaded, force the controls to be static to prevent overlap */
#guide-content-split.side-loading ~ #guide-controls-wrapper {
    position: sticky !important;
}

/* Constrains the forum's width and centers it on the page */
#guide-forum-container {
    max-width: 80rem; /* 1280px */
    margin-left: auto;
    margin-right: auto;
}

#guide-content-area {
    min-width: 0;
}
/* --- START: New Static Filter Panel CSS --- */

/* 1. Simplify the main grid to a single content column */
#guide-main-grid {
    display: grid;
    grid-template-columns: 1fr; /* Only the content area remains */
    gap: 1.5rem;
    align-items: start;
}

/* 2. Style the controls wrapper inside the sidebar */
#guide-controls-wrapper {
    /* The parent sidebar is already sticky, so this will scroll with it */
    width: 100%;
    margin-top: 1.5rem; /* Adds space above the filters */
    border-top: 2px solid var(--primary-color);
    padding-top: 1.5rem;
}

/* 3. Redesign the tag filters to have two columns */
#guide-tag-filters {
    display: grid;
    grid-template-columns: 1fr 1fr; /* Two filters per line */
    gap: 0.5rem; /* Space between filters */
}

/* --- Styles for Top-Positioned Filter Panel --- */
#top-controls-container #guide-controls-wrapper {
    display: block; /* Make it visible */
    width: 100%;
    margin-bottom: 1.5rem;
    padding: 1rem;
    background: rgba(30, 30, 30, 0.5);
    border: 1px solid var(--shadow-color-light);
    border-radius: 8px;
}

#top-controls-container #guide-controls-content {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 1rem;
}

#guide-content-split.side-loading #guide-post-viewer {
    flex: 1 1 55%;
    opacity: 1;
    padding-left: 1.5rem;
    
    /* Make the panel 'stick' to the top during scroll */
    position: sticky;
    top: 120px; /* Controls the distance from the top of the screen */

    /* Add a max-height so the panel can scroll internally for very long guides */
    max-height: calc(100vh - 140px); /* (top value) + (bottom padding) */
    overflow-y: auto;
}

#guide-content-split.side-loading #guide-post-viewer::-webkit-scrollbar {
    width: 8px;
}
#guide-content-split.side-loading #guide-post-viewer::-webkit-scrollbar-track {
    background: transparent;
}
#guide-content-split.side-loading #guide-post-viewer::-webkit-scrollbar-thumb {
    background-color: var(--primary-color);
    border-radius: 4px;
}

/* [FIX] This now correctly hides ONLY the categories container */
#guide-forum-container.sidebar-hidden #sidebar-categories-container {
    display: none;
}

#guide-search-input {
    background-color: rgba(10, 10, 10, 0.7);
    border: 1px solid var(--shadow-color-light);
    border-radius: 6px;
    padding: 0.6rem 1rem 0.6rem 2.5rem; /* Left padding for icon */
    color: white;
    transition: all 0.2s ease;
    width: 100%;
}
#guide-search-input:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 10px var(--shadow-color-medium);
    outline: none;
}

#guide-controls-wrapper .relative.w-full.mb-4::before {
    content: '⚲';
    position: absolute;
    left: 0.9rem;
    top: 50%;
    transform: translateY(-50%);
    color: #a0aec0;
    font-size: 1.2rem;
    pointer-events: none;
    z-index: 1;
}

#guide-forum-sidebar {
    position: sticky;
    top: 100px;
    z-index: 10; /* Lower z-index than the controls wrapper */
}

#sort-view-modal {
    position: fixed;
    width: 40rem; /* Increased width for two columns */
    font-size: 0.9rem;
    /* Move it up by changing the 'top' value */
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    transform-origin: center center;
    transition: transform 0.2s ease-out, opacity 0.2s ease-out;
    z-index: 100;
}

#modal-grid-container {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0 1.5rem; /* 0 vertical gap, 1.5rem horizontal */
}

/* Hidden state for the modal */
#sort-view-modal.hidden {
    transform: scale(0.95);
    opacity: 0;
    visibility: hidden;
    pointer-events: none; /* Prevents interaction when hidden */
}

/* Visible state for the modal */
#sort-view-modal:not(.hidden) {
    transform: scale(1);
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
}

/* Smaller headings inside the modal */
#sort-view-modal h4 {
    font-size: 0.95rem;
    margin-bottom: 0.5rem;
}

/* This creates the two-column layout for the settings */
#sort-view-modal .space-y-1 {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.5rem 1rem; /* Vertical and horizontal gap */
}

/* Smaller label text */
#sort-view-modal label {
    font-size: 0.85rem;
}

/* Styles the new cog button to be square and compact */
#sort-view-btn {
    padding: 0.5rem;
    width: 42px;
    height: 42px;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Prevents the quick category switcher title from pushing the button off-screen */
#guide-controls-content h2#forum-title {
    min-width: 0; /* Allows the title to shrink and truncate if needed */
}

/* --- Compact Filter Panel Styles --- */
#guide-controls-content h2#forum-title {
    font-size: 1.3rem; /* Downsizes the forum title text */
}

#guide-controls-content #sort-view-btn {
    padding: 0.4rem 0.8rem; /* Reduces button size */
    font-size: 0.9rem;
}

#guide-controls-content .guide-tag-btn {
    padding: 0.2rem 0.6rem; /* Makes tag buttons smaller */
    font-size: 0.75rem;
}

/* --- Compact Guide Title Style --- */
.guide-post-title {
    font-size: 1.1rem; /* Reduces the title size in the guide list */
}

/* Media query for smaller screens */
@media (max-width: 1280px) {
    #guide-controls-wrapper, #guide-controls-wrapper.is-floating {
        position: relative; top: auto; width: 100%;
        background: none; backdrop-filter: none; border: none;
        padding: 0; max-height: none; overflow-y: visible;
    }
}

/* --- Other styles from previous versions (unchanged) --- */
#guide-forum-sidebar { max-height: calc(100vh - 120px); overflow-y: auto; padding-right: 0.5rem; }
#guide-forum-sidebar::-webkit-scrollbar { width: 6px; }
#guide-forum-sidebar::-webkit-scrollbar-track { background: transparent; }
#guide-forum-sidebar::-webkit-scrollbar-thumb { background-color: var(--primary-color); border-radius: 3px; }
.sidebar-category-header { font-family: 'Cinzel', serif; font-size: 0.9rem; font-weight: 700; text-transform: uppercase; color: #a0aec0; padding: 1.5rem 0.5rem 0.5rem 0.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.75rem; width: 100%; background: none; border: none; text-align: left; }
.sidebar-category-header:first-child { padding-top: 0; }
.sidebar-category-icon { width: 20px; height: 20px; }
.sidebar-category-chevron { margin-left: auto; width: 16px; height: 16px; transition: transform 0.3s ease; }
.sidebar-category.collapsed .sidebar-category-chevron { transform: rotate(-90deg); }
.sidebar-forum-list { max-height: 1000px; transition: max-height 0.4s ease-in-out; overflow: hidden; padding-left: 0.5rem; }
.sidebar-category.collapsed .sidebar-forum-list { max-height: 0; }
.sidebar-forum-link { display: flex; align-items: center; gap: 0.75rem; padding: 0.6rem 0.75rem; border-radius: 6px; cursor: pointer; font-weight: 500; color: #d1d5db; transition: background-color 0.2s ease, color 0.2s ease; border-left: 3px solid transparent; }
.sidebar-forum-link:hover { background-color: rgba(255, 255, 255, 0.1); }
.sidebar-forum-link.active { background-color: rgba(255, 0, 0, 0.15); color: white; border-left-color: var(--primary-color); }
.sidebar-forum-icon { width: 20px; height: 20px; }
.quick-nav-link { display: flex; align-items: center; gap: 1rem; background-color: rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 8px; transition: background-color 0.2s ease; }
.quick-nav-link:hover { background-color: rgba(255, 0, 0, 0.15); }
#guide-forum-main input, #guide-forum-main select { background-color: rgba(10, 10, 10, 0.7); border: 1px solid var(--shadow-color-light); border-radius: 6px; padding: 0.6rem 1rem; color: white; transition: all 0.2s ease; }
#guide-forum-main input:focus, #guide-forum-main select:focus { border-color: var(--primary-color); box-shadow: 0 0 10px var(--shadow-color-medium); outline: none; }
.guide-tag-btn { background-color: rgba(74, 85, 104, 0.5); border: 1px solid #4A5568; color: #E2E8F0; padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.8rem; font-weight: 500; cursor: pointer; transition: all 0.2s ease; }
.guide-tag-btn:hover { background-color: #4A5568; }
.guide-tag-btn.active { background-color: var(--primary-color); color: white; border-color: var(--primary-color-dark); }
.custom-radio { appearance: none; width: 18px; height: 18px; border: 2px solid #4A5568; border-radius: 50%; transition: all 0.2s; cursor: pointer; position: relative; }
.custom-radio:checked { border-color: var(--primary-color); }
.custom-radio:checked::after { content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 10px; height: 10px; background: var(--primary-color); border-radius: 50%; }
#guide-post-list.view-gallery .guide-post { display: flex; gap: 1rem; padding: 1rem; }
#guide-post-list.view-list .guide-post { display: flex; padding: 0.75rem 1rem; }
.guide-post { background: rgba(30, 30, 30, 0.5); border: 1px solid var(--shadow-color-light); border-radius: 8px; margin-bottom: 0.75rem; cursor: pointer; transition: border-color 0.2s ease, background-color 0.2s ease; }
.guide-post:hover { border-color: var(--primary-color); }
.guide-post.active { background-color: rgba(255, 0, 0, 0.1); border-color: var(--primary-color); }
.guide-post-image { width: 128px; height: 72px; object-fit: cover; border-radius: 6px; flex-shrink: 0; }
.guide-post-content { min-width: 0; }
.guide-post-title { font-family: 'Cinzel', serif; font-size: 1.2rem; font-weight: 600; color: white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.guide-post-meta { font-size: 0.8rem; color: #a0aec0; }
.guide-post-tags { margin-top: 0.5rem; display: flex; flex-wrap: wrap; gap: 0.3rem; }
.guide-post-tag { background: #4A5568; color: #E2E8F0; padding: 0.15rem 0.5rem; border-radius: 0.75rem; font-size: 0.7rem; }
#guide-post-list.view-list .guide-post-image, #guide-post-list.view-list .guide-post-tags { display: none; }
#guide-content-split.side-loading #guide-post-list {
    flex: 0 0 45%; /* Adjusted flex-basis slightly */
    padding-right: 1.5rem;
    border-right: 1px solid var(--shadow-color-light);
    min-width: 0; /* CRITICAL FIX: Allows this column to shrink */
}
#guide-content-split.side-loading #guide-post-viewer {
    flex: 1 1 55%; /* Let this column grow and shrink */
    opacity: 1;
    padding-left: 1.5rem;
	max-height: calc(100vh - 120px); 
	
}
#guide-post-viewer h3 { font-family: 'Cinzel', serif; font-size: 2rem; color: var(--primary-color); margin-bottom: 0.5rem; }
#guide-content-split.full-view-active #guide-post-viewer { width: 100%; opacity: 1; }
.page-btn { background-color: rgba(74, 85, 104, 0.5); border: 1px solid #4A5568; color: #E2E8F0; font-weight: bold; cursor: pointer; transition: all 0.2s ease; border-radius: 6px; min-width: 36px; height: 36px; display: inline-flex; justify-content: center; align-items: center; }
.page-btn:hover { background-color: #4A5568; border-color: #718096; }
.page-btn.active { background-color: var(--primary-color); color: white; border-color: var(--primary-color-dark); }
.page-btn:disabled { opacity: 0.5; cursor: not-allowed; }

/* === MOBILE FORUM OVERHAUL V2 (max-width: 768px) === */
@media (max-width: 768px) {

    /* --- 1. Hide Desktop Elements & Set Up Layout --- */
    #guide-forum-sidebar,
    #guide-controls-wrapper,
    #top-controls-container {
        display: none !important; /* Force hide all desktop control containers */
    }

    #guide-forum-container {
        flex-direction: column;
    }
#guide-forum-main {
    /* Increased top padding to push content below the fixed header */
    padding-top: 125px; 
    padding-bottom: 70px; /* Added a bit more space for the pagination bar */
}

    
    /* Force single-column, full-view for guides */
    #guide-content-split,
    #guide-content-split.side-loading {
        display: block;
    }
    #guide-content-split.side-loading #guide-post-list,
    #guide-content-split.side-loading #guide-post-viewer {
        flex: 1 1 100%;
        max-width: 100%;
        padding: 0;
        position: static;
        max-height: none;
    }

    /* --- 2. New Mobile Header --- */
    #mobile-forum-header {
        display: block; /* This will be created by the script */
        position: fixed;
        top: 60px; /* Stick below main site header */
        left: 0;
        right: 0;
        background: #111;
        z-index: 30;
        padding: 0.5rem 1rem;
        border-bottom: 1px solid #333;
    }

    /* Top bar: Category & Search Icon */
    .mobile-header-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        height: 40px;
    }
    #mobile-category-switcher {
        font-family: 'Inter', sans-serif;
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        background: none; border: none; padding: 0;
        display: flex; align-items: center; gap: 0.5rem;
    }
    #mobile-category-switcher::after {
        content: '›'; font-size: 1.2rem; color: #888;
    }
    #mobile-search-icon {
        background: none; border: none; color: #ccc; padding: 0.5rem;
    }

    /* Expanding Search Bar */
    #mobile-search-bar {
        display: flex; align-items: center; width: 100%; padding: 0.5rem 0;
    }
    #mobile-search-input {
        flex-grow: 1; background: #222; border: 1px solid #444;
        border-radius: 6px; padding: 0.5rem 1rem; color: white; font-size: 1rem;
    }
    #mobile-search-cancel {
        background: none; border: none; color: #ccc;
        font-size: 1rem; padding: 0.5rem 1rem;
    }

    /* Bottom bar: Filters & Tags */
    .mobile-filter-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 0.5rem;
    }
    #mobile-filter-btn, #mobile-tags-container > span {
        font-family: 'Inter', sans-serif; font-size: 0.9rem;
        font-weight: 500; color: #ccc; background: none;
        border: none; padding: 0.25rem;
    }

    /* --- 3. Reposition Modals & Dropdowns --- */
    #sort-view-modal {
        top: 175px; /* Position below sticky header */
        left: 1rem; right: auto;
        width: calc(100vw - 2rem); max-width: 350px;
        transform: none; transform-origin: top left;
    }
    #sort-view-modal #loading-options,
    #sort-view-modal #sidebar-options,
    #sort-view-modal #collapse-options {
        display: none;
    }
    #sort-view-modal #modal-grid-container {
        grid-template-columns: 1fr;
    }

    #mobile-tags-container { position: relative; }
    #guide-tag-filters {
        display: none; position: absolute;
        top: 120%; right: 0; background: #1a1a1a;
        padding: 0.75rem; border-radius: 8px;
        border: 1px solid var(--shadow-color-light);
        z-index: 40; flex-direction: column;
        align-items: flex-start; gap: 0.5rem; width: 200px;
    }
    #mobile-tags-container:focus-within #guide-tag-filters {
        display: flex;
    }
    .guide-tag-btn { width: 100%; text-align: left; }

    /* --- 4. Guide List & Pagination --- */
    #guide-post-list { padding: 0 1rem; }
    #guide-pagination-controls {
        position: fixed; bottom: 0; left: 0; width: 100%;
        background: rgba(10, 10, 10, 0.9);
        backdrop-filter: blur(5px); padding: 0.75rem;
        border-top: 1px solid var(--shadow-color-light);
        z-index: 25; margin-bottom: 0;
    }
    
    /* --- 5. Full Screen Guide View on Mobile --- */
    #guide-content-split.full-view-active #guide-post-viewer {
        position: fixed;
        top: 60px; /* Below main header */
        left: 0;
        right: 0;
        bottom: 0;
        background: #0a0a0a;
        z-index: 100;
        overflow-y: auto;
    }
}


</style>

</head>
    <div class="background"></div>
    
<header class="header">
    <!-- The text now comes FIRST -->
    <div class="header-text">
        <h1>UnOfficial P5X Wiki</h1>
        <p>By McBurn</p>
	<div id="header-info">
			<img src="https://hitscounter.dev/api/hit?url=https%3A%2F%2Fmcburnr.github.io%2Fp5xwiki.html&label=Phantom+Thieves&icon=github&color=%23b02a37&message=&style=for-the-badge&tz=UTC">
        </div>

    </div>
    <!-- And then I came SECOND -->
    <button id="menu-toggle" class="menu-toggle">
        <span></span>
        <span></span>
        <span></span>
    </button>
</header>

<!-- START: Corrected Quick Nav Overlay Structure -->
<div id="quick-nav-overlay">
    <div class="quick-nav-content">
        <div class="quick-nav-grid">
            <!-- Gameplay -->
            <div class="quick-nav-card" data-target="guide-forum-section" data-preview="Beginner's guide, daily activities, and progression tips.">
                <div class="quick-nav-card-bg" style="background-image: url('https://cdn.imgchest.com/files/4gdcx3vrow4.png');"></div>
                <div class="p5-funky-text">
                    <span class="p5-letter-box first-letter">G</span><span class="p5-letter-box">a</span><span class="p5-letter-box">m</span><span class="p5-letter-box">e</span><span class="p5-letter-box">p</span><span class="p5-letter-box">l</span><span class="p5-letter-box">a</span><span class="p5-letter-box last-letter">y</span>
                </div>
            </div>
            <!-- Arcana -->
            <div class="quick-nav-card" data-target="guide-arcana" data-preview="Revelation and Universe Arcana cards">
                <div class="quick-nav-card-bg" style="background-image: url('https://cdn.imgchest.com/files/yd5ce5zlmd4.png');"></div>
                <div class="p5-funky-text">
                    <span class="p5-letter-box first-letter">A</span><span class="p5-letter-box">r</span><span class="p5-letter-box">c</span><span class="p5-letter-box">a</span><span class="p5-letter-box">n</span><span class="p5-letter-box last-letter">a</span>
                </div>
            </div>
            <!-- Confidants https://cdn.imgchest.com/files/49zc2bpgvny.png-->
            <div class="quick-nav-card" data-target="guide-confidants" data-preview="Confidant guides,choices, and gifts">
                <div class="quick-nav-card-bg" style="background-image: url('https://cdn.imgchest.com/files/49zc2bpgvny.png');"></div>
                <div class="p5-funky-text">
                    <span class="p5-letter-box first-letter">C</span><span class="p5-letter-box">o</span><span class="p5-letter-box">n</span><span class="p5-letter-box">f</span><span class="p5-letter-box">i</span><span class="p5-letter-box">d</span><span class="p5-letter-box">a</span><span class="p5-letter-box">n</span><span class="p5-letter-box">t</span><span class="p5-letter-box last-letter">s</span>
                </div>
            </div>
            <!-- Personas https://cdn.imgchest.com/files/ye3c2vp38o4.png -->
            <div class="quick-nav-card" data-target="guide-personas" data-preview="Browse all Personas and their skills.">
                <div class="quick-nav-card-bg" style="background-image: url('https://cdn.imgchest.com/files/ye3c2vp38o4.png');"></div>
                <div class="p5-funky-text">
                    <span class="p5-letter-box first-letter">P</span><span class="p5-letter-box">e</span><span class="p5-letter-box">r</span><span class="p5-letter-box">s</span><span class="p5-letter-box">o</span><span class="p5-letter-box">n</span><span class="p5-letter-box">a</span><span class="p5-letter-box last-letter">s</span>
                </div>
            </div>
            <!-- Calculator -->
            <div class="quick-nav-card" data-target="guide-calculator" data-preview="Calculate damage">
                <div class="quick-nav-card-bg" style="background-image: url('https://cdn.imgchest.com/files/7w6c29mo3ey.png');"></div>
                <div class="p5-funky-text">
                    <span class="p5-letter-box first-letter">D</span><span class="p5-letter-box">a</span><span class="p5-letter-box">m</span><span class="p5-letter-box">a</span><span class="p5-letter-box">g</span><span class="p5-letter-box last-letter">e</span>
                </div>
            </div>
		   <!-- News -->
			<div class="quick-nav-card" data-target="guide-news" data-preview="View the latest official news and announcements.">
    <div class="quick-nav-card-bg" style="background-image: url('https://cdn.imgchest.com/files/4z9cvq8xz87.png');"></div>
    <div class="p5-funky-text">
        <span class="p5-letter-box first-letter">N</span><span class="p5-letter-box">E</span><span class="p5-letter-box">W</span><span class="p5-letter-box last-letter">S</span>
    </div>
</div>
            <!-- Units -->
            <a href="https://mcburnr.github.io/p5xunits.html" class="quick-nav-card" data-preview="Browse all playable units">
                <div class="quick-nav-card-bg" style="background-image: url('https://cdn.imgchest.com/files/739cxznmge7.png');"></div>
                <div class="p5-funky-text">
                    <span class="p5-letter-box first-letter">U</span><span class="p5-letter-box">n</span><span class="p5-letter-box">i</span><span class="p5-letter-box">t</span><span class="p5-letter-box last-letter">s</span>
                </div>
            </a>
        </div>
    </div>
</div>
<!-- END: Corrected Quick Nav Overlay Structure -->



<nav id="collapsible-sidebar" class="collapsible-sidebar">
<nav class="sidebar-nav">
    <div class="guide-card" data-target="guide-forum-section" data-preview="Beginner's guide, daily activities, and progression tips.">
        <img src="https://cdn.imgchest.com/files/4gdcx3vrow4.png" alt="Gameplay Guide Icon" class="guide-card-icon">
        <div class="guide-card-name">Gameplay</div>
    </div>
    <div class="guide-card" data-target="guide-arcana" data-preview="Explore all Revelation and Universe Arcana card sets and their effects.">
        <img src="https://cdn.imgchest.com/files/yd5ce5zlmd4.png" alt="Arcana Guide Icon" class="guide-card-icon">
        <div class="guide-card-name">Arcana</div>
    </div>
     <div class="guide-card" data-target="guide-personas" data-preview="Browse all Personas and their skills.">
        <img src="https://cdn.imgchest.com/files/ye3c2vp38o4.png" alt="Personas Icon" class="guide-card-icon">
        <div class="guide-card-name">Personas</div>
    </div>
    <div class="guide-card" data-target="guide-confidants" data-preview="View all confidant guides, rank-up choices, and gift preferences.">
        <img src="https://cdn.imgchest.com/files/49zc2bpgvny.png" alt="Confidants Guide Icon" class="guide-card-icon">
        <div class="guide-card-name">Confidants</div>
    </div>
    <div class="guide-card" data-target="guide-calculator" data-preview="Calculate potential damage output.">
        <img src="https://cdn.imgchest.com/files/7w6c29mo3ey.png" alt="Calculator Icon" class="guide-card-icon">
        <div class="guide-card-name">Calculator</div>
    </div>
    <a href="https://mcburnr.github.io/p5xunits.html" class="guide-card" data-preview="Browse all playable units, their skills, and builds.">
        <img src="https://cdn.imgchest.com/files/739cxznmge7.png" alt="Units Guide Icon" class="guide-card-icon">
        <div class="guide-card-name">Units</div>
    </a>
	    <div class="guide-card" data-target="guide-news" data-preview="View the latest official news and announcements.">
        <img src="https://cdn.imgchest.com/files/4z9cvq8xz87.png" alt="News Icon" class="guide-card-icon">
        <div class="guide-card-name">News</div>
    </div>
</nav>
</nav>

<div id="main-overlay" class="main-overlay"></div>

    <div class="site-wrapper">
        <main class="main-content-area">
            <div class="guide-content-container">
            
            
<section class="guide-content-panel active -mt-4" id="guide-forum-section">
    <div id="guide-forum-container" class="flex flex-col lg:flex-row gap-6">

        <nav id="guide-forum-sidebar" class="w-full lg:w-64 flex-shrink-0">
            <div id="sidebar-categories-container">
                <!-- Categories will be rendered here by JS -->
            </div>
            <!-- The controls wrapper will be appended here by JS -->
        </nav>

<main id="guide-forum-main" class="flex-grow min-w-0">
    <!-- This new container is the destination for the filter panel when the sidebar is hidden -->
    <div id="top-controls-container"></div>

    <div id="guide-main-grid" class="grid grid-cols-1 gap-6">
        <!-- The controls wrapper starts here in the HTML but gets moved by JS -->
        <div id="guide-controls-wrapper" class="hidden"> 
            <div id="guide-controls-content">
                <div class="flex items-center justify-between gap-2 mb-4">
                    <h2 id="forum-title" class="text-2xl font-bold font-['Cinzel',_serif] text-white cursor-pointer flex items-center gap-3" title="Open Quick Navigate">
                        <!-- Title will be generated here -->
                    </h2>
<button id="sort-view-btn" class="p5-button flex-shrink-0">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
        <circle cx="12" cy="12" r="3"></circle>
    </svg>
</button>
                </div>
                <div class="relative w-full mb-4">
                    <input type="text" id="guide-search-input" placeholder="Search current forum...">
                </div>
                <div id="guide-pagination-controls" class="flex items-center justify-center gap-2 mb-4"></div>
                <div id="guide-tag-filters" class="flex flex-wrap items-center gap-2 pb-4 border-b-2 border-gray-700"></div>
            </div>
        </div>

        <!-- The content area is now the only direct child of the grid -->
        <div id="guide-content-area" class="min-w-0">
            <div id="guide-content-split" class="flex">
                <div id="guide-post-list" class="w-full transition-all duration-300 ease-in-out"></div>
                <div id="guide-post-viewer" class="w-0 opacity-0 transition-all duration-300 ease-in-out"></div>
            </div>
        </div>
    </div>
</main>

    </div>

<div id="sort-view-modal" class="hidden absolute z-50 right-0 mt-2 w-72 bg-gray-900 border border-gray-700 rounded-lg shadow-lg p-4">
    <button id="close-sort-modal-btn" class="absolute top-2 right-3 text-2xl text-gray-400 hover:text-white">&times;</button>
    
    <div id="modal-grid-container">
        <div>
            <h4 class="font-bold mb-2">Sort By</h4>
            <div class="space-y-1" id="sort-options">
                <label class="flex items-center"><input type="radio" name="sort" value="date-desc" class="custom-radio"> <span class="ml-2">Date Posted (Newest)</span></label>
                <label class="flex items-center"><input type="radio" name="sort" value="date-asc" class="custom-radio"> <span class="ml-2">Date Posted (Oldest)</span></label>
            </div>
        </div>

        <div>
            <h4 class="font-bold mb-2">View As</h4>
            <div class="space-y-1" id="view-options">
                <label class="flex items-center"><input type="radio" name="view" value="gallery" class="custom-radio"> <span class="ml-2">Gallery</span></label>
                <label class="flex items-center"><input type="radio" name="view" value="list" class="custom-radio"> <span class="ml-2">List</span></label>
            </div>
        </div>

        <div>
            <h4 class="font-bold mb-2">Guides Per Page</h4>
            <div class="space-y-1 mb-4" id="pagination-options">
                <select id="guides-per-page-select" class="w-full bg-gray-800 border border-gray-600 rounded-md px-3 py-2 text-white focus:ring-red-500 focus:border-red-500">
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                </select>
            </div>
        </div>
        
        <div>
            <h4 class="font-bold mb-2">Guide View</h4>
            <div class="space-y-1" id="loading-options">
                <label class="flex items-center"><input type="radio" name="loading" value="side" class="custom-radio"> <span class="ml-2">Side-Load</span></label>
                <label class="flex items-center"><input type="radio" name="loading" value="full" class="custom-radio"> <span class="ml-2">Full View</span></label>
            </div>
        </div>

        <div>
            <h4 class="font-bold mb-2">Categories Default</h4>
            <div class="space-y-1" id="collapse-options">
                <label class="flex items-center"><input type="radio" name="collapse" value="expanded" class="custom-radio"> <span class="ml-2">Expanded</span></label>
                <label class="flex items-center"><input type="radio" name="collapse" value="collapsed" class="custom-radio"> <span class="ml-2">Collapsed</span></label>
            </div>
        </div>
        
        <div>
            <h4 class="font-bold mb-2">Sidebar View</h4>
            <div class="space-y-1" id="sidebar-options">
                <label class="flex items-center"><input type="radio" name="sidebar" value="show" class="custom-radio"> <span class="ml-2">Show</span></label>
                <label class="flex items-center"><input type="radio" name="sidebar" value="hide" class="custom-radio"> <span class="ml-2">Hide</span></label>
            </div>
        </div>
    </div>
</div>

    <div id="quick-nav-modal" class="hidden fixed inset-0 bg-black/80 z-[2500] flex items-center justify-center p-4">
        <div id="quick-nav-modal-content" class="bg-gray-900 border border-gray-700 rounded-xl w-full max-w-4xl max-h-[80vh] flex flex-col">
            <div class="p-4 border-b border-gray-700 flex justify-between items-center">
                <h3 class="text-2xl font-['Cinzel',_serif] text-red-500">Quick Navigate</h3>
                <button id="quick-nav-close-btn" class="text-3xl text-gray-400 hover:text-white">&times;</button>
            </div>
            <div id="quick-nav-grid" class="p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            </div>
        </div>
    </div>
</section>

			
			
            <section class="guide-content-panel" id="guide-arcana">
        <div class="text-center mb-10">
            <p id="credits" class="text-gray-500 mt-2">Guide by UnnamedRando on <a href="https://discord.gg/p5xworldwide">P5X Worldwide Discord Server</a></p>
        </div>
				<div class="search-container-arcana">
                    <input type="text" id="arcanaSearchInput" placeholder="Search for cards by name or effect..." autocomplete="off">
                </div>
                <div class="arcana-tabs">
                    <button class="arcana-tab active" data-tab="revelation">Revelation Cards</button>
                    <button class="arcana-tab" data-tab="universe">Universe Cards</button>
                </div>
                    <!-- Ok I did cheat a little here and use CTRL + V an unholy amount of times -->
                <div class="arcana-tab-content active" id="arcana-content-revelation">
                    <h3>Revelation Cards</h3>
                    <div class="arcana-grid">
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/7ogcbkr86oy.png" alt="Control" class="arcana-card-image"><div class="arcana-card-title">Control</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> HP increased by <span class="highlight-number">12%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> When using skills to attack an enemy, it will cause additional damage of <span class="highlight-number">8%</span> of its own health to the main target.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/y2pcko39eb7.png" alt="Courage" class="arcana-card-image"><div class="arcana-card-title">Courage</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Physical damage increased by <span class="highlight-number">10%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Crit DMG is increased by <span class="highlight-number">30%</span>, lasting for <span class="highlight-number">2</span> rounds; the same effect will be obtained again after causing a critical hit.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/7lxcpdjg5o7.png" alt="Defeat" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Defeat</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increases Effect Hit Rate by <span class="highlight-number">15%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Increases fire damage to enemies affected by ailments by <span class="highlight-number">20%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/yq9c3eb5w34.png" alt="Despair" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Despair</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increase ATK by <span class="highlight-number">12%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> When dealing Persona skill damage, increase the current Persona skill damage by <span class="highlight-number">25%</span> if your last Persona skill damage was a different element.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/yrgcnzbkp84.png" alt="Fixation" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Fixation</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increase ATK by <span class="highlight-number">12%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Increase ATK by <span class="highlight-number">25%</span> for <span class="highlight-number">3</span> turns; Gain this effect again when you use Theurgy.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/7mmc9rqwdg7.png" alt="Futility" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Futility</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increase ATK by <span class="highlight-number">12%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Increase EHR by <span class="highlight-number">30%</span> for <span class="highlight-number">2</span> turns; Gain this effect again when you deal TECHNICAL.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/739cx6bn2n7.png" alt="Labor" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Labor</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increase HP by <span class="highlight-number">12%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> When equipped by Navigator Thieves: Increase all allies' HP, ATK and DEF by <span class="highlight-number">8%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/7w6c2v6ma6y.png" alt="Love" class="arcana-card-image"><div class="arcana-card-title">Love</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> The healing effect is increased by <span class="highlight-number">9%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> When treating a party member whose health value is not higher than <span class="highlight-number">50%</span>, the healing effect will be increased by <span class="highlight-number">23%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/ye3c2dwp9j4.png" alt="Oppression" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Oppression</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increase Physical DMG by <span class="highlight-number">10%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Gain [Resentment] after every hit of skill damage: Increase ATK by <span class="highlight-number">5%</span> for <span class="highlight-number">2</span> turn up to <span class="highlight-number">6</span> stacks.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/4z9cvwj86m7.png" alt="Opulence" class="arcana-card-image"><div class="arcana-card-title">Opulence</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Ice DMG increased by <span class="highlight-number">10%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Follow-up attack damage is increased by <span class="highlight-number">40%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/4gdcxpwv654.png" alt="Peace" class="arcana-card-image"><div class="arcana-card-title">Peace</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Defense increased by <span class="highlight-number">20%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Shield effect increased by <span class="highlight-number">18%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/y8xcnkvljm4.png" alt="Pleasure" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Pleasure</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increase Psy DMG by <span class="highlight-number">10%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Increase ATK by <span class="highlight-number">15%</span> when dealing Psy damage. Additionally increase ATK by <span class="highlight-number">15%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/45xcv9pkrw7.png" alt="Power" class="arcana-card-image"><div class="arcana-card-title">Power</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Own attack increased by <span class="highlight-number">12%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Increase own attack by <span class="highlight-number">10%</span> every <span class="highlight-number">6</span> turns (Enemies and allies turn count for this effect), can be stacked <span class="highlight-number">3</span> times.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/4apc53qdeb4.png" alt="Prosperity" class="arcana-card-image"><div class="arcana-card-title">Prosperity</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Reduces incoming DMG by <span class="highlight-number">8%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> When entering battle immediately recovers <span class="highlight-number">25%</span> of HIGHLIGHT charge, doesn't stack.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/46acqb8a2b7.png" alt="Prudence" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Prudence</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Decrease SPD by <span class="highlight-number">3</span>, Increase ATK by <span class="highlight-number">18%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Increase DMG Dealt by <span class="highlight-number">16%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/yvdcwdzb5ny.png" alt="Reconciliation" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Reconciliation</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increases Speed by <span class="highlight-number">6</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> During combat your HP, ATK, DEF increase by <span class="highlight-number">15%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/yxkczgvj6k7.png" alt="Renewal" class="arcana-card-image"><div class="arcana-card-title">Renewal</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Electric damage increased by <span class="highlight-number">10%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> After any party member uses electric skills, the user's own electric damage will be increased by <span class="highlight-number">9%</span>, up to <span class="highlight-number">3</span> stacks.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/49zc2begq3y.png" alt="Ruin" class="arcana-card-image"><div class="arcana-card-title">Ruin</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Curse damage increased by <span class="highlight-number">10%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Increase skill damage to enemies with debuffs by <span class="highlight-number">20%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/4nec8mbwpp4.png" alt="Strife" class="arcana-card-image"><div class="arcana-card-title">Strife</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Fire damage increased by <span class="highlight-number">10%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Attack increased by <span class="highlight-number">15%</span>. If the enemy is weak to fire, the attack will be increased by an additional <span class="highlight-number">15%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/7bwckd3gzl7.png" alt="Success" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Success</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increases Crit Rate by <span class="highlight-number">7.5%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Follow Up Attack Damage is increased by <span class="highlight-number">40%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/7kzcab9ejr7.png" alt="Truth" class="arcana-card-image"><div class="arcana-card-title">Truth</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increase Nuke DMG by <span class="highlight-number">10%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Deal <span class="highlight-number">30%</span> ATK damage to the main target if the enemy is inflicted with Elemental Ailments.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/y2pcko39gb7.png" alt="Victory" class="arcana-card-image"><div class="arcana-card-title">Victory</div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Wind damage increased by <span class="highlight-number">10%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Each attack has a <span class="highlight-number">25%</span> fixed probability of causing additional damage equal to <span class="highlight-number">20%</span> of your own attack.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/7lxcpdjgqo7.png" alt="Virtue" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Virtue</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increase Bless DMG by <span class="highlight-number">10%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> Increase Bless skill CRIT by <span class="highlight-number">12%</span> when your HP% is not less than <span class="highlight-number">50%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/4jdcvj2wox4.png" alt="Worry" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Worry</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>2-Set:</strong> Increases SP Recovery by <span class="highlight-number">80%</span>.</div><div class="arcana-card-effect"><strong>4-Set:</strong> When entering battle immediately recovers <span class="highlight-number">25%</span> of HIGHLIGHT charge, doesn't stack.</div></div>
                    </div>
                </div>

                <div class="arcana-tab-content" id="arcana-content-universe">
                    <h3>Universe Cards</h3>
                    <div class="arcana-grid">
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/7pjcqwbbdg7.png" alt="Acceptance" class="arcana-card-image"><div class="arcana-card-title">Acceptance</div></div><div class="arcana-card-effect"><strong>Peace:</strong> Increase DEF by <span class="highlight-number">40%</span> for <span class="highlight-number">2</span> turns when attacked.</div><div class="arcana-card-effect"><strong>Strife:</strong> Each enemy on field increases your attack by <span class="highlight-number">8%</span>, up to <span class="highlight-number">40%</span>.</div><div class="arcana-card-effect"><strong>Love:</strong> Increase ATK by <span class="highlight-number">25%</span> when using Healing skills.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/7bwckd33em7.png" alt="Awareness" class="arcana-card-image"><div class="arcana-card-title">Awareness</div></div><div class="arcana-card-effect"><strong>Truth:</strong> Increase DMG Dealt by <span class="highlight-number">12%</span> when attacking enemies inflicted with Elemental Ailments, up to <span class="highlight-number">2</span> stacks.</div><div class="arcana-card-effect"><strong>Control:</strong> Increase all allies' Fire DMG by <span class="highlight-number">6%</span> for <span class="highlight-number">2</span> turns when you inflict Burn.</div><div class="arcana-card-effect"><strong>Ruin:</strong> Increase ATK by <span class="highlight-number">9%</span> after every hit of damage to enemy with debuffs for <span class="highlight-number">1</span> turn, up to <span class="highlight-number">3</span> stacks.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/7kzcab99wl7.png" alt="Creation" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Creation</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>Worry:</strong> Increases CRIT DMG by <span class="highlight-number">15%</span>/<span class="highlight-number">30%</span>/<span class="highlight-number">45%</span> when you have <span class="highlight-number">100%</span>/<span class="highlight-number">150%</span>/<span class="highlight-number">200%</span> SP Recovery</div><div class="arcana-card-effect"><strong>Reconciliation:</strong> At the start of battle, increases the DMG Dealt of the ally with the lowest SPD by <span class="highlight-number">12%</span>, doesn't stack</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/7ogcbkrrw9y.png" alt="Departure" class="arcana-card-image"><div class="arcana-card-title">Departure</div></div><div class="arcana-card-effect"><strong>Control:</strong> Decrease main target's DEF by <span class="highlight-number">23%</span> for <span class="highlight-number">2</span> turns after attacking them with a skill.</div><div class="arcana-card-effect"><strong>Prosperity:</strong> Increase all allies' DMG Dealt by <span class="highlight-number">8%</span> for <span class="highlight-number">1</span> turn when attacking enemies.</div><div class="arcana-card-effect"><strong>Ruin:</strong> Increase ATK by <span class="highlight-number">30%</span> for <span class="highlight-number">3</span> turns after defeating an enemy.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/4nec8mbbnx4.png" alt="Faith" class="arcana-card-image"><div class="arcana-card-title">Faith</div></div><div class="arcana-card-effect"><strong>Peace:</strong> After granting Shield, increase the target's DEF by <span class="highlight-number">7%</span> for <span class="highlight-number">2</span> turns up to <span class="highlight-number">3</span> stacks.</div><div class="arcana-card-effect"><strong>Love:</strong> Increase Healing Effect by <span class="highlight-number">1%</span> for every <span class="highlight-number">800</span> HP you have, up to <span class="highlight-number">20%</span>.</div><div class="arcana-card-effect"><strong>Futility:</strong> Increase all Thieves' DMG Dealt to enemies under TECHNICAL Ailment by <span class="highlight-number">10%</span>, can't be triggered again.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/49zc2bee9qy.png" alt="Freedom" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Freedom</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>Success:</strong> Gain <span class="highlight-number">1</span> [Glory] when using a persona skill, up to <span class="highlight-number">2</span> stacks. When triggering a Follow Up, consumes all [Glory] to increase that Follow Up's PEN by <span class="highlight-number">8%</span> per stack.</div><div class="arcana-card-effect"><strong>Defeat:</strong> Increases all allies' DMG Dealt to enemies with debuffs by <span class="highlight-number">8%</span>, doesn't stack</div><div class="arcana-card-effect"><strong>Despair:</strong> When dealing Almighty damage, increase ATK by <span class="highlight-number">35%</span> and CRIT Rate by <span class="highlight-number">12%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/yxkczgvvkw7.png" alt="Growth" class="arcana-card-image"><div class="arcana-card-title">Growth</div></div><div class="arcana-card-effect"><strong>Opulence:</strong> Increase Ice DMG Bonus by <span class="highlight-number">10%</span> for <span class="highlight-number">2</span> turns when triggering Follow Up, up to <span class="highlight-number">3</span> stacks.</div><div class="arcana-card-effect"><strong>Renewal:</strong> Increase Follow Up CRIT DMG by <span class="highlight-number">50%</span>.</div><div class="arcana-card-effect"><strong>Power:</strong> Increase the cap of the ATK buff up to <span class="highlight-number">5</span> stacks.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/yvdcwdzzggy.png" alt="Harmony" class="arcana-card-image"><div class="arcana-card-title">Harmony</div></div><div class="arcana-card-effect"><strong>Victory:</strong> Increase the target's DMG Taken by <span class="highlight-number">12%</span> for <span class="highlight-number">2</span> turns when triggering the effect of the Revelation card's buff.</div><div class="arcana-card-effect"><strong>Power:</strong> Increase DMG Bonus by <span class="highlight-number">10%</span> for all allies with the same element, can't be triggered again.</div><div class="arcana-card-effect"><strong>Truth:</strong> Increase all allies' Nuke DMG by <span class="highlight-number">5%</span> for <span class="highlight-number">2</span> turns when inflicting Elemental Ailments, each stack is counted independently.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/46acqb883g7.png" alt="Hope" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Hope</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>Fixation:</strong> When dealing <span class="highlight-number">1</span> hit of skill damage, increase own Fire DMG by <span class="highlight-number">3%</span> for <span class="highlight-number">3</span> turns, up to <span class="highlight-number">8</span> stacks; When reaching <span class="highlight-number">8</span> stacks, additionally increase own CRIT Rate by <span class="highlight-number">6%</span>.</div><div class="arcana-card-effect"><strong>Labor:</strong> When equipped by Elucidate Thieves: When using a skill on allies, increase the skill target's PEN by <span class="highlight-number">5%</span> for <span class="highlight-number">1</span> turn.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/4apc53qqw34.png" alt="Integrity" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Integrity</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>Pleasure:</strong> Increase DMG Bonus up to <span class="highlight-number">30%</span> based on <span class="highlight-number">80%</span> of your Healing Bonus.</div><div class="arcana-card-effect"><strong>Labor:</strong> When equipped by Navigator Thieves: Increase all allies' HP, ATK and DEF by an additional <span class="highlight-number">2%</span> with each ally with the same element.</div><div class="arcana-card-effect"><strong>Fixation:</strong> After using Theurgy, increase all Thieves' DMG Dealt by <span class="highlight-number">10%</span> for <span class="highlight-number">3</span> turns.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/45xcv9ppqe7.png" alt="Meditation" class="arcana-card-image"><div class="arcana-card-title">Meditation</div></div><div class="arcana-card-effect"><strong>Opulence:</strong> Increase Follow Up CRIT DMG by <span class="highlight-number">50%</span>.</div><div class="arcana-card-effect"><strong>Courage:</strong> Increase Physical and Electric DMG by <span class="highlight-number">12%</span>. Increase the effect to <span class="highlight-number">24%</span> when there's only <span class="highlight-number">1</span> enemy.</div><div class="arcana-card-effect"><strong>Love:</strong> Increase Healing Effect by <span class="highlight-number">28%</span> for <span class="highlight-number">2</span> turns after landing a Crit.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/4gdcxpwwoe4.png" alt="Resolve" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Resolve</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>Virtue:</strong> Increase DMG Bonus by <span class="highlight-number">10%</span>/<span class="highlight-number">20%</span>/<span class="highlight-number">30%</span> when you reached <span class="highlight-number">6000</span>/<span class="highlight-number">9000</span>/<span class="highlight-number">12000</span> HP.</div><div class="arcana-card-effect"><strong>Labor:</strong> When equipped by Navigator Thieves: Decrease the main target's DEF by <span class="highlight-number">10%</span> for <span class="highlight-number">2</span> turns when inflicting debuffs.</div><div class="arcana-card-effect"><strong>Prudence:</strong> At the start of battle, if your SPD is at the <span class="highlight-number">3rd</span>/<span class="highlight-number">4th</span> slot, then additionally increase own ATK by <span class="highlight-number">24%</span>/<span class="highlight-number">30%</span>.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/ye3c2dww8l4.png" alt="Trust" class="arcana-card-image"><div class="arcana-card-title">Trust</div></div><div class="arcana-card-effect"><strong>Renewal:</strong> Increase all allies' Electric DMG by <span class="highlight-number">12%</span> when the Electric DMG buff effect reached <span class="highlight-number">3</span> stacks, can't be triggered again</div><div class="arcana-card-effect"><strong>Power:</strong> When the battle starts, increase the attack of other party members by <span class="highlight-number">10%</span> and cannot be triggered repeatedly.</div><div class="arcana-card-effect"><strong>Prosperity:</strong> When using skills on allies, the damage of all party members will be increased by <span class="highlight-number">8%</span> for <span class="highlight-number">2</span> rounds.</div></div>
                        <div class="arcana-card"><div class="arcana-card-header"><img src="https://cdn.imgchest.com/files/739cx6bbgb7.png" alt="Wisdom" class="arcana-card-image"><div class="arcana-card-title-wrapper"><div class="arcana-card-title">Wisdom</div><span class="global-note">Not on Global</span></div></div><div class="arcana-card-effect"><strong>Oppression:</strong> Increase Physical DMG and Effect Hit Rate by <span class="highlight-number">20%</span> when [Resentment] is not less than <span class="highlight-number">5</span> stacks.</div><div class="arcana-card-effect"><strong>Pleasure:</strong> Increase DMG Bonus up to <span class="highlight-number">30%</span> based on <span class="highlight-number">50%</span> of your Effect Hit Rate.</div><div class="arcana-card-effect"><strong>Virtue:</strong> When using HIGHLIGHT, increases ATK by <span class="highlight-number">30%</span> and DMG Dealt by <span class="highlight-number">25%</span>.</div></div>
                    </div>
                </div>
            </section>

 

            <section class="guide-content-panel" id="guide-confidants">
        <div class="text-center mb-10">
            <h1 class="text-5xl md:text-6xl font-bold text-white uppercase">Confidants</h1>
            <p id="credits" class="text-gray-500 mt-2">Guide by UnnamedRando on <a href="https://discord.gg/p5xworldwide">P5X Worldwide Discord Server</a></p>
        </div>
                <div class="confidant-grid-container">
                    <!-- confidant icons -->
                </div>
            </section>
        </div>
		
<section class="guide-content-panel" id="guide-calculator">
    <div class="max-w-7xl mx-auto">
        <div class="text-center mb-10">
            <h1 class="text-5xl md:text-6xl font-bold text-white uppercase">P5X Damage Calculator</h1>
            <p id="credits" class="text-gray-500 mt-2">Damage Calculations by AbsolRoot on <a href="https://lufel.net">Lufel.net</a></p>
            <p id="credits" class="text-gray-500 mt-2">Spreadsheet & Adjustments by Mathieu/mathieubdg on Discord</p>
        </div>

        <!-- Main Calculator Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            
            <!-- A: Attack Power -->
            <div class="calculator-card border-red-500 rounded-lg p-4 space-y-3">
                <h2 class="text-2xl text-white">ⓐ Attack Power</h2>
                <div><label for="char_atk" class="block mb-1 text-xs font-medium text-gray-300">Character Attack</label><div class="input-group"><input type="number" id="char_atk" class="input-field py-2" value="0" step="any"></div></div>
                <div><label for="weapon_atk" class="block mb-1 text-xs font-medium text-gray-300">Weapon Attack</label><div class="input-group"><input type="number" id="weapon_atk" class="input-field py-2" value="0" step="any"></div></div>
                <div><label for="atk_percent" class="block mb-1 text-xs font-medium text-gray-300">Attack %</label><div class="input-group"><input type="number" id="atk_percent" class="input-field py-2" value="0" step="any"><span class="input-adornment">%</span></div></div>
                <div><label for="atk_flat" class="block mb-1 text-xs font-medium text-gray-300">Flat Attack</label><div class="input-group"><input type="number" id="atk_flat" class="input-field py-2" value="0" step="any"></div></div>
                <div class="pt-1"><label class="block mb-1 text-xs font-bold uppercase tracking-wider text-red-400">Result</label><div id="atk_power_result" class="output-field p-2 rounded text-center text-xl">0.00</div></div>
            </div>

            <!-- B: Damage Bonus -->
            <div class="calculator-card border-yellow-500 rounded-lg p-4 space-y-3">
                <h2 class="text-2xl text-white">ⓑ Damage Bonus</h2>
                <div><label for="atk_multiplier" class="block mb-1 text-xs font-medium text-gray-300">Attack Multiplier</label><div class="input-group"><input type="number" id="atk_multiplier" class="input-field py-2" value="0" step="any"><span class="input-adornment">%</span></div></div>
                <div><label for="elemental_multiplier" class="block mb-1 text-xs font-medium text-gray-300">Elemental Damage</label><div class="input-group"><input type="number" id="elemental_multiplier" class="input-field py-2" value="0" step="any"><span class="input-adornment">%</span></div></div>
                <div><label for="enemy_damage_taken" class="block mb-1 text-xs font-medium text-gray-300">Increased Damage Taken</label><div class="input-group"><input type="number" id="enemy_damage_taken" class="input-field py-2" value="0" step="any"><span class="input-adornment">%</span></div></div>
                <div class="pt-1"><label class="block mb-1 text-xs font-bold uppercase tracking-wider text-yellow-400">Result</label><div id="dmg_bonus_result" class="output-field p-2 rounded text-center text-xl">100.00%</div></div>
            </div>

            <!-- C: Enemy Defense -->
            <div class="calculator-card border-blue-500 rounded-lg p-4 space-y-3">
                <h2 class="text-2xl text-white">ⓒ Enemy Defense</h2>
                <div><label for="enemy_def" class="block mb-1 text-xs font-medium text-gray-300">Enemy Defense</label><div class="input-group"><input type="number" id="enemy_def" class="input-field py-2" value="0" step="any"></div></div>
                <div><label for="add_def_coeff" class="block mb-1 text-xs font-medium text-gray-300">Add. Defense Coeff.</label><div class="input-group"><input type="number" id="add_def_coeff" class="input-field py-2" value="0" step="any"><span class="input-adornment">%</span></div></div>
                <div><label for="pierce_rate" class="block mb-1 text-xs font-medium text-gray-300">Pierce Rate</label><div class="input-group"><input type="number" id="pierce_rate" class="input-field py-2" value="0" step="any"><span class="input-adornment">%</span></div></div>
                <div><label for="def_reduction" class="block mb-1 text-xs font-medium text-gray-300">Defense Reduction</label><div class="input-group"><input type="number" id="def_reduction" class="input-field py-2" value="0" step="any"><span class="input-adornment">%</span></div></div>
                <div><label for="winded" class="block mb-1 text-xs font-medium text-gray-300">Winded?</label><div class="input-group"><select id="winded" class="input-field py-2"><option value="not_winded">No</option><option value="winded">Yes</option></select></div></div>
                <div class="pt-1"><label class="block mb-1 text-xs font-bold uppercase tracking-wider text-blue-400">Result (Multiplier)</label><div id="enemy_def_result" class="output-field p-2 rounded text-center text-xl">0.0000</div></div>
            </div>

            <!-- D: Critical Calculation -->
            <div class="calculator-card border-green-500 rounded-lg p-4 space-y-3">
                <h2 class="text-2xl text-white">ⓓ Critical Calculation</h2>
                <div><label for="crit_rate" class="block mb-1 text-xs font-medium text-gray-300">Critical Rate</label><div class="input-group"><input type="number" id="crit_rate" class="input-field py-2" value="0" step="any"><span class="input-adornment">%</span></div></div>
                <div><label for="crit_effect" class="block mb-1 text-xs font-medium text-gray-300">Critical Effect</label><div class="input-group"><input type="number" id="crit_effect" class="input-field py-2" value="150" step="any"><span class="input-adornment">%</span></div></div>
                <div class="pt-1"><label class="block mb-1 text-xs font-bold uppercase tracking-wider text-green-400">Result (Avg. Multiplier)</label><div id="crit_calc_result" class="output-field p-2 rounded text-center text-xl">100.00%</div></div>
            </div>

            <!-- E: Skill Coefficient -->
            <div class="calculator-card border-purple-500 rounded-lg p-4 space-y-3">
                <h2 class="text-2xl text-white">ⓔ Skill Coefficient</h2>
                <div><label for="skill_coeff" class="block mb-1 text-xs font-medium text-gray-300">Skill Coefficient</label><div class="input-group"><input type="number" id="skill_coeff" class="input-field py-2" value="100" step="any"><span class="input-adornment">%</span></div></div>
                <div class="pt-1"><label class="block mb-1 text-xs font-bold uppercase tracking-wider text-purple-400">Result (Multiplier)</label><div id="skill_coeff_result" class="output-field p-2 rounded text-center text-xl">100.00%</div></div>
            </div>

            <!-- F: Weakness Coefficient -->
            <div class="calculator-card border-cyan-500 rounded-lg p-4 space-y-3">
                <h2 class="text-2xl text-white">ⓕ Weakness Coefficient</h2>
                <div><label for="weakness_coeff" class="block mb-1 text-xs font-medium text-gray-300">Enemy Resistance</label><div class="input-group"><select id="weakness_coeff" class="input-field py-2"><option value="1">Normal (100%)</option><option value="1.2">Weak (120%)</option><option value="0.5">Resist (50%)</option></select></div></div>
                <div class="pt-1"><label class="block mb-1 text-xs font-bold uppercase tracking-wider text-cyan-400">Result (Multiplier)</label><div id="weakness_coeff_result" class="output-field p-2 rounded text-center text-xl">100.00%</div></div>
            </div>

            <!-- G: Final Damage Bonus -->
            <div class="calculator-card border-pink-500 rounded-lg p-4 space-y-3">
                <h2 class="text-2xl text-white">ⓖ Final Damage Bonus</h2>
                <div><label for="final_dmg_bonus" class="block mb-1 text-xs font-medium text-gray-300">Final Damage Bonus</label><div class="input-group"><input type="number" id="final_dmg_bonus" class="input-field py-2" value="0" step="any"><span class="input-adornment">%</span></div></div>
                <div class="pt-1"><label class="block mb-1 text-xs font-bold uppercase tracking-wider text-pink-400">Result (Multiplier)</label><div id="final_dmg_bonus_result" class="output-field p-2 rounded text-center text-xl">100.00%</div></div>
            </div>
        </div>

        <!-- Final Damage Output -->
        <div class="mt-8 bg-gray-900 border-2 border-red-600 rounded-xl p-6 shadow-lg shadow-red-500/20">
            <h2 class="text-4xl text-center text-white uppercase">Final Damage Estimate</h2>
            <div id="total_damage_result" class="text-6xl text-center font-bold text-red-500 mt-4">0 ~ 0</div>
            <p class="text-center text-gray-400 mt-2">(Based on a random range coefficient of 0.95 to 1.05)</p>
        </div>
    </div>
</section>

<!-- SECTION FOR PERSONAS -->
<section class="guide-content-panel" id="guide-personas">
    <div class="text-center mb-10">
        <h1 class="text-5xl md:text-6xl font-bold text-white uppercase">P5X Persona's Guide</h1>
        <p id="credits" class="text-gray-500 mt-2">Data by Iant on P5X Worldwide Discord Server</p>
        <p id="credits" class="text-gray-500 mt-2">Original Guide by AbsolRoot on <a href="https://lufel.net">Lufel.net</a></p>
    </div>

    <div id="persona-filter-controls" class="mb-4 flex justify-center items-center gap-4">
        <button id="filter-panel-toggle" class="p5-button">
            <span>Filter Personas</span>
            <svg id="filter-toggle-indicator" class="w-4 h-4 ml-2 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </button>
        <button id="filter-position-toggle" class="p5-button-secondary" title="Toggle Filter Position">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path></svg>
        </button>
    </div>

    <div id="persona-filters-wrapper">
        <div class="search-container-persona" style="margin-bottom: 1.5rem;">
            <input type="text" id="personaSearchInput" placeholder="Search Personas by name or keyword..." autocomplete="off" style="width: 100%; padding: 10px 15px; font-size: 1rem; font-family: 'Crimson Text', serif; color: #fff; background-color: rgba(20, 20, 20, 0.7); border: 1px solid var(--shadow-color-light); border-radius: 8px; outline: none; transition: all 0.3s ease;">
        </div>
        <div class="persona-filter-container" style="margin-bottom: 2rem; display: flex; flex-direction: column; align-items: center; gap: 0.5rem; padding: 0 1rem;">
            <label for="rarityFilter" class="text-lg font-semibold text-white">Filter by Rarity: <span id="rarityValue" class="font-bold text-red-400">All</span></label>
            <div class="w-full max-w-md relative" style="padding-top: 20px;">
                <div class="rarity-ticks">
                    <div class="rarity-tick" data-value="2">★</div>
                    <div class="rarity-tick" data-value="3">★</div>
                    <div class="rarity-tick" data-value="4">★</div>
                    <div class="rarity-tick" data-value="5">★</div>
                    <div class="rarity-tick" data-value="6">All</div>
                </div>
                <input type="range" id="rarityFilter" min="2" max="6" value="6" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer rarity-slider">
            </div>
        </div>
        <div class="persona-element-filter-container" style="margin-bottom: 1.5rem; padding: 0 1rem; text-align: center;">
            <label class="text-lg font-semibold text-white mb-2 block">Filter by Element</label>
            <div id="element-filter-grid" class="flex flex-wrap justify-center gap-2">
                <button class="element-filter-btn all active" data-element="All">All</button>
                <button class="element-filter-btn physical" data-element="Physical"><img src="https://cdn.imgchest.com/files/49zc2vk9qdy.png" alt="Physical"></button>
                <button class="element-filter-btn gun" data-element="Gun"><img src="https://cdn.imgchest.com/files/7kzcax8wja7.png" alt="Gun"></button>
                <button class="element-filter-btn fire" data-element="Fire"><img src="https://cdn.imgchest.com/files/4apc5vlwkq4.png" alt="Fire"></button>
                <button class="element-filter-btn ice" data-element="Ice"><img src="https://cdn.imgchest.com/files/y2pck5a5dv7.png" alt="Ice"></button>
                <button class="element-filter-btn electric" data-element="Electric"><img src="https://cdn.imgchest.com/files/739cxk5kjp7.png" alt="Electric"></button>
                <button class="element-filter-btn wind" data-element="Wind"><img src="https://cdn.imgchest.com/files/46acqgvgpe7.png" alt="Wind"></button>
                <button class="element-filter-btn psychokinesis" data-element="Psychokinesis"><img src="https://cdn.imgchest.com/files/yvdcwn9gkjy.png" alt="Psychokinesis"></button>
                <button class="element-filter-btn nuclear" data-element="Nuclear"><img src="https://cdn.imgchest.com/files/7ogcbxpwrxy.png" alt="Nuclear"></button>
                <button class="element-filter-btn bless" data-element="Bless"><img src="https://cdn.imgchest.com/files/4apc5vlpbe4.png" alt="Bless"></button>
                <button class="element-filter-btn curse" data-element="Curse"><img src="https://cdn.imgchest.com/files/4jdcv6zebw4.png" alt="Curse"></button>
                <button class="element-filter-btn almighty" data-element="Almighty"><img src="https://cdn.imgchest.com/files/yq9c3va2w54.png" alt="Almighty"></button>
            </div>
        </div>
    </div>
    <!-- END: New Filter Wrapper -->

    <div class="persona-grid-container" id="persona-grid-container">
        <!-- Persona cards -->
    </div>
</section>

<section class="guide-content-panel" id="guide-news">
        <div class="text-center mb-10">
            <h1 class="text-5xl md:text-6xl font-bold text-white uppercase">Latest News</h1>
            <p id="credits" class="text-gray-500 mt-2">Latest announcements from the official P5X website.</p>
        </div>
        <div id="news-articles-container" class="space-y-4">
            <p class="text-center text-xl">Loading latest news...</p>
        </div>
    </section>

<!-- MODAL FOR PERSONA DETAILS -->
<div class="modal" id="personaModal">
    <div class="modal-content persona-modal-content">
<div class="modal-header">
    <h2 class="modal-title" id="personaModalTitle"></h2>
    <div class="modal-header-controls">
        <button class="copy-guide-btn" id="copyPersonaGuideBtn">
            Copy Guide
            <span class="copy-notification">Copied!</span>
        </button>
        <button class="copy-guide-btn" id="copyPersonaImageBtn">Copy Image</button>
        <button class="close-btn" id="closePersonaBtn">&times;</button>
    </div>
</div>
        <div class="modal-body persona-modal-body">
            <!-- Persona details-->
        </div>
    </div>
</div>

		
</div>
    </main>

    <div class="modal" id="confidantModal">
        <div class="modal-content">
<div class="modal-header">
    <h2 class="modal-title" id="confidantModalTitle"></h2>
    <div class="modal-header-controls">
        <button class="copy-guide-btn" id="copyConfidantGuideBtn">
            Copy Guide
            <span class="copy-notification">Copied!</span>
        </button>
        <button class="copy-guide-btn" id="copyConfidantImageBtn">Copy Image</button>
        <button class="close-btn" id="closeConfidantBtn">&times;</button>
    </div>
</div>
            <div class="modal-body">
                <div class="tabs" id="confidantTabsContainer">
                    <!-- Confidant tabs -->
                </div>
                <div class="tab-content-container" id="confidantTabContentContainer">
                    <!-- Confidant tab content-->
                </div>
            </div>
        </div>
    </div>

    <script>
	const confidantData = {
    "Merope": {
        "icon": "https://cdn.imgchest.com/files/49zc2bpgvny.png",
        "levels": [
            ["Rank 1", "Unlocks Confidant", "Unlocks Sports Activity: Basic Training"],
            ["Rank 2", "Unlocks Trait: Lone Wolf", "Increases membrosia from sports activities by 20%"],
            ["Rank 3", "Unlocks Sports Activity: Professional Training", "Unlocks new story"],
            ["Rank 4", "Unlocks Trait: Height of Summer", "Unlocks new story"],
            ["Rank 5", "Unlocks Sports Activity: Strengthening Training", "Increases stat gains from sports activities by 20%"],
            ["Rank 6", "Unlocks Trait: Raging Waves", "Unlocks new story"],
            ["Rank 7", "Unlocks Sports Activity: Hellish Training", "Unlocks new story"],
            ["Rank 8", "Unlocks Trait: Indomitable", "Reduces cost of sports activities by 20%"],
            ["Rank 9", "Unlocks Sports Activity: Godly Training", "Unlocks new story"],
            ["Rank 10", "Unlocks Trait: Endless Summer", "Allows you to obtain a Merope-exclusive momento."]
        ],
        "guide": {
            "notes": "Merope is one of the most important confidants in the game as she helps you unlock various Personas to fuse and good perks while fusing. It recommended to get her to atleast Rank 15 or all the way to Rank 20.",
            "skills": [
                ["1", "Road to Idol", "Gacha is unlocked"],
                ["5", "Special Service", "Unlocks Archangel as a fusion"],
                ["7", "Ideal Image", "Unlocks Setanta as a fusion"],
                ["9", "Vip Seats", "Unlocks Anubis as a fusion"],
                ["11", "Under Spotlight", "Unlock Okuninushi as a fusion"],
                ["13", "My Push is Justice", "Unlock Narcissus as a fusion"],
                ["15", "Fanchant Feedback", "When fusing a persona that is either 2 star or 3 star and rank 4 or below there is a chance to get an additional coin"],
                ["20", "Dance with Shadow", "Unlocks Kohryu as a fusion"]
            ],
            "requirements": [
                ["Request # 1", "Jack Frost with Lucky Punch"],
                ["Request # 2", "Neko-Shogun with Tarukaja"],
                ["Request # 3", "Lilim with Attack Strengthening I"],
                ["Request # 4", "Unicorn with Treatment Strengthening II"],
                ["Request # 5", "Byakyo with Bufudyne"],
                ["Request # 6", "Daisojou with Spirit Drain"],
                ["Request # 7", "Complete a Mementos side quest"],
                ["Request # 8", "Dominion with Matarukaja"]
            ],
            "hangouts": [
                ["Shimokitazawa", "What does it mean? (+50) <br>I understand (+60)"],
                ["Shibuya", "It’s too exaggerated (+50) <br>Turns out there is such an explanation (+60)"],
                ["Jimbocho", "I only read comics (+50) <br>My hobby is reading (+60)"],
                ["Odaiba Seaside Park", "Started to make my heart beat faster (+60) <br>It depends on who the target is (+50)"],
                ["Ikebukuro", "Do you want to hold hands? (+60) <br>It’s too early for us (+50)"]
            ],
            "rankUpChoices": [
                ["Rank 2 -> 3", "Further study or job search...? (+40) <br>I haven't thought about it (+50) <br>I'm happier (+60)"],
                ["Rank 4 -> 5", "Idol again? (+50) <br>I haven't thought about it… (+40) <br>Do you like idols? (+60)"],
                ["Rank 6 -> 7", "?(+40) <br>Definitely refuse (+50) <br>I hope you can explain... (+60)"],
                ["Rank 8 -> 9", "Calm down first (+50) <br>She is troubled (+60) <br>My guest, the time is up, (+40)"],
                ["Rank 10 -> 11", "So profound (+40) <br>Does this really make sense (+50) <br>Is it just that Merope wants to order? (+60)"],
                ["Rank 12 -> 13", "It’s quite difficult (+50) <br>Go for it (+40) <br>I’m looking forward to your skills (+60)"],
                ["Rank 14 -> 15", "It’s quite difficult (+50) <br>Go for it (+40) <br>I’m looking forward to your skills (+60)"],
                ["Rank 16 -> 17", "So there is such a secret (+50) <br>It’s not easy… (+40) <br>You work hard (+60)"],
                ["Rank 19 -> 20", "I have to finish it well (+50) <br>I can’t help it (+40) <br>Of course! (+60)"]
            ],
            "gifts": [
                ["AMN005 debut album", "76", "38", "38", "¥18,600"],
                ["Coaster", "8", "4", "4", "¥1,500"],
                ["Glow stick", "12", "6", "6", "¥2,400"],
                ["Idol Keychain", "10", "5", "5", "¥2,000"],
                ["Maid Model", "68", "34", "34", "¥15,800"],
                ["Cat Hair Clip", "20", "10", "10", "¥4000"],
                ["Premium Sunglasses", "74", "37", "37", "¥18,000"],
                ["Digital Camera", "128", "64", "64", "¥39,000"],
                ["Weight-Bearing Wristband", "34", "17", "17", "¥6,800"],
                ["Veritas", "32", "16", "16", "1 Gorgeous packaging, 1 Violet, 4 Lilies"],
                ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
                ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
                ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
                ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
                ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
                ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
            ]
        }
    },
    "Arai Motoha": {
        "icon": "https://cdn.imgchest.com/files/yq9c3ep5eg4.png",
        "levels": [
            ["Rank 1", "Unlocks Confidant", "Unlocks Part-time Job: Convenience Store"],
            ["Rank 2", "Unlocks Trait: Earnest", "Increases money gained from part-time jobs by 10%"],
            ["Rank 3", "Unlocks Part-time Job: Flower Shop", "Unlocks new story"],
            ["Rank 4", "Unlocks Trait: Hidden Strength", "Unlocks new story"],
            ["Rank 5", "Unlocks Part-time Job: Bartender", "Increases money gained from part-time jobs by 20%"],
            ["Rank 6", "Unlocks Trait: Cheerful", "Unlocks new story"],
            ["Rank 7", "Unlocks Part-time Job: Field Work", "Unlocks new story"],
            ["Rank 8", "Unlocks Trait: Hardworking", "Reduces vitality cost of part-time jobs by 20%"],
            ["Rank 9", "Unlocks Part-time Job: Pet Shop", "Unlocks new story"],
            ["Rank 10", "Unlocks Trait: Radiant", "Allows you to obtain an Arai-exclusive momento"]
        ],
        "guide": {
            "notes": "Arai confidant isn't too important but it's recommened to leave her at Rank 15 to gain the metaverse perks she has to offer.",
            "skills": [
                ["1", "I Saw It", "During baseball practice challenge, you can use the third eye."],
                ["5", "Let's Work Hard Together", "When the battle ends with an all out attack, the entire team's HP will be fully restored (only effective for wandering shadows in the hall of Palace and Mementos)"],
                ["9", "Exercise More", "You can challenge new difficulties in the baseball practice stage and increase the types of goods that can be redeemed at the exchange shop."],
                ["13", "Ready To Go", "After resting in a safe room, when the highlight energy isn't at 30%, you can recover 30% (only effective for wandering shadows in the hall of Palaces and Mementos)"],
                ["17", "Bring it On", "You can challenge higher levels of difficulty in the baseball practice stage; furthering increasing the types of products that can be exchanged at the exchange shop."]
            ],
            "socialStats": [
                ["Rank 2 -> 3", "Proficiency Rank 3"],
                ["Rank 4 -> 5", "Proficiency Rank 5"],
                ["Rank 6 -> 7", "Proficiency Rank 6"],
                ["Rank 8 -> 9", "Proficiency Rank 8"],
                ["Rank 10 -> 11", "Proficiency Rank 10"],
                ["Rank 12 -> 13", "Proficiency Rank 11"],
                ["Rank 14 -> 15", "Proficiency Rank 13"],
                ["Rank 16 -> 17", "Proficiency Rank 15"],
                ["Rank 19 -> 20", "Proficiency Rank 17"]
            ],
            "hangouts": [
                ["Inokashira Park", "Cocoa Flavor +60<br>Mixed Fruit Flavor +50<br>Pudding Flavor +40"],
                ["Shimokitazawa", "Squats+60<br>Abs +50<br>Sit Ups +40"],
                ["Tsukishima", "It's okay because it's a topping +50<br>Should I order cheese? +60"],
                ["Shibuya", "Let's try +50<br>Want to play? +60"]
            ],
            "rankUpChoices": [
                ["Rank 2 -> 3", "That won't happen +50<br>Okay +60<br>No need to push yourself +40"],
                ["Rank 4 -> 5", "I'm relying on +60<br>Okay +40<br>Let's lift 100kg together +50"],
                ["Rank 6 -> 7", "I see +50<br>Aren't you eating too much? +40<br>Let's cheer up together +60"],
                ["Rank 8 -> 9", "You can win +60<br>If you train+50<br>4th, pitcher… +40"],
                ["Rank 10 -> 11", "Yeah +40<br>Well +50<br>…… +60"],
                ["Rank 12 -> 13", "No Options"],
                ["Rank 14 -> 15", "Don't you like baseball? +40<br>Want to continue playing baseball? +60<br>Is the Phantom Thieves important? +50<br><br>For the sake of my colleagues (best friend route)<br>Because Motoha is precious (Soulmate route)"],
                ["Rank 16 -> 17", "Good job +50<br>It was cool +60<br>No regrets? +40"],
                ["Rank 19 -> 20", "No Options"],
                ["Rank 19 -> 20(Lovers)", "Not scary +40<br>I think Motoha would be scared +50<br><br>[Additional choices]<br>It's okay because I'm here +40<br>Grab my arm +50"]
            ],
            "gifts": [
                ["GOAT Baseball Bat", "52", "26", "26", "¥11,000"],
                ["GOAT Absorbent Towel", "16", "8", "8", "¥3,000"],
                ["GOAT Baseball Gloves", "34", "17", "17", "¥6,900"],
                ["GOAT Baseball Uniform", "44", "22", "22", "¥8,900"],
                ["A Guide to Eating While Walking", "4", "2", "2", "¥700"],
                ["Sumo Theme Sticker Set", "8", "4", "4", "¥1,600"],
                ["Heart Shaped Ring", "250", "125", "125", "¥88,000"],
                ["Cat Hair Pin", "20", "10", "10", "¥4,000"],
                ["Sports Protective Gear", "14", "7", "7", "¥2,800"],
                ["Lily Everlasting Flower", "26", "13", "13", "1 Gorgeous packaging, 4 Lilies"],
                ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
                ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
                ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
                ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
                ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
                ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
            ]
        }
    },
    "Ayaka Sakai": {
        "icon": "https://cdn.imgchest.com/files/4jdcvjrwjm4.png",
        "levels": [
            ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Concert"],
            ["Rank 2", "Unlocks Trait: Melodious", "Unlocks new story"],
            ["Rank 3", "Unlocks Leisure Activity: Karaoke", "Unlocks new story"],
            ["Rank 4", "Unlocks Trait: Rhythmic", "Unlocks new story"],
            ["Rank 5", "Unlocks Leisure Activity: Music Store", "Unlocks new story"],
            ["Rank 6", "Unlocks Trait: Passionate", "Unlocks new story"],
            ["Rank 7", "Unlocks Leisure Activity: Live House", "Unlocks new story"],
            ["Rank 8", "Unlocks Trait: Harmonious", "Reduces vitality cost of leisure activities by 20%"],
            ["Rank 9", "Unlocks Leisure Activity: Jazz Club", "Unlocks new story"],
            ["Rank 10", "Unlocks Trait: Virtuoso", "Allows you to obtain a Sakai-exclusive momento"]
        ],
        "guide": {
            "notes": "Ayaka is crazzy good for the rhythm game mode as she can you land perfect notes much easier. It's recommened to rank her all the way to Rank 15 to max her music perks.",
            "skills": [
                ["1", "Solo Turning Point", "When playing the rhythm game,it is easier to obtain Perfect and Great."],
                ["5", "Savior Hurry", "When playing, a single key Miss will be automatically corrected to Perfect every 10 seconds."],
                ["7", "Solo Rock", "Unlock the song: Seize the Light"],
                ["13", "Twelve Tone Sunset", "When playing,the end of the long key will be automatically be played even if the hand is not released."],
                ["17", "Greet Dawn Star with You", "Unlock the song: Wonder Light"]
            ],
            "socialStats": [
                ["Rank 2 -> 3", "Proficiency Rank 3"],
                ["Rank 4 -> 5", "Proficiency Rank 5"],
                ["Rank 6 -> 7", "Proficiency Rank 6"],
                ["Rank 8 -> 9", "Proficiency Rank 8"],
                ["Rank 10 -> 11", "Proficiency Rank 10"],
                ["Rank 12 -> 13", "Proficiency Rank 11"],
                ["Rank 14 -> 15", "Proficiency Rank 13"],
                ["Rank 16 -> 17", "Proficiency Rank 15"],
                ["Rank 19 -> 20", "Proficiency Rank 17"]
            ],
            "hangouts": [
                ["Inokashira Park", "I need a change of pace +60<br>Isn't it better to be alone…? +50"],
                ["Miura Coast", "I'm glad you asked me to come +60<br>I think I'm a little hungry +50"],
                ["Suidobashi", "Let's go ride the Ferris wheel +60<br>Let's challenge the roller coaster +50"],
                ["Yongenjaya", "Old Masterpiece Movies +60<br>Latest movies… +50"],
                ["Odaiba Seaside Park", "It's a great place +60<br>I think it's a good place… ? +50"]
            ],
            "rankUpChoices": [
                ["Rank 2 -> 3", "Cherish yourself first +60<br>It's okay even after tomorrow +50"],
                ["Rank 4 -> 5", "Don't be impatient +50<br>I'll always be with you +60"],
                ["Rank 6 -> 7", "That was a great song +40<br>Are you nervous? +50"],
                ["Rank 8 -> 9", "It was a good song +60<br>Well sung +50"],
                ["Rank 10 -> 11", "Find what you want to say +50<br>Try to estimate +40<br>Anyone you want to pass along? +60"],
                ["Rank 12 -> 13", "I did nothing wrong +40<br>Do you have anything to say now? +60<br>What do you want to do now? +50"],
                ["Rank 14 -> 15", "Because I wanted to hear the performance… +50<br>Could it be my mood? +40<br>I hope you feel better +60<br><br>I am rooting for you as a fan.Friends<br>I share the same feelings as Ayaka.Lovers"],
                ["Rank 16 -> 17", "Congratulations +50<br>I want to hear it quickly +60"],
                ["Rank 19 -> 20", "Come back +60<br>It must have been passed on to her too +50"],
                ["Rank 19 -> 20(Lovers)", "You can stay until tomorrow +60<br>Let's do a session together +50"]
            ],
            "gifts": [
                ["AMN005 first album", "76", "38", "38", "¥18600"],
                ["Milk Flavor Bar Pack", "24", "12", "12", "¥4890"],
                ["High-performance electric toothbrush", "105", "52", "52", "¥29800"],
                ["Heart hand mirror", "6", "3", "3", "¥1200"],
                ["All scale harmonica", "84", "42", "42", "¥21800"],
                ["Carousel Music Box", "24", "12", "12", "¥4800"],
                ["Other Management Set", "30", "15", "15", "¥6000"],
                ["Strange Clear Day Doll", "4", "2", "2", "¥800"],
                ["Choker Necklace", "74", "37", "37", "¥18000"],
                ["Golden Mokseo Tea", "26", "13", "13", "1 Gorgeous Packaging, 4 Osmanthus."],
                ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
                ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
                ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
                ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
                ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
                ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
            ]
        }
    },
    "Kanou Shun": {
        "icon": "https://cdn.imgchest.com/files/7lxcpdwgdw7.png",
        "levels": [
            ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Skateboard Park"],
            ["Rank 2", "Unlocks Trait: Sporty", "Unlocks new story"],
            ["Rank 3", "Unlocks Leisure Activity: Bouldering", "Unlocks new story"],
            ["Rank 4", "Unlocks Trait: Thrillseeker", "Unlocks new story"],
            ["Rank 5", "Unlocks Leisure Activity: Skydiving", "Doubles guts gained from leisure activities"],
            ["Rank 6", "Unlocks Trait: Energetic", "Unlocks new story"],
            ["Rank 7", "Unlocks Leisure Activity: Bungee Jumping", "Unlocks new story"],
            ["Rank 8", "Unlocks Trait: Bold", "Reduces vitality cost of leisure activities by 20%"],
            ["Rank 9", "Unlocks Leisure Activity: Paragliding", "Unlocks new story"],
            ["Rank 10", "Unlocks Trait: Unflinching", "Allows you to obtain a Kanou-exclusive momento"]
        ],
        "guide": {
            "notes": "Kanou Confidant offers various perks for those looking to cook food. It's recommended to get him at Rank 15 to max out his cooking perks.",
            "skills": [
                ["1", "Exclusive Cooking Recipes", "Unlock new types of dishes that can be made"],
                ["5", "Food Handling Tips", "When making food, there is a chance that some of that the materials to make the food will be returned."],
                ["9", "Practiced Cooking", "Increased the chance of making perfect food"],
                ["12", "Cooking Experience", "When making a dish there is a certain chance that you will get an extra one."],
                ["15", "Precious Recipe", "Further increase the types of dishes that can be made"]
            ],
            "socialStats": [
                ["Rank 2 -> 3", "Guts Rank 3"],
                ["Rank 4 -> 5", "Guts Rank 5"],
                ["Rank 6 -> 7", "Guts Rank 6"],
                ["Rank 8 -> 9", "Guts Rank 8"],
                ["Rank 10 -> 11", "Guts Rank 10"],
                ["Rank 12 -> 13", "Guts Rank 11"],
                ["Rank 14 -> 15", "Guts Rank 13"],
                ["Rank 16 -> 17", "Guts Rank 15"],
                ["Rank 19 -> 20", "Guts Rank 17"]
            ],
            "hangouts": [
                ["Shibuya", "Expected +60<br>I think it tastes like it's worth the price +50"],
                ["Shimokitazawa", "Buy at the store +60<br><br>Every day is different +50<br>I don't eat +40"],
                ["Harajuku", "I see a smile +60<br>View animation goods +50"],
                ["Asakusa", "Old store's Jeonbyeong +60<br>Photogenic Fruit Tea +50"],
                ["Ueno", "Worth a try +60<br>Shun, food is art +50"]
            ],
            "rankUpChoices": [
                ["Rank 2 -> 3", "Great analysis +50<br>I'm slowly eating ramen... +60<br>Are you going to add monjayaki? +40"],
                ["Rank 4 -> 5", "It starts now +50<br>Grew up +60<br>Did you lose? +40"],
                ["Rank 6 -> 7", "What? +40<br>It's so sudden... +60<br>Maybe you know +50"],
                ["Rank 8 -> 9", "What does Shun want to do? +60<br>Look at me… +50<br>The case fee is also important +40"],
                ["Rank 10 -> 11", "It must look good +40<br>You need to decide on your customer base +50<br>The theme of the competition is important +60"],
                ["Rank 12 -> 13", "Yeah +40<br>Are you the thin-eared type? +50<br>It's getting fun +60"],
                ["Rank 14 -> 15", "Fried rice is good +60<br>To the same thing as you unconditionally+40<br>For ordering something other than Shun's ramen+50"],
                ["Rank 16 -> 17", "You did that +50<br>I should thank the boss +60<br>I want to eat... +40"],
                ["Rank 19 -> 20", "I'll be with you +60<br>Sometimes, other than ramen, +50<br> If you buy it +40"],
                ["Rank 19 -> 20(Friends)", "I'll expect +60<br>Why are you suddenly making dessert? +50"]
            ],
            "gifts": [
                ["Silver Bracelet", "224", "112", "112", "¥ 78,000"],
                ["Special Nut Combination", "14", "7", "7", "¥ 2,800"],
                ["Sweeping Robot", "100", "50", "50", "¥ 28,000"],
                ["Handmade Flower Basket", "16", "8", "8", "¥ 3,200"],
                ["Healthy Drink Set", "8", "4", "4", "¥ 1,680"],
                ["Limited Edition Fountain Pen", "48", "24", "24", "¥ 10,000"],
                ["Traditional Dim Sum Combination", "20", "10", "10", "¥ 3,800"],
                ["Cartoon Apron", "8", "4", "4", "¥ 1,600"],
                ["Instant Noodles Combo Pack", "18", "9", "9", "¥ 3,480"],
                ["Kitchen Knives Set", "24", "12", "12", "¥ 4,900"],
                ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
                ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
                ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
                ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
                ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
                ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
            ]
        }
    },
    "Kayo Tomiyama": {
        "icon": "https://cdn.imgchest.com/files/y2pckox9o37.png",
        "levels": [
            ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Fishing"],
            ["Rank 2", "Unlocks Trait: Diligent", "Unlocks new story"],
            ["Rank 3", "Unlocks Leisure Activity: Cooking", "Unlocks new story"],
            ["Rank 4", "Unlocks Trait: Loving", "Unlocks new story"],
            ["Rank 5", "Unlocks Leisure Activity: Home Gardening", "Doubles Courage gained from leisure activities"],
            ["Rank 6", "Unlocks Trait: Caring", "Unlocks new story"],
            ["Rank 7", "Unlocks Leisure Activity: Idol Performance", "Unlocks new story"],
            ["Rank 8", "Unlocks Trait: Considerate", "Reduces vitality cost of leisure activities by 20%"],
            ["Rank 9", "Unlocks Leisure Activity: Shared Meal", "Unlocks new story"],
            ["Rank 10", "Unlocks Trait: Gentle", "Allows you to obtain a Tomiyama-exclusive momento"]
        ],
        "guide": {
            "notes": "Kayo is a decent confidant that provides with new outfits and access to more from the underground mall. Overall she should put be in last priority and invested until Rank 13",
            "skills": [
                ["1", "Fashion Designer", "Obtain:Casual Formal Wear"],
                ["3", "New Trend", "Obtain:Green Casual formal Wear"],
                ["9", "Diversity in Fashion", "You can buy new clothes at Shibuya Underground"],
                ["13", "Carefully Sewn", "You can now buy new clothes at \"Shibuya Underground Mall, High-end Clothing Store\""],
                ["20", "Special Taste", "Obtain: Casual School Wear"]
            ],
            "socialStats": [
                ["Rank 2 -> 3", "Charm Rank 3"],
                ["Rank 4 -> 5", "Charm Rank 5"],
                ["Rank 6 -> 7", "Charm Rank 6"],
                ["Rank 8 -> 9", "Charm Rank 8"],
                ["Rank 10 -> 11", "Charm Rank 10"],
                ["Rank 12 -> 13", "Charm Rank 11"],
                ["Rank 14 -> 15", "Charm Rank 13"],
                ["Rank 16 -> 17", "Charm Rank 15"],
                ["Rank 19 -> 20", "Charm Rank 17"]
            ],
            "hangouts": [
                ["Ikebukuro", "I'll think of it as dating practice +50<br>Isn't your husband jealous? +60"],
                ["Shibuya", "I've heard of it +60<br>Where is the yellow? +50"],
                ["Shimokitazawa", "What does it smell like? +60<br>Sweat smell? +50"],
                ["Harajuku", "Old shops in Harajuku? +60<br>What era is it? +50"],
                ["Odaiba Seaside Park", "It feels a bit young +50<br>Feeling like a big sister? +60"]
            ],
            "rankUpChoices": [
                ["Rank 2 -> 3", "We live in the same reality +50<br>If you give up, it's over +60<br>How old are you? +40"],
                ["Rank 4 -> 5", "Teenager's Mind +50<br>Cashless +40<br>Inconvenient but enjoyable memories +60"],
                ["Rank 6 -> 7", "It's a little disappointing +50<br>There's no need to fight... +40<br>I'm also looking at +60"],
                ["Rank 8 -> 9", "There are a lot of side dishes +50<br>It's high in calories +40<br>Food to pray for success? +60"],
                ["Rank 10 -> 11", "Prepare your favorite food +50<br>No need to be special +60<br>Curry…? +40"],
                ["Rank 12 -> 13", "That's today's teenagers +40<br>No, it's not +60<br>Where is the broad-minded lady? +50"],
                ["Rank 14 -> 15", "What the hell is going on? +40<br>Calm down +50<br>Are you talking about Leo? +60"],
                ["Rank 16 -> 17", "No Options"],
                ["Rank 19 -> 20", "But you worked hard +60<br>Is today a reflection meeting? +50<br>The result wasn't bad +40"],
                ["Rank 19 -> 20(Friends)", "Are you mother-in-law? +50<br>Sorry, Mother-in-law +60"]
            ],
            "gifts": [
                ["Simple Cosmetic Bag", "28", "14", "14", "¥ 5,500"],
                ["Gossip News Weekly", "2", "1", "1", "¥ 500"],
                ["Fashion Magazine", "2", "1", "1", "¥ 500"],
                ["Designer Perfume", "224", "112", "112", "¥ 78,000"],
                ["Deep Red Lipstick", "30", "15", "15", "¥ 6,000"],
                ["The Latest Beauty Device", "24", "12", "12", "¥ 9,800"],
                ["Rose Bath Giftbox", "16", "8", "8", "¥ 3,200"],
                ["Dress Up Doll", "70", "35", "35", "¥ 16,000"],
                ["Premium Fragrance Combination", "20", "10", "10", "¥ 3,800"],
                ["Universal Vitamin Tablets", "22", "11", "11", "¥ 4,500"],
                ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
                ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
                ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
                ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
                ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
                ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
            ]
        }
    },
    "Kira Kitazato": {
        "icon": "https://cdn.imgchest.com/files/7kzcaboebe7.png",
        "levels": [
            ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Bar"],
            ["Rank 2", "Unlocks Trait: Mature", "Unlocks new story"],
            ["Rank 3", "Unlocks Leisure Activity: Jazz Club", "Unlocks new story"],
            ["Rank 4", "Unlocks Trait: Alluring", "Unlocks new story"],
            ["Rank 5", "Unlocks Leisure Activity: Billiards", "Unlocks new story"],
            ["Rank 6", "Unlocks Trait: Mysterious", "Unlocks new story"],
            ["Rank 7", "Unlocks Leisure Activity: Darts", "Unlocks new story"],
            ["Rank 8", "Unlocks Trait: Confident", "Reduces vitality cost of leisure activities by 20%"],
            ["Rank 9", "Unlocks Leisure Activity: Casino", "Unlocks new story"],
            ["Rank 10", "Unlocks Trait: Irresistible", "Allows you to obtain a Kitazato-exclusive momento"]
        ],
        "guide": {
            "notes": "Kira is a good confidant for the metaverse when it comes to Guns. Maxing him out is recommended.",
            "skills": [
                ["1", "Quick Reload", "When Thieves attack with guns, increase Gun DMG by 10%"],
                ["5", "Fully Loaded", "When Thieves ran out of ammo, refill 100% ammo after 2 turns"],
                ["7", "Pull the Trigger", "When Thieves attack with guns, increase Gun DMG by 10%"],
                ["13", "Ignite Gunpowder", "When Thieves attack with guns, increase Gun DMG by 10%"],
                ["17", "Full Auto", "When Thieves ran out of ammo, refill 100% ammo after 1 turn"]
            ],
            "socialStats": [
                ["Rank 2 -> 3", "Knowledge 3"],
                ["Rank 4 -> 5", "Knowledge 5"],
                ["Rank 6 -> 7", "Knowledge 6"],
                ["Rank 8 -> 9", "Knowledge 8"],
                ["Rank 10 -> 11", "Knowledge 10"],
                ["Rank 12 -> 13", "Knowledge 11"],
                ["Rank 14 -> 15", "Knowledge 13"],
                ["Rank 16 -> 17", "Knowledge 15"],
                ["Rank 19 -> 20", "Knowledge 17"]
            ],
            "hangouts": [
                ["Kanda", "It is also possible+50<br>The doctor's ability is more important +60"],
                ["Shinjuku", "What kind of book are you looking forward to? 50<br>Actually, it contains+60"],
                ["Kichioji", "Want to be a popular person +40<br>What about Kira? +60"],
                ["Shibuya", "See the price +40<br>No rules +60"],
                ["Zoshigaya", "It's just very ordinary +40<br>There are also some surprises +60"]
            ],
            "rankUpChoices": [
                ["Rank 2 -> 3", "It makes sense +60<br>Forced explanation +40<br>Don't care what others think? +50"],
                ["Rank 4 -> 5", "The progress is too fast +50<br>What is the purpose of the experiment? +60<br>What if I refuse? +40"],
                ["Rank 6 -> 7", "She is a good sister +60<br>Do you hate her? +40<br>Can you introduce her to me? +50"],
                ["Rank 8 -> 9", "Leave it to me +60<br>Is it better the other way around +50<br>No need for any battle strategy +40"],
                ["Rank 10 -> 11", "This is the patient's freedom +50<br>I understand +60<br>Can I have more dishes? +40"],
                ["Rank 12 -> 13", "Are you going to give up now? +50<br>You are not motivated enough +40<br>Say what you want to say +60"],
                ["Rank 14 -> 15", "I think you think too much +40<br>Try to trust him +50<br>Even if it is a trap, you can use it +60"],
                ["Rank 16 -> 17", "Do you want to run away? +50<br>Calm down first +60<br>It's too late to say this now +40"],
                ["Rank 19 -> 20", "There is really no way +40<br>Do I have the right to refuse? +50<br>The \"deal\" is still in effect +60"]
            ],
            "gifts": [
                ["GOAT Absorbent Towel", "16", "8", "8", "¥3,000"],
                ["Lazy Cushion", "32", "16", "16", "¥ 6,500"],
                ["Shooting Game Advanced Guide Collection", "22", "11", "11", "¥ 4,500"],
                ["Household Thermos Cup", "16", "8", "8", "¥ 3,000"],
                ["Soldier Set", "80", "40", "40", "¥ 20,000"],
                ["Eye Protection Eyedrops", "40", "20", "20", "¥ 8,000"],
                ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
                ["Pancake Glasses", "104", "52", "52", "¥ 30,000"],
                ["Premium Sunglasses", "74", "37", "37", "¥ 18,000"],
                ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
                ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
                ["Super Noisy Alarm Clock", "54", "18", "18", "¥ 7,000"],
                ["48 Sided Cube", "30", "15", "15", "¥ 5,800"],
                ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
                ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
                ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
            ]
        }
    },
    "Kiyoshi Kurotani": {
        "icon": "https://cdn.imgchest.com/files/7ogcbkq8kpy.png",
        "levels": [
            ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Darts"],
            ["Rank 2", "Unlocks Trait: Sharp", "Unlocks new story"],
            ["Rank 3", "Unlocks Leisure Activity: Jazz Club", "Unlocks new story"],
            ["Rank 4", "Unlocks Trait: Classy", "Unlocks new story"],
            ["Rank 5", "Unlocks Leisure Activity: Aquarium", "Unlocks new story"],
            ["Rank 6", "Unlocks Trait: Perceptive", "Unlocks new story"],
            ["Rank 7", "Unlocks Leisure Activity: Bar", "Unlocks new story"],
            ["Rank 8", "Unlocks Trait: Sophisticated", "Reduces vitality cost of leisure activities by 20%"],
            ["Rank 9", "Unlocks Leisure Activity: Museum", "Unlocks new story"],
            ["Rank 10", "Unlocks Trait: Refined", "Allows you to obtain a Kurotani-exclusive momento"]
        ],
        "guide": {
            "notes": "Kiyoshi is the 3rd best city confidant as he gives you books that allow you to gain a stat or give you benfits for activities. Its recommened to level his rank to Rank 15",
            "skills": [
                ["1", "Rest Is Also A Battle", "Obtain the book Efficient Relaxation Method"],
                ["3", "Healing Angel", "Get the book: All About First Aid"],
                ["11", "Breaking Through Limitations", "Get the book: Muscle, GO!"],
                ["15", "Already Know", "Get the book: Secret Techniques of Librarians!"],
                ["20", "See Through All", "Get the book: Film and Film Critics"]
            ],
            "socialStats": [
                ["Rank 2 -> 3", "Guts Rank 3"],
                ["Rank 4 -> 5", "Guts Rank 5"],
                ["Rank 6 -> 7", "Guts Rank 6"],
                ["Rank 8 -> 9", "Guts Rank 8"],
                ["Rank 10 -> 11", "Guts Rank 10"],
                ["Rank 12 -> 13", "Guts Rank 11"],
                ["Rank 14 -> 15", "Guts Rank 13"],
                ["Rank 16 -> 17", "Guts Rank 15"],
                ["Rank 19 -> 20", "Guts Rank 17"]
            ],
            "hangouts": [
                ["Shibuya", "I know how you feel +60<br>I am different from you +50"],
                ["Asakusa", "Okay +60<br>Wanna hold my hand? +50"],
                ["Suidobashi", "It's a scary place +60<br>Not that dangerous +50"],
                ["Ogikubo", "Good idea +60<br>I'm hungry... +50"]
            ],
            "rankUpChoices": [
                ["Rank 2 -> 3", "Won't you let me go? +40<br>How long are you going to do this? +50<br>Surprisingly strong… +60"],
                ["Rank 4 -> 5", "I can't leave Kurotani behind +60<br>Then, without specifications +50<br>What was the promise? +40"],
                ["Rank 6 -> 7", "Can you send it to me? +60<br>What are you going to do now? +50"],
                ["Rank 8 -> 9", "I'll leave your back to you +60<br>What does Kurotani want to do? +40<br>I'm ready +50"],
                ["Rank 10 -> 11", "I understand the situation +40<br>I feel sorry for that girl. +60<br>This time there is a lot of information +50"],
                ["Rank 12 -> 13", "I never thought you'd say that +40<br>I'm also thinking about many things +50<br>Did you get stabbed in the sore spot? +60"],
                ["Rank 14 -> 15", "It was pretty coercive for me +50<br>So are you soulmates? +60<br>I understood a lot +40"],
                ["Rank 16 -> 17", "I'll help you +50<br>I can't help it +40<br>Because we are soulmates+60"],
                ["Rank 19 -> 20", "What did you learn? +40<br>What is a friend? +60<br>I should thank Takehan too +50"],
                ["Rank 19 -> 20(Friends)", "For watching cartoons or playing games+50<br>Mostly just sleep +60"]
            ],
            "gifts": [
                ["Supernatural Video", "110", "55", "55", "¥ 32,000"],
                ["Incredible Glasses", "18", "9", "9", "¥ 3,560"],
                ["Silver Bracelet", "224", "112", "112", "¥ 78,000"],
                ["48 Sided Cube", "30", "15", "15", "¥ 5,800"],
                ["Handmade Bookcover Set", "16", "8", "8", "¥ 3,000"],
                ["Black Lacquer Mug", "10", "5", "5", "¥ 1,800"],
                ["Cowhide Pencil Case", "14", "7", "7", "¥ 2,800"],
                ["Men's Sun Hat", "8", "4", "4", "¥ 1,600"],
                ["Popular Monthly Comic", "2", "1", "1", "¥ 480"],
                ["Adult Smart Ring", "24", "12", "12", "¥ 4,700"],
                ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
                ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
                ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
                ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
                ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
                ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
            ]
        }
    },
    "Kotone Montagne": {
        "icon": "https://cdn.imgchest.com/files/7pjcqw8xwa7.png",
        "levels": [
            ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Ice Skating"],
            ["Rank 2", "Unlocks Trait: Graceful", "Unlocks new story"],
            ["Rank 3", "Unlocks Leisure Activity: Ballet", "Unlocks new story"],
            ["Rank 4", "Unlocks Trait: Poised", "Unlocks new story"],
            ["Rank 5", "Unlocks Leisure Activity: Dance Studio", "Unlocks new story"],
            ["Rank 6", "Unlocks Trait: Artistic", "Unlocks new story"],
            ["Rank 7", "Unlocks Leisure Activity: Theater", "Unlocks new story"],
            ["Rank 8", "Unlocks Trait: Expressive", "Reduces vitality cost of leisure activities by 20%"],
            ["Rank 9", "Unlocks Leisure Activity: Fashion Show", "Unlocks new story"],
            ["Rank 10", "Unlocks Trait: Prima", "Allows you to obtain a Montagne-exclusive momento"]
        ],
        "guide": {
            "notes": "Kotone's confidant is great for reducing the amount of time that commissions takes. And increase the quality of commissions that you can receive.",
            "skills": [
                ["1", "Eisenhower Matrix", "Decreases the time needed to complete Commissions by 5%"],
                ["5", "Pareto Principle", "Increases the max refreshes on Standard Commissions by 1"],
                ["7", "Pomodoro Technique", "Decreases the time needed to complete Commissions by 10%"],
                ["13", "Spotlight Principle", "Increases the chance to get above blue quality Commissions"],
                ["17", "Timeboxing Theory", "You can instant complete 3 Commissions per week"]
            ],
            "socialStats": [
                ["Rank 2 -> 3", "Proficiency Rank 3"],
                ["Rank 4 -> 5", "Proficiency Rank 5"],
                ["Rank 6 -> 7", "Proficiency Rank 6"],
                ["Rank 8 -> 9", "Proficiency Rank 8"],
                ["Rank 10 -> 11", "Proficiency Rank 10"],
                ["Rank 12 -> 13", "Proficiency Rank 11"],
                ["Rank 14 -> 15", "Proficiency Rank 13"],
                ["Rank 16 -> 17", "Proficiency Rank 15"],
                ["Rank 19 -> 20", "Proficiency Rank 17"]
            ],
            "hangouts": [
                ["Shibuya", "There is a very useful muscle tape +60<br>Do you need trauma medicine? +50"],
                ["Yongenjaya", "Which movie do you want to watch? +60<br>Why do you suddenly want to watch a movie? +50"],
                ["Kichijoji", "I will accompany you to listen here +60<br>It may be better to listen to music alone +50"],
                ["Shimokitazawa", "Let me be your guide +60<br>It's ok for you to go alone.+50"],
                ["Shinjuku", "Because it is dangerous +60<br>Because it is not beautiful +50"]
            ],
            "rankUpChoices": [
                ["Rank 2 -> 3", "The movements are very graceful +50<br>The joy in my heart is not shown +60<br>I need to watch it again +40"],
                ["Rank 4 -> 5", "I love you +50<br>I don't want to lie +60<br>So embarrassed +40"],
                ["Rank 6 -> 7", "Because the jump attracted my attention +40<br>Because it looked beautiful +50<br>Because I wanted to applaud +60"],
                ["Rank 8 -> 9", "I will help you no matter how many times +50<br>You don't have to face your troubles alone +40<br>I will always protect Kotone-chan+60"],
                ["Rank 10 -> 11", "Let's think about it together +60<br>Don't rush to figure it out +50<br>This situation is very common +40"],
                ["Rank 12 -> 13", "I am always willing to listen to you +40<br>You don't need to worry +50<br>It's good enough that you realize it +60"],
                ["Rank 14 -> 15", "I understand what you mean +60<br>I think you are very attractive +50<br><br>Hope you'd say \"I will win\" (Close Friends)<br>Hope you'd say \"I like you\" (Soulmates)"],
                ["Rank 16 -> 17", "Thanks for the hard work +40<br>Are you okay? +50<br>Great skating +60"],
                ["Rank 19 -> 20", "Was thinking about Kotone-san when cooking +40<br>Cooking needs love +40"],
                ["Rank 19 -> 20(Lovers)", "Do whatever you want +60<br>Would be bad if there's gossip +50"]
            ],
            "gifts": [
                ["Snowflak themed Ornaments", "16", "8", "8", "¥2,850"],
                ["Classic Music Collection", "28", "14", "14", "¥5,130"],
                ["Premium Yoga Mat", "36", "18", "18", "¥6,650"],
                ["Sport Headphones", "76", "38", "38", "¥18,800"],
                ["High End Sports Watch", "122", "61", "61", "¥36,800"],
                ["Scenery poetry", "32", "16", "16", "1 Cosmos Flower,1 Gorgeous Packaging,2 Osmanthus Fragrants"],
                ["Elegant Wooden Comb", "72", "36", "36", "¥16150"],
                ["Japanese Style Book Jacket", "16", "8", "8", "¥2850"],
                ["Maid Model", "68", "34", "34", "¥15,800"],
                ["Sports Protective Gear", "14", "7", "7", "¥2,800"],
                ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
                ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
                ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
                ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
                ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
                ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
            ]
        }
    },
    "Masaki Ashiya": {
        "icon": "https://cdn.imgchest.com/files/7bwckdvgda7.png",
        "levels": [
            ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Gym"],
            ["Rank 2", "Unlocks Trait: Athletic", "Unlocks new story"],
            ["Rank 3", "Unlocks Leisure Activity: Running", "Unlocks new story"],
            ["Rank 4", "Unlocks Trait: Competitive", "Unlocks new story"],
            ["Rank 5", "Unlocks Leisure Activity: Swimming", "Unlocks new story"],
            ["Rank 6", "Unlocks Trait: Determined", "Unlocks new story"],
            ["Rank 7", "Unlocks Leisure Activity: Bouldering", "Unlocks new story"],
            ["Rank 8", "Unlocks Trait: Resilient", "Reduces vitality cost of leisure activities by 20%"],
            ["Rank 9", "Unlocks Leisure Activity: Martial Arts", "Unlocks new story"],
            ["Rank 10", "Unlocks Trait: Unbeatable", "Allows you to obtain an Ashiya-exclusive momento"]
        ],
        "guide": {
            "notes": "Masaki is a confidant whose perks are focused on Tycoon.",
            "skills": [
                ["1", "Prisoner's Dilemma", "Unlocks the Tips Feature in Tycoon"],
                ["5", "Coordination Problem", "Unlocks Masaki Ashiya in Tycoon"],
                ["7", "Truel", "Unlocks the Masaki Ashiya Six of Diamonds Skin in Tycoon"],
                ["13", "Segal's Law", "Unlocks the Card Counting Feature in Tycoon"],
                ["17", "Eye for an Eye", "Unlocks More Items in the Tycoon Shop"]
            ],
            "socialStats": [
                ["Rank 2 -> 3", "Kindness Rank 3"],
                ["Rank 4 -> 5", "Kindness Rank 5"],
                ["Rank 6 -> 7", "Kindness Rank 6"],
                ["Rank 8 -> 9", "Kindness Rank 8"],
                ["Rank 10 -> 11", "Kindness Rank 10"],
                ["Rank 12 -> 13", "Kindness Rank 11"],
                ["Rank 14 -> 15", "Kindness Rank 13"],
                ["Rank 16 -> 17", "Kindness Rank 15"],
                ["Rank 19 -> 20", "Kindness Rank 17"]
            ],
            "hangouts": [
                ["Shimokitazawa", "Occasionally +40<br>Senpai how about you? +50"],
                ["Kichioji", "What does the flower pot look like? +50<br>Is it expensive? +40"],
                ["Inokashira Park", "Do you know trees well? +50<br>What about winter? +60"],
                ["Asakusa", "Want to eat sweet food +50<br>Want to eat spicy food +40"],
                ["Shinjuku", "Because of the store manager’s hobby +50<br>Because of different customer groups +40"]
            ],
            "rankUpChoices": [
                ["Rank 2 -> 3", "Let's go to the restaurant that senior often goes to next time +50<br>Let's go to a family restaurant next time +40"],
                ["Rank 4 -> 5", "I'm here+60<br>I'm waiting for senpai to send me+50<br>If you send a text message occasionally+40"],
                ["Rank 6 -> 7", "Let's go+40<br>Luckily it's a family restaurant+50"],
                ["Rank 8 -> 9", "You care about your family +40<br>I don't think it's embarrassing +50"],
                ["Rank 10 -> 11", "I thought I could hold on +40<br>Just a little tired +50"],
                ["Rank 12 -> 13", "That's right +40<br>Thank you for worrying about me +50"],
                ["Rank 14 -> 15", "Okay +50<br>Don't mind if I do +40"],
                ["Rank 16 -> 17", "Let's put it in order, let's go eat first +50<br>Yes, but are you hungry +60"],
                ["Rank 19 -> 20", "None"],
                ["Rank 19 -> 20(Friends)", "I'm used to it +40<br>I'm not alone because I have senpai here +60"]
            ],
            "gifts": [
                ["Nostalgic theme cartoon badge", "18", "9", "9", "¥ 3,500"],
                ["Illustrated directory of rare plants", "28", "14", "14", "¥ 5,500"],
                ["music potted plant", "44", "22", "22", "¥ 8,800"],
                ["Assembled home plant", "48", "24", "24", "¥ 10,000"],
                ["Multiplayer card board game set", "134", "67", "67", "¥ 42,000"],
                ["Scenery poetry", "32", "16", "16", "1 Cosmos Flower,1 Gorgeous Packaging,2 Osmanthus Fragrants"],
                ["Weight-Bearing Wristband", "34", "17", "17", "¥6,800"],
                ["All scale harmonica", "84", "42", "42", "¥21800"],
                ["Handmade Bookcover Set", "16", "8", "8", "¥ 3,000"],
                ["Glass Vase", "16", "8", "8", "¥ 3,200"],
                ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
                ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"],
                ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
                ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
                ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
                ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"]
            ]
        }
    },
    "Minami Miyashita": {
        "icon": "https://cdn.imgchest.com/files/4nec8mjwm84.png",
        "levels": [
            ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Planetarium"],
            ["Rank 2", "Unlocks Trait: Inquisitive", "Unlocks new story"],
            ["Rank 3", "Unlocks Leisure Activity: Science Museum", "Unlocks new story"],
            ["Rank 4", "Unlocks Trait: Analytical", "Unlocks new story"],
            ["Rank 5", "Unlocks Leisure Activity: Library", "Unlocks new story"],
            ["Rank 6", "Unlocks Trait: Intellectual", "Unlocks new story"],
            ["Rank 7", "Unlocks Leisure Activity: Observatory", "Unlocks new story"],
            ["Rank 8", "Unlocks Trait: Logical", "Reduces vitality cost of leisure activities by 20%"],
            ["Rank 9", "Unlocks Leisure Activity: University Lecture", "Unlocks new story"],
            ["Rank 10", "Unlocks Trait: Genius", "Allows you to obtain a Miyashita-exclusive momento"]
        ],
        "guide": {
            "notes": "",
            "skills": [],
            "socialStats": [],
            "hangouts": [],
            "rankUpChoices": [],
            "gifts": []
        }
    },
"Mio Natsukawa": {
    "icon": "https://cdn.imgchest.com/files/49zc2bpgbny.png",
    "levels": [
        ["Rank 1", "Unlocks Confidant", "Unlocks Part-time Job: Shrine"],
        ["Rank 2", "Unlocks Trait: Devout", "Unlocks new story"],
        ["Rank 3", "Unlocks Leisure Activity: Temple", "Unlocks new story"],
        ["Rank 4", "Unlocks Trait: Respectful", "Unlocks new story"],
        ["Rank 5", "Unlocks Part-time Job: Calligraphy Class", "Unlocks new story"],
        ["Rank 6", "Unlocks Trait: Traditional", "Unlocks new story"],
        ["Rank 7", "Unlocks Leisure Activity: Tea Ceremony", "Unlocks new story"],
        ["Rank 8", "Unlocks Trait: Serene", "Reduces vitality cost of part-time jobs by 20%"],
        ["Rank 9", "Unlocks Leisure Activity: Festival", "Unlocks new story"],
        ["Rank 10", "Unlocks Trait: Pious", "Allows you to obtain a Natsukawa-exclusive momento"]
    ],
    "guide": {
        "notes": "",
        "skills": [
            ["1", "Live Wire Mall", "Unlock the [Online Shopping] feature; Can buy items from [Shibuya] online"],
            ["5", "Safe Supply", "Can buy items from [Zoshigaya] online"],
            ["7", "Supply Network", "Can buy items from [Yongen-Jaya] online"],
            ["13", "Pipeline Expansion", "Can buy items from [Kichijoji] online"],
            ["17", "Logistical Support", "Can buy items from [Shinjuku] online"],
            ["20", "Warehouse Hideout", "Can buy items from [Akihabara] online"]
        ],
        "socialStats": [],
        "hangouts": [],
        "rankUpChoices": [],
        "gifts": []
    }
},
"Miyu Sahara": {
    "icon": "https://cdn.imgchest.com/files/4apc53kd3a4.png",
    "levels": [
        ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Cat Cafe"],
        ["Rank 2", "Unlocks Trait: Gentle", "Unlocks new story"],
        ["Rank 3", "Unlocks Leisure Activity: Dog Park", "Unlocks new story"],
        ["Rank 4", "Unlocks Trait: Kind-hearted", "Unlocks new story"],
        ["Rank 5", "Unlocks Leisure Activity: Pet Shop", "Unlocks new story"],
        ["Rank 6", "Unlocks Trait: Nurturing", "Unlocks new story"],
        ["Rank 7", "Unlocks Leisure Activity: Animal Shelter", "Unlocks new story"],
        ["Rank 8", "Unlocks Trait: Compassionate", "Reduces vitality cost of leisure activities by 20%"],
        ["Rank 9", "Unlocks Leisure Activity: Wildlife Park", "Unlocks new story"],
        ["Rank 10", "Unlocks Trait: Cherished", "Allows you to obtain a Sahara-exclusive momento"]
    ],
    "guide": {
        "notes": "Miyu confidant focus on providing more points when gifting gifts to Confidants making her well worth it. It's recommened to get her Rank 17 to max her gifting perks.",
        "skills": [
            ["1", "Adorable Tips", "You can purchase the Limited Edition Keychain at the Kichijoji Energy Stone Store. Snack Value Pack can be purchased at Yongenjaya Supermarket."],
            ["5", "Warm Open-Mindedness", "15% point increase when gifting gifts"],
            ["7", "Big Brother, Nice to Meet You", "Premium Essential Oil Set' can be purchased at Shibuya Underground Shopping Mall Beauty Store. Night Cake can be purchased at Shibuya Underground Shopping Mall / High-end Supermarket."],
            ["13", "Can I Act Cute?", "Tabletop Incense Machine can be purchased at Shibuya Underground Shopping Center and Beauty Salon. Musical Snow Globe Model can be purchased at Kichijoji Stationery Store."],
            ["17", "Big Brother Is So Crafty", "15% point increase when gifting gifts"]
        ],
        "socialStats": [
            ["Rank 2 -> 3", "Kindness Rank 3"],
            ["Rank 4 -> 5", "Kindness Rank 5"],
            ["Rank 6 -> 7", "Kindness Rank 6"],
            ["Rank 8 -> 9", "Kindness Rank 8"],
            ["Rank 10 -> 11", "Kindness Rank 10"],
            ["Rank 12 -> 13", "Kindness Rank 11"],
            ["Rank 14 -> 15", "Kindness Rank 13"],
            ["Rank 16 -> 17", "Kindness Rank 15"],
            ["Rank 19 -> 20", "Kindness Rank 17"]
        ],
        "hangouts": [
            ["Shinjuku", "Don't go far from me+60<br>First of all, I have to finish what I have to do+50"],
            ["Odaiba Seaside Park", "It's an honor +60<br>Why? +50"],
            ["Miura Coast", "Tell me +60<br>I don't know if this will help +50"],
            ["Shibuya", "Trust me +60<br>Will it live up to expectations? +50"],
            ["Jinbocho", "I'm looking forward to it +60<br>Will it remain? +50"]
        ],
        "rankUpChoices": [
            ["Rank 2 -> 3", "Can you tell me what's going on? +50<br>I just want to see the Little Mermaid +60"],
            ["Rank 4 -> 5", "Yeah +60<br>Oh, yeah+40<br>Cheer up +50"],
            ["Rank 6 -> 7", "Yeah +40<br>I don't know +50<br>Does it look like you? +60"],
            ["Rank 8 -> 9", "Okay +60<br>Oh, brother ? +50"],
            ["Rank 10 -> 11", "You have to worry about yourself +60<br>Let's keep it a secret +50"],
            ["Rank 12 -> 13", "Anytime is okay +50<br>Don't you need help? +40<br>I'll be waiting +60"],
            ["Rank 14 -> 15", "It is the result of Miyu's hard work. +60<br>What I did is not worth mentioning. +40<br>It is the result that Miyu takes for granted. +50<br><br>I hope you will give me some time. Friends<br>I also want to be with Miyu in the future. Lovers"],
            ["Rank 16 -> 17", "Let's go together +60<br>Is it okay? +50"],
            ["Rank 19 -> 20", "Don't worry +40<br>I didn't do anything +50<br>It's for Miyu's dream +60"],
            ["Rank 19 -> 20(Lovers)", "My heart is also pounding +60<br>Calm down+50"]
        ],
        "gifts": [
            ["Fairy Tale Deluxe", "20", "10", "10", "¥ 3800"],
            ["Dress Up Doll", "70", "35", "35", "¥ 16,000"],
            ["Premium Fragrance Combination", "20", "10", "10", "¥ 3,800"],
            ["Cartoon Apron", "8", "4", "4", "¥ 1,600"],
            ["Camellia Tea", "18", "9", "9", "4 Camellia + 1 Fancy Package"],
            ["Collected Edition of Psychology Writings", "22", "11", "11", "¥ 4,500"],
            ["Cartoon Theme Pillow", "20", "10", "10", "¥ 4,000"],
            ["Advanced Custom Doll House", "44", "22", "22", "¥ 9,000"],
            ["Mini Speaker", "120", "60", "60", "¥ 36,000"],
            ["The Latest Drone", "112", "56", "56", "¥ 33,000"],
            ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
            ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
            ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
            ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
            ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
            ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
        ]
    }
},
"Riko Tanemura": {
    "icon": "https://cdn.imgchest.com/files/45xcv9gk9b7.png",
    "levels": [
        ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Batting Cages"],
        ["Rank 2", "Unlocks Trait: Tenacious", "Unlocks new story"],
        ["Rank 3", "Unlocks Leisure Activity: Sports Store", "Unlocks new story"],
        ["Rank 4", "Unlocks Trait: Fiery", "Unlocks new story"],
        ["Rank 5", "Unlocks Leisure Activity: Gym", "Unlocks new story"],
        ["Rank 6", "Unlocks Trait: Passionate", "Unlocks new story"],
        ["Rank 7", "Unlocks Leisure Activity: Stadium", "Unlocks new story"],
        ["Rank 8", "Unlocks Trait: Driven", "Reduces vitality cost of leisure activities by 20%"],
        ["Rank 9", "Unlocks Leisure Activity: Pro Match", "Unlocks new story"],
        ["Rank 10", "Unlocks Trait: Ace", "Allows you to obtain a Tanemura-exclusive momento"]
    ],
    "guide": {
        "notes": "Riko's confidant focus on unlocking new hangout spots and gaining more points from intiving confidants to places.",
        "skills": [
            ["1", "Food and Love", "Unlocks the Hangout Spot \"Shibuya Buffet\""],
            ["5", "Taste of Fireworks", "Unlocks the Hangout Spot \"Motomachi Chinatown\""],
            ["7", "Blue Gate", "Unlocks the Hangout Spot \"Shinagawa Aquarium\", and gains more Confidant Points from Invitations"],
            ["13", "Thoughts between Rice", "Unlocks the Hangout Spot \"Ginza Sushi Restaurant\""],
            ["17", "Yellowing Times", "Unlocks the Hangout Spot \"Akihabara Electronics Store\", and gains more Confidant Points from Invitations"]
        ],
        "socialStats": [
            ["Rank 2 -> 3", "Knowledge 3"],
            ["Rank 4 -> 5", "Knowledge 5"],
            ["Rank 6 -> 7", "Knowledge 6"],
            ["Rank 8 -> 9", "Knowledge 8"],
            ["Rank 10 -> 11", "Knowledge 10"],
            ["Rank 12 -> 13", "Knowledge 11"],
            ["Rank 14 -> 15", "Knowledge 13"],
            ["Rank 16 -> 17", "Knowledge 15"],
            ["Rank 19 -> 20", "Knowledge 17"]
        ],
        "hangouts": [
            ["Shibuya", "Please +60<br>No thanks +50"],
            ["Ueno", "I want to go and have a look +60<br>I want to take a break first +50"],
            ["Kichijoji", "Want to research on my own +50<br>Want to know about trendy stores +60"],
            ["Shinjuku", "Calm down +50<br>So you like movie theaters? +60"],
            ["Shimokitazawa", "Of course you can +60<br>Skip patrol? +50"]
        ],
        "rankUpChoices": [
            ["Rank 2 -> 3", "Found your real self? +50<br>All on you +40<br>Got to see Riko being cute +60"],
            ["Rank 4 -> 5", "Let him know the real Riko +60<br>Riko have us +40<br>I don't think so +50"],
            ["Rank 6 -> 7", "It fits you +60<br>Feels tough +40<br>Put it in the candidates? +50"],
            ["Rank 8 -> 9", "Captain's duty +40<br>I'm happy you told me +60<br>Saying it could make you feel relaxed +50"],
            ["Rank 10 -> 11", "Riko won't accept prevarication +60<br>Why embezzled the funds? +40<br>There is a reason for the soft treatment +50"],
            ["Rank 12 -> 13", "Riko is also thinking about other paths +60<br>There is also the option of not being an heir +50<br>Riko will not be the heir +40"]
        ],
        "gifts": []
    }
},
"Ruferu": {
    "icon": "https://cdn.imgchest.com/files/y8xcnkwlkb4.png",
    "levels": [
        ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Dog Park"],
        ["Rank 2", "Unlocks Trait: Animal Lover", "Unlocks new story"],
        ["Rank 3", "Unlocks Leisure Activity: Pet Store", "Unlocks new story"],
        ["Rank 4", "Unlocks Trait: Playful", "Unlocks new story"],
        ["Rank 5", "Unlocks Leisure Activity: Cat Cafe", "Unlocks new story"],
        ["Rank 6", "Unlocks Trait: Loyal", "Unlocks new story"],
        ["Rank 7", "Unlocks Part-time Job: Vet Clinic", "Unlocks new story"],
        ["Rank 8", "Unlocks Trait: Protective", "Reduces vitality cost of leisure activities by 20%"],
        ["Rank 9", "Unlocks Leisure Activity: Animal Shelter", "Unlocks new story"],
        ["Rank 10", "Unlocks Trait: Best Friend", "Allows you to obtain a Ruferu-exclusive momento"]
    ],
    "guide": {
        "notes": "Ruferu is the only confidant whose Confidant can be progressed by the main story and has no dialog options to pick.",
        "skills": [
            ["1", "Deal Established", "Ruferu business goals can be completed from time to time"],
            ["2", "Making Infiltration Tools", "Stealth items can be crafted (Only unlocked after unlocking the workbench)"],
            ["3", "Infiltration Insights", "Can instantly kill low-level shadows in Palaces and Mementos"],
            ["4", "Intermediate Recipe", "You can craft Treasure Hunter items for Kiuchi and Miyazawa Palaces"],
            ["5", "Material Saving Insights", "When making a gift, there is a chance to return some of the materials that was used to make it."],
            ["6", "Advanced Recipe", "More craftable gifts are added"],
            ["7", "Gift Making Skills", "When making a gift, there is a chance to produce an extra"]
        ],
        "socialStats": [],
        "hangouts": [],
        "rankUpChoices": [],
        "gifts": []
    }
},
"Runa Dogenzaka": {
    "icon": "https://cdn.imgchest.com/files/4gdcxplvp64.png",
    "levels": [
        ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Second-hand Shop"],
        ["Rank 2", "Unlocks Trait: Frugal", "Unlocks new story"],
        ["Rank 3", "Unlocks Leisure Activity: Flea Market", "Unlocks new story"],
        ["Rank 4", "Unlocks Trait: Resourceful", "Unlocks new story"],
        ["Rank 5", "Unlocks Leisure Activity: Arcade", "Unlocks new story"],
        ["Rank 6", "Unlocks Trait: Nostalgic", "Unlocks new story"],
        ["Rank 7", "Unlocks Leisure Activity: Retro Cafe", "Unlocks new story"],
        ["Rank 8", "Unlocks Trait: Savvy", "Reduces vitality cost of leisure activities by 20%"],
        ["Rank 9", "Unlocks Leisure Activity: Antique Shop", "Unlocks new story"],
        ["Rank 10", "Unlocks Trait: Collector", "Allows you to obtain a Dogenzaka-exclusive momento"]
    ],
    "guide": {
        "notes": "Runa confidant is great for discounted prices across various in game shops to obtain expensive gifts cheaper.",
        "skills": [
            ["1", "Saving Tips", "In Shibuya, most shops have slightly reduced prices"],
            ["5", "Discount Tips", "In Akihabara, most shops have slightly reduced prices"],
            ["7", "Smart Choices", "In Shinjuku, most shops have slightly reduced prices"],
            ["13", "Smart Spending", "In Zoshigaya and Yogenjaya, most shops have slightly reduced prices"],
            ["17", "Shopping Wisdom", "In Kichijoji, most street shops have slightly reduced prices"]
        ],
        "socialStats": [
            ["Rank 2 -> 3", "Guts Rank 3"],
            ["Rank 4 -> 5", "Guts Rank 5"],
            ["Rank 6 -> 7", "Guts Rank 6"],
            ["Rank 8 -> 9", "Guts Rank 8"],
            ["Rank 10 -> 11", "Guts Rank 10"],
            ["Rank 12 -> 13", "Guts Rank 11"],
            ["Rank 14 -> 15", "Guts Rank 13"],
            ["Rank 16 -> 17", "Guts Rank 15"],
            ["Rank 19 -> 20", "Guts Rank 17"]
        ],
        "hangouts": [
            ["Shibuya", "What an unexpected side 2<br>You know so well 3"],
            ["Shinjuku", "It's Shibuya, so it's astringent 2<br>It's definitely miso ramen 3"],
            ["Odaiba Seaside Park", "Are you good at Frisbee? 3<br>Poor dad... 2"],
            ["Tsukishima", "Order everything on the menu 2<br>Select the most popular dishes first 3"],
            ["Motomachi Chinatown", "This is really... 2<br>Shibuya is really deep 3"]
        ],
        "rankUpChoices": [
            ["Rank 2 -> 3", "I like him very much +60<br>It's just so-so. +50<br>Actually I don't know him very well +40"],
            ["Rank 4 -> 5", "Let's go together +50<br>There's really no other way +40<br>It's all for Shinchi +60"],
            ["Rank 6 -> 7", "It was Liu Qi who touched his heart +60<br>I'm used to it +40<br>Everything is for Shinchi +50"],
            ["Rank 8 -> 9", "Woof woof~! +60<br>Woof woof~ +50<br>…Woof woof~… +40"],
            ["Rank 10 -> 11", "What matters is after being noticed +60<br>Black and red are also red +50<br>Just be ugly to the end +40"],
            ["Rank 12 -> 13", "You were the first to infringe the copyright +40<br>Are you jealous of Ah Qi? +50<br>Apologize to Liu Qi +60"],
            ["Rank 14 -> 15", "I'll \"convince\" him +50<br>Just asking casually +40<br>Leave it to me later +60<br><br>Because I love Shibuya (Close Friends)<br>Because I want to make Runa smile (Soulmates)"],
            ["Rank 16 -> 17", "Shibuya is willing to tolerate everyone +60<br>Ryuichi is also quite naive +40<br>As expected of the seventh generation +50"],
            ["Rank 19 -> 20", "I thought about it +40<br>I knew you can cook +40"],
            ["Rank 19 -> 20(Lovers)", "Want to go to my room? +50<br>I want you to stay +60"]
        ],
        "gifts": [
            ["Sports Cap", "18", "9", "9", "¥ 3,500"],
            ["Styling Ballon Set", "14", "7", "7", "¥ 2,550"],
            ["Cartoon sleeping eye mask", "30", "15", "15", "¥5,590"],
            ["Advanced Sewing Tools Set", "48", "24", "24", "¥9,800"],
            ["Mini Marshmallow Machine", "84", "42", "42", "¥20,800"],
            ["Potted Music Plant", "44", "22", "22", "¥ 8,800"],
            ["Mascot Plushie", "40", "20", "20", "¥7800"],
            ["Cute Lunch Box", "32", "16", "16", "¥3200"],
            ["Choker Necklace", "74", "37", "37", "¥ 18000"],
            ["Pancake Glasses", "104", "52", "52", "¥ 30,000"],
            ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
            ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
            ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
            ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
            ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
            ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
        ]
    }
},
"Tomoko Noge": {
    "icon": "https://cdn.imgchest.com/files/4z9cvwn8wz7.png",
    "levels": [
        ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Batting Cages"],
        ["Rank 2", "Unlocks Trait: Studious", "Doubles knowledge gained from studying"],
        ["Rank 3", "Unlocks Leisure Activity: Bookstore", "Unlocks new story"],
        ["Rank 4", "Unlocks Trait: Straight-laced", "Unlocks new story"],
        ["Rank 5", "Unlocks Leisure Activity: Library", "Doubles knowledge from leisure activities"],
        ["Rank 6", "Unlocks Trait: Calm", "Unlocks new story"],
        ["Rank 7", "Unlocks Leisure Activity: Game Center", "Unlocks new story"],
        ["Rank 8", "Unlocks Trait: Level-headed", "Reduces vitality cost of leisure activities by 20%"],
        ["Rank 9", "Unlocks Leisure Activity: Billiards", "Unlocks new story"],
        ["Rank 10", "Unlocks Trait: Perceptive", "Allows you to obtain a Noge-exclusive momento"]
    ],
    "guide": {
        "notes": "Tomoko is the best city confidant in the game as she can give you jobs and extra social stats while working. It's recommended to get her to atleast Rank 13 to gain the maximum amount of social stats while working",
        "skills": [
            ["1", "Part-Time Worker Debut", "You can work at Shibuya Dessert Shop"],
            ["5", "Observation Experience", "When working, the social stats you gain while working is increased."],
            ["7", "Reception Expert", "You can work at Shibuya Drug Store"],
            ["13", "Service Experience", "When working, the social stats you gain while working will be additional increased"],
            ["17", "Customer Observation", "You can work part-time at Shinjuku Bookstore"]
        ],
        "socialStats": [
            ["Rank 2 -> 3", "Kindness Rank 3"],
            ["Rank 4 -> 5", "Kindness Rank 5"],
            ["Rank 6 -> 7", "Kindness Rank 6"],
            ["Rank 8 -> 9", "Kindness Rank 8"],
            ["Rank 10 -> 11", "Kindness Rank 10"],
            ["Rank 12 -> 13", "Kindness Rank 11"],
            ["Rank 14 -> 15", "Kindness Rank 13"],
            ["Rank 16 -> 17", "Kindness Rank 15"],
            ["Rank 19 -> 20", "Kindness Rank 17"]
        ],
        "hangouts": [
            ["Shibuya", "Let's choose a pretty bouquet +60<br>It's better to choose it yourself... +50"],
            ["Shinjuku", "It's nothing +60<br>It's a little awkward since there are only two of us... +50"],
            ["Suidobashi", "I'm so sorry about this... +50<br>Then I won't give up +60"],
            ["Odaiba Seaside Park", "Okay +60<br>In that situation... +50"],
            ["Inokashira Park", "Respectable +60<br>Don't you have to work part-time too...? +50"]
        ],
        "rankUpChoices": [
            ["Rank 2 -> 3", "So +60<br>is it... +40<br>Nice pitching +50"],
            ["Rank 4 -> 5", "You can get stronger quickly +40<br>Don't overdo it +60<br>If it's training, I'll help you +50"],
            ["Rank 6 -> 7", "Should I suggest it to the store manager? +40<br>Let's plan and try properly +60<br>It's worth a try +50"],
            ["Rank 8 -> 9", "No way +60<br>I did nothing but +50<br>Now it's time to start becoming independent +40"],
            ["Rank 10 -> 11", "Help me +60<br>Can you really do it…? +40<br>Today I am the florist owner +50"],
            ["Rank 12 -> 13", "That's a big improvement +50<br>I'm a little disappointed +60<br>What is today’s recommended menu? +40"],
            ["Rank 14 -> 15", "Sometimes I like things like this +50<br>Okay? +40<br>I'm glad the weather is nice +60<br><br>Until Kotone’s heart is healed (Friends)<br>I will always be by Tomoko's side (Lovers)"],
            ["Rank 16 -> 17", "We'll be together +60<br>Don't overdo it +50"],
            ["Rank 19 -> 20", "Of course +50<br>I'm still worried +40<br>Let's calm down! +60"],
            ["Rank 19 -> 20(Lovers)", "It's just the two of us today +50<br><br>My parents are traveling +60"]
        ],
        "gifts": [
            ["Magazine", "4", "2", "2", "¥800"],
            ["Mascot Plushie", "40", "20", "20", "¥7800"],
            ["Milk Flavor Bar Pack", "12", "24", "24", "¥4890"],
            ["Cat Hairpin", "30", "10", "10", "¥4000"],
            ["Heartshaped Ring", "250", "125", "125", "¥88,000"],
            ["Cute Lunch Box", "32", "16", "16", "¥3200"],
            ["Super Noisy Alarm Clock", "54", "18", "18", "¥7000"],
            ["Heartshaped Hand Mirror", "12", "6", "6", "¥1200"],
            ["Sunflower Seeds", "36", "18", "18", "Sunflower x6,Single Packet 1"],
            ["Uji Matcha Pudding", "112", "56", "56", "¥12,000"],
            ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
            ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
            ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
            ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
            ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
            ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
        ]
    }
},
"Yaoling Li": {
    "icon": "https://cdn.imgchest.com/files/ye3c2djpd84.png",
    "levels": [
        ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Movie Watching"],
        ["Rank 2", "Unlocks Trait: Cultured", "Doubles insight gained from watching movies"],
        ["Rank 3", "Unlocks Leisure Activity: Window Shopping", "Unlocks new story"],
        ["Rank 4", "Unlocks Trait: Self-Made", "Unlocks new story"],
        ["Rank 5", "Unlocks Leisure Activity: Exhibit Watching", "Doubles charm gained from leisure activities"],
        ["Rank 6", "Unlocks Trait: Elegant", "Unlocks new story"],
        ["Rank 7", "Unlocks Leisure Activity: Livehouse", "Unlocks new story"],
        ["Rank 8", "Unlocks Trait: Free-spirited", "Reduces vitality cost of leisure activities by 20%"],
        ["Rank 9", "Unlocks Leisure Activity: VR Games", "Unlocks new story"],
        ["Rank 10", "Unlocks Trait: Dazzling", "Allows you to obtain a Li-exclusive momento"]
    ],
    "guide": {
        "notes": "Yaoling Li is a mixed bag confidant as she can give you recipes to cook Chinese dishes and allow you to craft battle items. It recommened to rank her all the way to Rank 13 to max out her crafting perks.",
        "skills": [
            ["1", "Ingenuity", "You craft small items to use in battle."],
            ["5", "Chinese Cuisine Recipes", "Some Chinese dishes to cook are unlocked"],
            ["7", "Fruits of Labor", "More in battle items can be crafted"],
            ["13", "Dexterous Skills", "When crafting combat items, some materials may be returned."],
            ["17", "The Charm of Chinese Cuisine", "More Chinese cuisine are unlocked"]
        ],
        "socialStats": [
            ["Rank 2 -> 3", "Knowledge 3"],
            ["Rank 4 -> 5", "Knowledge 5"],
            ["Rank 6 -> 7", "Knowledge 6"],
            ["Rank 8 -> 9", "Knowledge 8"],
            ["Rank 10 -> 11", "Knowledge 10"],
            ["Rank 12 -> 13", "Knowledge 11"],
            ["Rank 14 -> 15", "Knowledge 13"],
            ["Rank 16 -> 17", "Knowledge 15"],
            ["Rank 19 -> 20", "Knowledge 17"]
        ],
        "hangouts": [
            ["Kanda", "I heard +60<br>I have no idea +50"],
            ["Tsukishima", "That could be +60<br>Is that so? +50"],
            ["Asakusa", "Want to take the water bus? +60<br>Want to go to the aquarium? +50"],
            ["Joshigaya", "I'll buy it +60<br>Buy me +50"],
            ["Shimokitazawa", "Does it matter? +50<br>Yaoling answer +60"]
        ],
        "rankUpChoices": [
            ["Rank 2 -> 3", "How about trying out different experiences? +60<br>This is a serious problem… +40<br>Don't be so impatient +50"],
            ["Rank 4 -> 5", "Maybe +40<br>How about Yaoling? +60<br>I will work hard except for studying +50"],
            ["Rank 6 -> 7", "Yaoling, cheer up too +60<br>Go at your own pace +50<br>First of all, it's important to enjoy it +40"],
            ["Rank 8 -> 9", "I have to do something +60<br>Other people's house circumstances... +50<br>I'm still not sure +40"],
            ["Rank 10 -> 11", "Good opportunity +60<br>I want to talk about more stories +50<br>Looks like it'll be fun to study +40"],
            ["Rank 12 -> 13", "Do you know matcha well? +60<br>You have a huge appetite +40<br>Lady who knows the difference +50"],
            ["Rank 14 -> 15", "The truth must be felt +60<br>Let's speak politely +40<br>I have no choice but to say what I want to say +50<br><br>Because I promised you. Friends<br>Yaoling is precious to me.Lovers"],
            ["Rank 16 -> 17", "It must have been conveyed +50<br>I don't know +40<br>Believe +60"],
            ["Rank 19 -> 20", "Best answer +50<br>Maybe I'm thinking too much? +40<br>Dad's being mean... +60"],
            ["Rank 19 -> 20(Lovers)", "It's pretty... +60<br>It's amazing... +50"]
        ],
        "gifts": [
            ["Limited card set", "16", "8", "8", "¥ 3,200"],
            ["Supernatural Video", "110", "55", "55", "¥ 32,000"],
            ["Incredible Glasses", "18", "9", "9", "¥ 3,560"],
            ["Special Nut Combination", "14", "7", "7", "¥ 2,800"],
            ["Adult Smart Ring", "24", "12", "12", "¥ 4,700"],
            ["Digital Camera", "128", "64", "64", "¥39,800"],
            ["Traditional Dim Sum Combination", "20", "10", "10", "¥ 3,800"],
            ["Kendama", "12", "6", "6", "¥2,400"],
            ["High Performance Electric Toothbrush", "104", "52", "52", "¥29,800"],
            ["Jasmine Tea", "18", "9", "9", "1 Simple Packing,6 Jasmine"],
            ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
            ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
            ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
            ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
            ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
            ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
        ]
    }
},
"YUI": {
    "icon": "https://cdn.imgchest.com/files/7w6c2vgmvqy.png",
    "levels": [
        ["Rank 1", "Unlocks Confidant", "Unlocks Part-time Job: Cafe"],
        ["Rank 2", "Unlocks Trait: Focused", "Unlocks new story"],
        ["Rank 3", "Unlocks Part-time Job: Ramen Shop", "Unlocks new story"],
        ["Rank 4", "Unlocks Trait: Reserved", "Unlocks new story"],
        ["Rank 5", "Unlocks Part-time Job: Cake Shop", "Unlocks new story"],
        ["Rank 6", "Unlocks Trait: Observant", "Unlocks new story"],
        ["Rank 7", "Unlocks Part-time Job: Cinema", "Unlocks new story"],
        ["Rank 8", "Unlocks Trait: Efficient", "Reduces vitality cost of part-time jobs by 20%"],
        ["Rank 9", "Unlocks Part-time Job: Hotel", "Unlocks new story"],
        ["Rank 10", "Unlocks Trait: Reliable", "Allows you to obtain a YUI-exclusive momento"]
    ],
    "guide": {
        "notes": "YUI is a good confidants for players who are looking to invest into planting. Its recommened to rank her all the way to Rank 17 to max her planting perks.",
        "skills": [
            ["1", "Chat With Plants", "Planting time reduced"],
            ["5", "Make Friends with Plants", "Unlock more flower pots and vegetable pots"],
            ["9", "Thoughts of Response", "Planting and harvesting provide opportunities to obtain seeds"],
            ["13", "Cultivation Insights", "Planting has a certain chance of obtaining additional plant"],
            ["17", "Convey Wishes", "Planting time significantly reduced"]
        ],
        "socialStats": [
            ["Rank 2 -> 3", "Kindness Rank 3"],
            ["Rank 4 -> 5", "Kindness Rank 5"],
            ["Rank 6 -> 7", "Kindness Rank 6"],
            ["Rank 8 -> 9", "Kindness Rank 8"],
            ["Rank 10 -> 11", "Kindness Rank 10"],
            ["Rank 12 -> 13", "Kindness Rank 11"],
            ["Rank 14 -> 15", "Kindness Rank 13"],
            ["Rank 16 -> 17", "Kindness Rank 15"],
            ["Rank 19 -> 20", "Kindness Rank 17"]
        ],
        "hangouts": [
            ["Field", "It's huge +60<br>Really for beginners? +40"],
            ["Nearby", "I don't feel like it, but I'll go... +60<br>It doesn't suit me +40"],
            ["Far Away", "Want to live? +60<br>It won't be easy to raise +40"],
            ["Snowfield", "I want to go sledding +60<br><br>I want to do winter sports +50<br>Dig a hole in the snow +40"],
            ["Manager's Field", "No Choice"]
        ],
        "rankUpChoices": [
            ["Rank 2 -> 3", "I like it +60<br>Embarrassing +40<br>Raise the title a bit more +50"],
            ["Rank 4 -> 5", "Let's talk a lot in the future +60<br>If you're just a conversation partner... +40<br>Are you okay with me? +50"],
            ["Rank 6 -> 7", "Looks fun +60<br>What are you doing? +40<br>Bazooka...? +50"],
            ["Rank 8 -> 9", "Ms.YUI? +40<br>Do you like French fries? +60<br>Baron +50"],
            ["Rank 10 -> 11", "Should I give you some more water? +50<br>Is the fertilizer wrong? +40<br>Are there any pests? +60"],
            ["Rank 12 -> 13", "I'll be with you +60<br>Everyday is a bit… +40<br>There may be another problem +50"],
            ["Rank 14 -> 15", "That makes sense +50<br>Is that the problem…? +60<br>YUI replied +40"],
            ["Rank 16 -> 17", "Things that don't require much hands +60<br>Sunlight is also important +50<br>Inspiration is important +40"],
            ["Rank 19 -> 20", "YUI and everyone worked hard +40<br>I'm just a trigger +60<br>Do you think my title will go up too? +50"],
            ["Rank 19 -> 20(Friends)", "I'm so into farming... +60<br>I have a houseplant… +50<br><br>[Additional Choices]<br>Are you living together? +60<br>Listen to my opinion too +50"]
        ],
        "gifts": [
            ["Idol's Light Game Card", "24", "12", "12", "¥ 4,900"],
            ["Magnet Necklace", "24", "12", "12", "¥ 4,800"],
            ["Desktop Mini Cactus", "8", "4", "4", "¥ 1,500"],
            ["Themed Flower pots", "2", "1", "1", "¥ 500"],
            ["Sweeping Robot", "100", "50", "50", "¥ 28,000"],
            ["Glass Vase", "16", "8", "8", "¥ 3,200"],
            ["Handmade Flower Basket", "16", "8", "8", "¥ 3,200"],
            ["Chocolate Truffles", "28", "14", "14", "¥ 12,000"],
            ["Designer Perfume", "224", "112", "112", "¥ 78,000"],
            ["Watercolor Postcard", "4", "2", "2", "¥ 800"],
            ["Limited Edition Keychain", "16", "8", "8", "¥ 3,000"],
            ["Thick Snacks Value Pack", "16", "8", "8", "¥ 3,000"],
            ["Music Snow Globe Model", "24", "12", "12", "¥ 10,000"],
            ["Chestnut Cake", "30", "15", "15", "¥ 6,000"],
            ["Desktop Incense Machine", "56", "28", "28", "¥ 7,700"],
            ["Advanced Essential Oil Combination", "38", "19", "19", "¥ 12,000"]
        ]
    }
},
"Yumi Shiina": {
    "icon": "https://cdn.imgchest.com/files/739cx6on667.png",
    "levels": [
        ["Rank 1", "Unlocks Confidant", "Unlocks Leisure Activity: Aquarium"],
        ["Rank 2", "Unlocks Trait: Calm", "Unlocks new story"],
        ["Rank 3", "Unlocks Leisure Activity: Planetarium", "Unlocks new story"],
        ["Rank 4", "Unlocks Trait: Dreamy", "Unlocks new story"],
        ["Rank 5", "Unlocks Leisure Activity: Art Museum", "Unlocks new story"],
        ["Rank 6", "Unlocks Trait: Imaginative", "Unlocks new story"],
        ["Rank 7", "Unlocks Leisure Activity: Cat Cafe", "Unlocks new story"],
        ["Rank 8", "Unlocks Trait: Empathetic", "Reduces vitality cost of leisure activities by 20%"],
        ["Rank 9", "Unlocks Leisure Activity: Hot Springs", "Unlocks new story"],
        ["Rank 10", "Unlocks Trait: Serene", "Allows you to obtain a Shiina-exclusive momento"]
    ],
    "guide": {
        "notes": "Yumi is the second best city confidant as she can let you craft drinks to restore action points. It's recommened to rank her all the way to Rank 17 for the chance to obtain double drinks.",
        "skills": [
            ["1", "Shake", "Unlock new drinks at the cooking station (which can improve properties after drinking)"],
            ["5", "Strain", "The cooking station unlocks more new drinks (which can restore action points after drinking)"],
            ["9", "Blend", "Allows you to purchase an additional Assam Tea at the Shinjuku Convenience Store"],
            ["13", "Frozen", "Increased chance of making perfect drinks when making drinks"],
            ["17", "Dual Mixing", "50% chance to create an extra drink when making drinks"]
        ],
        "socialStats": [
            ["Rank 2 -> 3", "Charm Rank 3"],
            ["Rank 4 -> 5", "Charm Rank 5"],
            ["Rank 6 -> 7", "Charm Rank 6"],
            ["Rank 8 -> 9", "Charm Rank 8"],
            ["Rank 10 -> 11", "Charm Rank 10"],
            ["Rank 12 -> 13", "Charm Rank 11"],
            ["Rank 14 -> 15", "Charm Rank 13"],
            ["Rank 16 -> 17", "Charm Rank 15"],
            ["Rank 19 -> 20", "Charm Rank 17"]
        ],
        "hangouts": [
            ["Shibuya", "If it's guidance, trust me +50<br>Let's play together +60"],
            ["Shinjuku", "It's a pity... +50<br>When you become an adult +60"],
            ["Odaiba Seaside Park", "It's an honor +50<br>Please give me the second one too +60"],
            ["Ikebukuro", "Add star shaped ice +50<br>Expressing the night sky with colors +60"],
            ["Tsukishima", "Call me master +50<br>I tried my best for Shiina +60"]
        ],
        "rankUpChoices": [],
        "gifts": []
    }
}
};

const personaData = {
    "Janosik": {
    "icon": "https://cdn.imgchest.com/files/7ogcbxl8g3y.png",
	"rarity": 5,
	"element": "Gun",
        uniqueSkill: {
            name: "Reaper III",
            description: "Increases ATK by 29.1%. At the start of battle, inflicts 1 foe with [Marked]. When allies attack foes with [Marked], increases ATK by 20%. Additionally decreases DEF by 12% for foes with [Marked]. When you attack foes with [Marked], deal an additional 18% ATK as Gun DMG to them. [Marked]: Reduce enemy defense by 29.6% for 2 turns."
        },
        mainSkill: {
            name: "Tatra Shot",
            description: "Deals 203.3% ATK as Gun DMG to 1 foe, has 75% fixed chance of inflicting [Marked]: Reduce enemy defense by 29.6% for 2 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deals 360.0% ATK as Gun DMG to 1 foe."
        },
        recommended: [
            { name: "Rakunda", description: "Decrease DEF of 1 foe by 38.8% for 3 turns." },
            { name: "Rebellion", description: "Increase 1 ally's CRIT by 9.3% + 1.6% for every 10% CRIT Wonder has, up to 6.4% for 3 turns." },
            { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
            { name: "Tarukaja", description: "Increases 1 ally's ATK by 15.5% + 1.3% for every 500 ATK you have, up to 10.4% for 3 turns." },
            { name: "Damage Reduction", description: "Decrease damage taken by 4.7%/6.7%/8.7%/10.8%." },
            { name: "Defense Boost", description: "Increases DEF by 8.8%/12.5%/16.3%." }
        ],
        note: "If you don't use Janosik as the vanguard, when you use the Persona skill after replacing, the '[Marked]' is obtained at the start of battle is triggered, and the '[Marked]' is applied (only once). The buff also triggers '[Marked]'."
    },
    "Vishnu": {
	"icon": "https://cdn.imgchest.com/files/yrgcn98k6j4.png",
		"rarity": 5,
		"element": "Wind",
        uniqueSkill: {
            name: "Blessing to All III",
            description: "Increases CRIT Rate by 17.5%. Increases EHR when inflicting Winded by 20% and increase dmg dealt to foes with Winded by 30%. Decreases the foes' DEF by 48% when refreshing or inflicting Winded for 2 turns."
        },
        mainSkill: {
            name: "Winds of Nirvana",
            description: "Deals 192.0% ATK Wind dmg to 1 foe, with a 75% base chance to inflict Winded; If foe is already inflicted with Winded, refreshes its duration, increases this damage by 27.0% and increases their Wind dmg taken by 27.0% for 2 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deal 360% ATK as Wind dmg to 1 foe."
        },
        recommended: [
            { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." },
            { name: "Windswept Boost", description: "Increases Windswept accuracy by 8.8%/12.5%/16.3%." },
            { name: "Ambient Aid", description: "Increase ailment accuracy by 9.1%/13%/16.9% when it rains." },
            { name: "Magarudyne", description: "Deals 60.8% ATK Wind dmg to all foes and has a 33.8% chance of inflicting Wind Strike for 2 turns." },
            { name: "Wind Boost", description: "Increases Wind damage by 4.7%/6.7%/8.7%/10.8%." },
            { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
            { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
            { name: "Speed Master", description: "Increases SPD by 6/9/12/15 and decreases DEF by 0%/4%/8%/12%." }
        ],
        note: "Through Magarudyne, you can apply area-wide defense reduction effects when inflicting Winded."
    },
    "Dionysus": {
	"icon": "https://cdn.imgchest.com/files/yd5cemkzne4.png",
		"rarity": 4,
		"element": "Psychokinesis",
        uniqueSkill: {
            name: "Draken Revelry III",
            description: "Increases CRIT Rate by 14.8%. When using a Persona skill on allies, increases the main target's CRIT DMG by 30% for 2 turns."
        },
        mainSkill: {
            name: "Revolution",
            description: "Increase all allies CRIT by 6.5% + 1.1% for every 10% CRIT Wonder has to a maximum of 4.4% for 3 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Increase all allies dmg dealt by 29.5% for 2 turns."
        },
        recommended: [
            { name: "Infinite Algorithm", description: "Increase all allies' ATK by 30% and damage to main target by 30% for 3 turns." },
            { name: "Rebellion", description: "Increase 1 ally's CRIT by 9.3% + 1.6% for every 10% CRIT Wonder has, up to 6.4% for 3 turns." },
            { name: "Tarukaja", description: "Increase 1 ally's ATK by 15.5% + 1.3% for every 500 ATK you have, up to 10.4% for 3 turns." },
            { name: "Rakukaja", description: "Increase 1 ally's DEF by 23.3% + 3.9% for every 500 DEF Wonder has to a maximum of 15.6% for 3 turns." },
            { name: "Mediarahan", description: "Restores HP equal to 19.0% ATK + 575 to all allies." },
            { name: "Healing Boost", description: "Increases Healing Effect by 4.2%/6.0%/7.8%/9.7%." },
            { name: "Damage Reduction", description: "Decrease damage taken by 4.7%/6.7%/8.7%/10.8%." },
            { name: "Defense Boost", description: "Increase DEF by 8.8%/12.5%/16.3%." }
        ],
        note: "The core passive critical effect 30% increase also applies to healing through Mediarahan. Infinite Algorithm is a skill card distributed through paid events."
    },
    "Dominion": {
	"icon": "https://cdn.imgchest.com/files/4gdcxm2vzp4.png",
		"rarity": 5,
		"element": "Bless",
        uniqueSkill: {
            name: "Angel's Order III",
            description: "Increases ATK by 29.1%. Gains 2 [Order] when using a skill on allies. When allies deals damage with a skill, consume 1 stack of [Order] to increase their DMG Dealt by 15% and ATK by 6.4% for 1 turn."
        },
        mainSkill: {
            name: "Cohesion",
            description: "Increases all allies' ATK by 15% + 1.25% for every 500 ATK you have, up to 10% for 2 turns. Increases the main target's dmg dealt by 8% + 1% for every 500 ATK you have, up to 5% for 1 turn."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Increase all allies dmg dealt by 29.5% for 2 turns."
        },
        recommended: [
            { name: "Rebellion", description: "Increase 1 ally's CRIT by 9.3% + 1.6% for every 10% CRIT Wonder has, up to 6.4% for 3 turns." },
            { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
            { name: "Tarukaja", description: "Increases 1 ally's ATK by 15.5% + 1.3% for every 500 ATK you have, up to 10.4% for 3 turns." },
            { name: "Damage Reduction", description: "Decrease damage taken by 4.7%/6.7%/8.7%/10.8%." }
        ],
        note: "Through Order + Cohesion buffs, you can provide maximum ATK 31.4% and damage 31% increase effects in 1 turn."
    },
    "Nian": {
	"icon": "https://cdn.imgchest.com/files/49zc2vag8dy.png",
		"rarity": 5,
		"element": "Curse",
        uniqueSkill: {
            name: "Yearly Beast III",
            description: "Increases ATK by 29.1%. After using Persona skill on enemies, inflicts the targets with [Yearly Sacrifice] for 2 turns. Enemies with [Yearly Sacrifice] will gain [Frightened] when taking Fire damage for the first time: Increases dmg taken by 12% for 3 turns. Also has a 75% base chance to inflict Burn for 2 turns."
        },
        mainSkill: {
            name: "Fortune Devourer",
            description: "Deals 104.0% ATK Curse dmg to all foes, decreases all foes' DEF by 10% and increases all foes Damage Over Time taken by 30% for 2 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deals 90.0% ATK Curse dmg to all foes and increase their dmg taken by 19.6% for 2 turns."
        },
        recommended: [
            { name: "Melodic Infiltration", description: "Decrease all foes' DEF by 32% and increase damage taken by 10% for 3 turns." },
            { name: "Marakunda", description: "Decrease all foes' DEF by 27.1% for 3 turns." },
            { name: "Damage Reduction", description: "Decrease damage taken by 4.7%/6.7%/8.7%/10.8%." },
            { name: "Definite Boost", description: "Increases DEF by 8.8%/12.5%/16.3%." }
        ],
        note: "Rhythmic Intrusion is a skill card distributed through paid events and can be replaced with Marakunda."
    },
    "Surt": {
	"icon": "https://cdn.imgchest.com/files/yq9c3vzbzm4.png",
		"rarity": 3,
		"element": "Fire",
        uniqueSkill: {
            name: "Inferno Monarch I",
            description: "Increases EHR by 20.9%. Increases EHR by 50% when inflicting Burn. Increases the effect by 30% when the foe is above 50% HP."
        },
        mainSkill: {
            name: "Marakunda",
            description: "Decrease DEF of all foes by 27.1% for 3 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deals 90.0% ATK as Fire dmg to all foes and increase their dmg taken by 19.6% for 2 turns."
        },
        recommended: [
            { name: "Damage Reduction", description: "Decrease damage taken by 4.7%/6.7%/8.7%/10.8%." },
            { name: "Definite Boost", description: "Increases DEF by 8.8%/12.5%/16.3%." }
        ],
        note: "The only persona that possesses Marakunda besides the Marakunda skill card."
    },
    "Koumokuten": {
	"icon": "https://cdn.imgchest.com/files/4z9cv9aj867.png",
		"rarity": 4,
		"element": "Physical",
        uniqueSkill: {
            name: "Heavenly Gaze II",
            description: "Increases EHR by 21.2%. At the start of battle, increases the ATK and CRIT Rate for the ally with the highest ATK by 14% and 6% for 3 turns, prioritizing Single-target/Multi-target Thief."
        },
        mainSkill: {
            name: "Revolution",
            description: "Increase all allies CRIT by 6.5% + 1.1% for every 10% CRIT Wonder has to a maximum of 4.4% for 3 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Increase all allies dmg dealt by 29.5% for 2 turns."
        },
        recommended: [
            { name: "Rakunda", description: "Decrease DEF of 1 foe by 38.8% for 3 turns." },
            { name: "Auto-Mataru", description: "Increase ATK for all allies by 4.2%/6.0%/7.9%/9.8% at the start of battle for 2 turns or until persona change." },
            { name: "Speed Master", description: "Increases SPD by 6/9/12/15 and decreases DEF by 0%/4%/8%/12%." },
            { name: "Rebellion", description: "Increase 1 ally's CRIT by 9.3% + 1.6% for every 10% CRIT Wonder has, up to 6.4% for 3 turns." },
            { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
            { name: "Tarukaja", description: "Increases 1 ally's ATK by 15.5% + 1.3% for every 500 ATK you have, up to 10.4% for 3 turns." }
        ],
        note: "The core passive buff continues even after persona switching."
    },
    "Ame-no-Uzume": {
	"icon": "https://cdn.imgchest.com/files/4gdcxm2wwa4.png",
		"rarity": 5,
        uniqueSkill: {
            name: "Trembling Kagura I",
            description: "Increases EHR by 13%. After inflicting Shock, increases all allies' CRIT Rate by 10.0% for 2 turns."
        },
        mainSkill: {
            name: "Electric Surge",
            description: "Deals 143.0% ATK Elec dmg to 1 foe, with a 100.0% base chance to inflict Shock for 2 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deal 360% ATK as Elec dmg to 1 foe."
        },
        recommended: [
            { name: "El Hjud", description: "Deals 64.8% ATK Electric dmg to all foes and has a 36.0% chance of inflicting Shock for 2 turns." },
            { name: "Shock Boost", description: "Increase Shock accuracy by 8.8%/12.5%/16.3%/20.3%." },
            { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." },
            { name: "Ambient Aid", description: "Increase ailment accuracy by 9.1%/13%/16.9% when it rains." }
        ],
        note: "Through area-wide shock, you can aim for a total of 20% critical rate increase with 10% from the core passive following the critical rate increase from shock."
    },
    "Succubus": {
	"icon": "https://cdn.imgchest.com/files/45xcv8zpnv7.png",
		"rarity": 4,
		"element": "Curse",
        uniqueSkill: {
            name: "Intoxicating Murmur I",
            description: "Increases ATK by 3.5%. When using a skill on an ally, increases their CRIT Rate by 10.2% for 1 turn."
        },
        mainSkill: {
            name: "Rebellion",
            description: "Increase 1 ally's CRIT by 9.3% + 1.6% for every 10% CRIT Wonder has to a maximum of 6.4% for 3 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Increase all allies dmg dealt by 29.5% for 2 turns."
        },
        recommended: [
            { name: "Rebellion", description: "Increase 1 ally's CRIT by 9.3% + 1.6% for every 10% CRIT Wonder has to a maximum of 6.4% for 3 turns." },
            { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
            { name: "Tarukaja", description: "Increases 1 ally's ATK by 15.5% + 1.3% for every 500 ATK you have, up to 10.4% for 3 turns." },
            { name: "Rakukaja", description: "Increase 1 ally's DEF by 23.3% + 3.9% for every 500 DEF Wonder has to a maximum of 15.6% for 3 turns." }
        ],
        note: null
    },
    "Narcissus": {
	"icon": "https://cdn.imgchest.com/files/yxkczqnvaj7.png",
		"rarity": 5,
		"element": "Wind",
        uniqueSkill: {
            name: "Lost Fragrance II",
            description: "Increases EHR by 24.9%. After inflicting Winded, increases the main target's dmg taken by 22.4% for 2 turns and increases own EHR by 18% for 2 turns."
        },
        mainSkill: {
            name: "Wild Hunt",
            description: "Deals 155.1% ATK Wind dmg to 1 foe and has a 100.0% chance of inflicting Winded for 2 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deals 90.0% ATK Wind dmg to all foes and increase their dmg taken by 19.6% for 2 turns."
        },
        recommended: [
            { name: "Wind Boost", description: "Increases Wind damage by 4.7%/6.7%/8.7%/10.8%." },
            { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
            { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
            { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
            { name: "Pinpoint", description: "Increases Critical damage by 7%/10%/13%/16.2%." }
        ],
        note: null
    },
    "Norn": {
	"icon": "https://cdn.imgchest.com/files/7w6c2qe6o2y.png",
		"rarity": 5,
		"element": "Wind",
        uniqueSkill: {
            name: "Wind of Fate III",
            description: "Increases DEF by 17.4%. After inflicting Winded, decreases the DEF of the inflicted enemies by 11.5% and increases own DEF by 30% for 2 turns."
        },
        mainSkill: {
            name: "Wind Barrier",
            description: "Grants 1 ally 19.5% ATK + 590 Shield for 2 turns. When that ally takes damage, there is a 55.0% base chance to inflict Winded for 2 turns on the source of damage."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Grants all allies 48.6% ATK + 1471 shield for 2 turns."
        },
        recommended: [
            { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." },
            { name: "Windswept Boost", description: "Increases Windswept accuracy by 8.8%/12.5%/16.3%." },
            { name: "Ambient Aid", description: "Increase ailment accuracy by 9.1%/13%/16.9% when it rains." },
            { name: "Magarula", description: "Deals 57.0% ATK Wind dmg to all foes and has a 31.7% chance of inflicting Wind Strike for 2 turns." },
            { name: "Garudyne", description: "Deals 121.7% ATK Wind dmg to 1 foe and has a 67.6% chance of inflicting Wind Strike for 2 turns." },
            { name: "Shield Boost", description: "Increase Shield Effect by 4.2%/6.7%/8.7%/9.7%." }
        ],
        note: "Although Vishnu was used in a different party, it can be used if the same mechanism is needed."
    },
    "Jikokuten": {
	"icon": "https://cdn.imgchest.com/files/yrgcn98b6d4.png",
		"rarity": 4,
		"element": "Physical",
        uniqueSkill: {
            name: "Wisdom of the East I",
            description: "Increases DEF by 15.9%. When using a skill on allies, increases the main target's ATK by 13.5% for 2 turns, increases this effect by 10% when the target is below 60% HP."
        },
        mainSkill: {
            name: "Matarukaja",
            description: "Increase all allies ATK by 10.9% + 0.9% for every 500 ATK Wonder has to a maximum of 7.2% for 3 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Increase all allies dmg dealt by 29.5% for 2 turns."
        },
        recommended: [
            { name: "Tarukaja", description: "Increases 1 ally's ATK by 15.5% + 1.3% for every 500 ATK you have, up to 10.4% for 3 turns." },
            { name: "Rebellion", description: "Increase 1 ally's CRIT by 9.3% + 1.6% for every 10% CRIT Wonder has, up to 6.4% for 3 turns." }
        ],
        note: "Provides consistent ATK buffs to allies, especially effective for low HP allies."
    },
    "Yamata-no-Orochi": {
	"icon": "https://cdn.imgchest.com/files/7kzcaxeod57.png",
		"rarity": 5,
		"element": "Ice",
        uniqueSkill: {
            name: "Screams of Sacrifice III",
            description: "Increases CRIT Rate by 17.5%. At the start of battle, gains 3 stacks of [Screams of Sacrifice]. Gains 1 stack of [Screams of Sacrifice] at the end of your turn. When using the signature skill, if you have 3 stacks of [Screams of Sacrifice], then consumes 3 stacks of [Screams of Sacrifice] to inflict all foes with Freeze for 3 turns, and increases all foes' TECHNICAL dmg taken by 25% for 3 turns."
        },
        mainSkill: {
            name: "Blizzard",
            description: "Deals 100.0% ATK Ice dmg to all foes, with a 100% base chance to inflict all foes with Freeze for 2 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deal 360% ATK as Ice dmg to 1 foe."
        },
        recommended: [
            { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
            { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
            { name: "Pinpoint", description: "Increases critical damage by 7%/10%/13%/16.2%." },
            { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
            { name: "Ice Boost", description: "Increases Ice damage by 4.7%/6.7%/8.7%/10.8%." }
        ],
        note: null
    },
    "Kohryu": {
	"icon": "https://cdn.imgchest.com/files/45xcv8kgzj7.png",
		"rarity": 5,
		"element": "Psychokinesis",
        uniqueSkill: {
            name: "Lord of Auspiciousness III",
            description: "Increases ATK by 29.1%. Works when not active: Gains 1 stack of [Four Symbols] when allies deal different elemental damage, up to 4 stacks. At the start of your turn, if you have at least 4 stacks of [Four Symbols], then consumes all [Four Symbols] to gain [Four Symbols' Power]: Increases own ATK by 30% and all allies' ATK by 15%, then evolves your signature skill for 2 turns."
        },
        mainSkill: {
            name: "Devious Strike",
            description: "Deals 101.4% ATK Psy dmg to all foes. Evolved: Deals 135.0% ATK Psy dmg to all foes. There is a 35.0% base chance to inflict all foes with Dizzy for 2 turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deals 180.0% ATK as Psy dmg to all foes."
        },
        recommended: [],
        note: null
    },
    "Sraosha": {
	"icon": "https://cdn.imgchest.com/files/yq9c3vbnw64.png",
		"rarity": 5,
		"element": "Bless",
        uniqueSkill: {
            name: "Listener of Sin III",
            description: "Increases ATK by 29.1%. At the start of battle, gains 3 stacks of [God's Ear] for 3 turns, up to 3 stacks. When allies use [HIGHLIGHT], gains 1 stack of [God's Ear]. additionally gains 1 stack of [God's Ear] when Bless allies use [HIGHLIGHT]. When using the signature skill, consumes all [God's Ear], each stack increases Bless dmg taken by 6% for 2 turns. If [God's Ear] reaches 3 stacks, additionally decreases foes' DEF when taking Bless damage by 25%."
        },
        mainSkill: {
            name: "Absolute Obedience",
            description: "Deals 200% ATK Bless dmg to 1 foe. Increases their [HIGHLIGHT] dmg taken by 30% for 1 turn."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deals 90.0% ATK Bless dmg to all foes and increase their dmg taken by 19.6% for 2 turns."
        },
        recommended: [
            { name: "Rakunda", description: "Decrease DEF of 1 foe by 38.8% for 3 turns." },
            { name: "Auto-Mataru", description: "Increase ATK for all allies by 4.2%/6.0%/7.9%/9.8% at the start of battle for 2 turns or until persona change." },
            { name: "Speed Master", description: "Increases SPD by 6/9/12/15 and decreases DEF by 0%/4%/8%/12%." },
            { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
            { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
            { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
            { name: "Pinpoint", description: "Increases critical damage by 7%/10%/13%/16.2%." },
            { name: "Bless Boost", description: "Increases Bless damage by 4.7%/6.7%/8.7%/10.8%." }
        ],
        note: "Can gain [God's Ear] stacks just by being in the party, not necessarily in the front line."
    },
    "Vasuki": {
	"icon": "https://cdn.imgchest.com/files/4jdcv629o94.png",
		"rarity": 5,
		"element": "Gun",
        uniqueSkill: {
            name: "Serpent of the Sky and Earth III",
            description: "Increase EHR by 34.9%. At the start of battle, gains 5 stacks of [Stare]. When allies add debuff effects with their skills, gains 1 stack of [Stare] for yourself (up to 5 stacks, 1 stack per ally per turn). When using the signature skill, if you have 5 stacks of [Stare], consumes all [Stare] to increase the damage effect taken by the main target of the skill by 15% and gain 1 stack of [Serpent's Bite]."
        },
        mainSkill: {
            name: "Endless Bind",
            description: "Increases the enemy's dmg taken by 16.0% and gains 1 stack of [Serpent's Bite] (up to 2 stacks). Effect lasts for 3 turns. [Serpent's Bite]: Each turn, the highest ATK Wonder deals 12.8% ATK Psy dmg to the target (maximum 300% of Wonder ATK)."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deals 90.0% ATK Gun dmg to all foes and increase their dmg taken by 19.6% for 2 turns."
        },
        recommended: [],
        note: null
    },
    "Chernobog": {
	"icon": "https://cdn.imgchest.com/files/yxkczqvqaa7.png",
		"rarity": 5,
		"element": "Physical",
        uniqueSkill: {
            name: "Deadly Silence III",
            description: "Increases EHR by 34.9%. [Nightmare] decreases Effect RES by 15% and DEF by 10% for 2 turns. Under [Nightmare], increases enemies' Phys dmg taken by 8% for 1 turn. Additionally increases Phys dmg taken stacks by 1 after the enemy takes 3 hits of Phys damage, up to 3 stacks, each stack counts down independently."
        },
        mainSkill: {
            name: "Painful Judgement",
            description: "Deals 40.0% ATK Phys dmg to 1 enemy 3 times, inflicts the enemy with [Nightmare], and there is a 9% base chance to inflict Fear."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deals 90.0% ATK Phys dmg to all foes and increase their dmg taken by 19.6% for 2 turns."
        },
        recommended: [
            { name: "Auto-Mataru", description: "Increase ATK for all allies by 4.2%/6.0%/7.9%/9.8% at the start of battle for 2 turns or until persona change." },
            { name: "Speed Master", description: "Increases SPD by 6/9/12/15 and decreases DEF by 0%/4%/8%/12%." },
            { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
            { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
            { name: "Pinpoint", description: "Increases critical damage by 7%/10%/13%/16.2%." },
            { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
            { name: "Phys Boost", description: "Increase Physical damage by 4.7%/6.7%/8.7%/10.8%." }
        ],
        note: null
    },
    "Shiva": {
	"icon": "https://cdn.imgchest.com/files/4apc5vqv3k4.png",
		"rarity": 5,
		"element": "Psychokinesis",
        uniqueSkill: {
            name: "Karma Reversal III",
            description: "Increases ATK by 29.1%. Gains 1 stack of [Wisdom] at the start of turn, up to 3 stacks. Consumes all [Wisdom] when using the signature skill and triggers the following effects based on the amount consumed: 1 Stack: Increases this damage by 33%. 2 stacks: Decreases all foes' DEF by 45% for 1 turn. 3 Stacks: Increases all foes' Psy dmg CRIT Rate taken by 18% for 1 turn."
        },
        mainSkill: {
            name: "Dance of Destruction",
            description: "Deals 90.0% ATK Psy dmg to all foes and consumes all stacks of [Wisdom] and trigger the effects of [Karma Reversal]."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deals 90.0% ATK Psy dmg to all foes and increase their dmg taken by 19.6% for 2 turns."
        },
        recommended: [
            { name: "Auto-Mataru", description: "Increase ATK for all allies by 4.2%/6.0%/7.9%/9.8% at the start of battle for 2 turns or until persona change." },
            { name: "Speed Master", description: "Increases SPD by 6/9/12/15 and decreases DEF by 0%/4%/8%/12%." },
            { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
            { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
            { name: "Pinpoint", description: "Increases critical damage by 7%/10%/13%/16.2%." },
            { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
            { name: "Psy Boost", description: "Increase Psy damage by 4.7%/6.7%/8.7%/10.8%." }
        ],
        note: null
    },
    "Trumpeter": {
	"icon": "https://cdn.imgchest.com/files/yrgcn9b9984.png",
		"rarity": 5,
		"element": "Almighty",
        uniqueSkill: {
            name: "Trumpet of Destruction III",
            description: "Increases EHR by 34.9%. When using a Persona skill against an enemy, if the number of debuff effects on the target is 15 or more, increases your EHR by 50% for 2 turns and increases the enemy's dmg taken by 6.5% for 2 turns. After adding debuff effects to the enemy, decreases all foes' DEF by 12% for 2 turns."
        },
        mainSkill: {
            name: "Wave of Despair",
            description: "12.7% of base chance to put all foes into [Despair] status. [Despair]: Unable to act. SP is deducted every turn and dies after a few turns."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deals 45.0% ATK Almighty dmg to all foes and increase their dmg taken by 19.6% for 2 turns."
        },
        recommended: [
            { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." },
            { name: "Ambient Aid", description: "Increase ailment accuracy by 9.1%/13%/16.9% when it rains." }
        ],
        note: null
    },
    "Okuninushi": {
		"icon": "https://cdn.imgchest.com/files/49zc2vevq3y.png",
		"rarity": 5,
		"element": "Psychokinesis",
        uniqueSkill: {
            name: "Regent's Majesty II",
            description: "Increases CRIT Rate by 12.5%. After dealing damage with a Persona skill, increases foes' Psy dmg taken by 8.5% for 3 turns, up to 3 stacks. Increases Psy damage by 10% when attacking foes with this debuff."
        },
        mainSkill: {
            name: "Mental Wave",
            description: "Deals 88.0% ATK Psy dmg to all foes. Increases dmg dealt by 20% if the foe is inflicted with Mental Ailments. Additionally increases dmg dealt by 15% if the foe is weak to Psy."
        },
        highlight: {
            name: "HIGHLIGHT",
            description: "Deals 180.0% ATK as Psy dmg to all foes."
        },
        recommended: [
            { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
            { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
            { name: "Pinpoint", description: "Increases critical damage by 7%/10%/13%/16.2%." },
            { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
            { name: "Phys Boost", description: "Increase Physical damage by 4.7%/6.7%/8.7%/10.8%." }
        ],
        note: null
    },
	"Zaou-Gongen": {
		"icon": "https://cdn.imgchest.com/files/7mmc9nqnpv7.png",
		"rarity": 5,
		"element": "Fire",
    uniqueSkill: {
        name: "Three Ages' Salvation III",
        description: "Increases ATK by 29.1%. After dealing damage with a Persona skill, gives self and the highest ATK Single-target/Multi-target ally [Undying Truth] for 3 turns. [Undying Truth]: When dealing 4 hits of damage with skills, increases own ATK by 12% and dmg dealt by 10%."
    },
    mainSkill: {
        name: "Fury Incarnate",
        description: "Deals 45.0% ATK Fire dmg to 1 foe 4 times. Inflicts the foe with [Trauma] for 3 turns. During [Trauma], each time the target takes 1 hit of Fire dmg, increases their CRIT dmg taken by 3%, for 2 turns, up to 8 stacks."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deal 360% ATK as Fire dmg to 1 foe."
    },
    recommended: [
        { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
        { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
        { name: "Pinpoint", description: "Increases critical damage by 7%/10%/13%/16.2%." },
        { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
        { name: "Fire Boost", description: "Increases Fire damage by 4.7%/6.7%/8.7%/10.8%." }
    ],
    note: null
},
"Alice": {
		"icon": "https://cdn.imgchest.com/files/4apc5vqv884.png",
		"rarity": 5,
		"element": "Curse",
    uniqueSkill: {
        name: "Curse of Rebirth III",
        description: "Increases EHR by 34.9%. Increases all foes' Curse dmg taken by 18%. After any ally uses Curse skills, increases Alice's EHR and ATK by 12.0% for 2 turns, up to 3 stacks."
    },
    mainSkill: {
        name: "Die For Me!",
        description: "Increases all enemies' Curse DMG Taken by 17.5% + 2% for every 50% EHR you have, up to 10% for 2 turns. There is a high chance of insta-kill to enemies under 50% HP. The lower the HP, the higher the chance."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deals 90.0% ATK Curse dmg to all foes and increase their dmg taken by 19.6% for 2 turns."
    },
    recommended: [
        { name: "Tarukaja", description: "Increases 1 ally's ATK by 15.5% + 1.3% for every 500 ATK you have, up to 10.4% for 3 turns." },
        { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." },
        { name: "Ambient Aid", description: "Increase ailment accuracy by 9.1%/13%/16.9% when it rains." }
    ],
    note: "Base accuracy 80% + Accuracy Enhancement IV 16.2% + Gloomy Sky 16.9% + Core Passive 34.9% + My Palace 2.3% = 150.3%, which can reach the 'Die For Me!' upper limit of 10%. (Gloomy Sky application unconfirmed)"
},
"Bishamonten": {
		"icon": "https://cdn.imgchest.com/files/4jdcv626q84.png",
		"rarity": 5,
		"element": "Nuclear",
    uniqueSkill: {
        name: "Furious Umbrella III",
        description: "Increases CRIT Rate by 17.5%. After using a skill on enemies, increases the main target's Nuke dmg taken by 10% for 1 turn for every Elemental Ailment they have, up to 3 stacks. All other enemies gain 40% of this effect."
    },
    mainSkill: {
        name: "The King's Surrender",
        description: "Deals 180.0% ATK Nuke dmg to 1 foe. Increases dmg dealt to enemy inflicted with Elemental Ailments by 25%."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deal 360% ATK as Nuke dmg to 1 foe."
    },
    recommended: [
        { name: "Rakunda", description: "Decrease DEF of 1 foe by 38.8% for 3 turns." },
        { name: "Auto-Mataru", description: "Increase ATK for all allies by 4.2%/6.0%/7.9%/9.8% at the start of battle for 2 turns or until persona change." },
        { name: "Speed Master", description: "Increases SPD by 6/9/12/15 and decreases DEF by 0%/4%/8%/12%." }
    ],
    note: "The core passive effect is applied even when using Rakunda."
},
"Thor": {
		"icon": "https://cdn.imgchest.com/files/7ogcbxrwbry.png",
		"rarity": 5,
		"element": "Electric",
    uniqueSkill: {
        name: "Thunder God's Majesty III",
        description: "Increases CRIT DMG by 34.9%. When allies use Elec Persona skill / Follow Up / HIGHLIGHT / Theurgy, gains 1 stack of [Thunder God's Might] for 2 turns, up to 3 stacks. When you deal damage with a Persona skill, if you have 3 stacks of [Thunder God's Might], increases all enemies' Elec dmg taken by 12% and Elec CRIT dmg taken by 20% for 2 turns."
    },
    mainSkill: {
        name: "Heavenly Thunder",
        description: "Deals 112.0% ATK Elec dmg to all foes. When [Thunder God's Might] is at 3 stacks, there is an 80% base chance to inflict all enemies with Shock for 2 turns."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deals 180.0% ATK as Elec dmg to all foes."
    },
    recommended: [
        { name: "Shock Boost", description: "Increase Shock accuracy by 8.8%/12.5%/16.3%/20.3%." },
        { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." },
        { name: "Ambient Aid", description: "Increase ailment accuracy by 9.1%/13%/16.9% when it rains." },
        { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
        { name: "Pinpoint", description: "Increases critical damage by 7%/10%/13%/16.2%." },
        { name: "Elec Boost", description: "Increases Electric damage by 4.7%/6.7%/8.7%/10.8%." }
    ],
    note: null
},
"Yurlungur": {
		"icon": "https://cdn.imgchest.com/files/46acqg83qm7.png",
		"rarity": 5,
		"element": "Electric",
    uniqueSkill: {
        name: "Holy Pond's Serpent I",
        description: "Increases CRIT DMG by 17.4%. Increases all foes' CRIT DMG taken by 14%, if they are inflicted with Shock, additionally increases the effect by 9%."
    },
    mainSkill: {
        name: "Elec Break",
        description: "Suppress innate Electric resistances of 1 foe for 3 turns."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deals 90.0% ATK as Elec dmg to all foes and increase their DMG Taken by 19.6% for 2 turns."
    },
    recommended: [
        { name: "Ziodyne", description: "Deals 121.7% ATK Electric dmg to 1 foe and has a 67.6% chance of inflicting Shock for 2 turns." },
        { name: "Shock Boost", description: "Increase Shock accuracy by 8.8%/12.5%/16.3%/20.3%." },
        { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." },
        { name: "Ambient Aid", description: "Increase ailment accuracy by 9.1%/13%/16.9% when it rains." }
    ],
    note: null
},
"Throne": {
		"icon": "https://cdn.imgchest.com/files/4gdcxmwov34.png",
		"rarity": 5,
		"element": "Fire",
    uniqueSkill: {
        name: "Otherworldly Saint III",
        description: "Increases ATK by 29.1%. At the start of battle, gains 8 stacks of [Tinder]. Gains 1 stack of [Tinder] when allies inflict Elemental Ailments, gains 1 additional stack of [Tinder] if that Elemental Ailment was Burn for 3 turns, up to 10 stacks, each skill can give up to 2 stacks of [Tinder]. When using a Persona skill on allies, if [Tinder] is at 4 stacks or above, consumes all [Tinder] and increases all allies' dmg dealt by 1% for 2 turns, with a 75% base chance to inflict 1 random enemy with Burn."
    },
    mainSkill: {
        name: "Fire of Purification",
        description: "Increases all allies' ATK by 8% + 0.5% for every 500 ATK you have, up to 4% for 3 turns. Gives the main target [Fire of Purification] for 3 turns. [Fire of Purification]: After dealing Persona skill damage to foes, there is a 75% base chance to inflict 1 random foe with burn."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Increase all allies dmg dealt by 29.5% for 2 turns."
    },
    recommended: [
        { name: "Burn Boost", description: "Increases Burn accuracy by 8.8%/12.5%/16.3%." },
        { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." },
        { name: "Ambient Aid", description: "Increase ailment accuracy by 9.1%/13%/16.9% when it rains." }
    ],
    note: "Adopted in a form used for characters who require burn effects (e.g., Mio)."
},
"Lamia": {
		"icon": "https://cdn.imgchest.com/files/yq9c3vb25l4.png",
		"rarity": 5,
		"element": "Fire",
    uniqueSkill: {
        name: "Gorgons Greed I",
        description: "Increases EHR by 13%. Increases EHR by 40% when inflicting Burn. After inflicting Burn, increases all allies' ATK by 12% for 2 turns."
    },
    mainSkill: {
        name: "Fire Offering",
        description: "Deals 150.0% ATK Fire dmg to 1 foe, with a 50% base chance to inflict Burn, double the chance if there are no enemies inflicted with Burn."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deals 90.0% ATK Fire dmg to all foes and increase their dmg taken by 19.6% for 2 turns."
    },
    recommended: [
        { name: "Maragidyne", description: "Deals 60.8% ATK Fire damage to all foes and has a 33.8% chance of inflicting Burn for 2 turns." },
        { name: "Burn Boost", description: "Increases Burn accuracy by 8.8%/12.5%/16.3%." },
        { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." },
        { name: "Ambient Aid", description: "Increase ailment accuracy by 9.1%/13%/16.9% when it rains." }
    ],
    note: null
},
"Baphomet": {
		"icon": "https://cdn.imgchest.com/files/yrgcn9babe4.png",
		"rarity": 5,
		"element": "Fire",
    uniqueSkill: {
        name: "Demonic Melter III",
        description: "Increases ATK by 24.9%. After dealing Persona skill damage to foes inflicted with Burn, increases all enemies' Fire dmg taken by 29% for 1 turn."
    },
    mainSkill: {
        name: "Overheat",
        description: "Deals 67.5% ATK Fire damage to all enemies and has a 100% fixed chance of inflicting Burn to the main target for 2 turns."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deals 180.0% ATK as Fire dmg to all foes."
    },
    recommended: [
        { name: "El Jihad", description: "Deals 64.8% ATK Electric dmg to all foes and has a 36.0% chance of inflicting Shock for 2 turns." },
        { name: "Shock Boost", description: "Increase Shock accuracy by 8.8%/12.5%/16.3%/20.3%." },
        { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." },
        { name: "Ambient Aid", description: "Increase ailment accuracy by 9.1%/13%/16.9% when it rains." },
        { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." }
    ],
    note: "Triggers core passive effect on enemies already in Burn state with [Overheat: Fire damage or El Jihad: Shock addition]."
},
"Yoshitsune": {
		"icon": "https://cdn.imgchest.com/files/4nec8lbn2m4.png",
		"rarity": 5,
		"element": "Physical",
    uniqueSkill: {
        name: "Destined Streak III",
        description: "Increases CRIT DMG by 34.9%. At the start of battle, gains 4 stacks of [Ambush]. When using the signature skill there is a 60% chance to gain [Ambush], each stack increases own ATK by 9% for 2 turns, up to 8 stacks. Increases the CRIT Rate of the signature skill by 30% when reaching 8 stacks."
    },
    mainSkill: {
        name: "Hassou Tobi",
        description: "Deals 15.0% ATK Phys dmg to all foes 8 times. For every 1 foe, increases skill damage by 5%, up to 15%."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deals 180.0% ATK as Phys dmg to all foes."
    },
    recommended: [
        { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
        { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
        { name: "Pinpoint", description: "Increases critical damage by 7%/10%/13%/16.2%." },
        { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
        { name: "Phys Boost", description: "Increase Physical damage by 4.7%/6.7%/8.7%/10.8%." },
        { name: "Attack Master", description: "Increase ATK by 8.5%/12.1%/15.7%/19.6% at the start of battle for 2 turns or until persona change." }
    ],
    note: null
},
"Neko Shogun": {
		"icon": "https://cdn.imgchest.com/files/739cxkbg9x7.png",
		"rarity": 5,
		"element": "Psychokinesis",
    uniqueSkill: {
        name: "Have a Dried Fish I",
        description: "Increases EHR by 15%. At the start of battle, increases all allies' EHR by 10%, increases the EHR for the ally with the highest EHR by 14% for 2 turns."
    },
    mainSkill: {
        name: "Hunter's Code",
        description: "Increases 1 ally's damage dealt by 18.0% + 1.0% for every 20% Effect Hit Rate the ally has to a maximum of 6.0% for 3 turns."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Increase all allies dmg dealt by 29.5% for 2 turns."
    },
    recommended: [
        { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." }
    ],
    note: null
},
"Mithras": {
		"icon": "https://cdn.imgchest.com/files/7lxcpxjrnv7.png",
		"rarity": 3,
		"element": "Nuclear",
    uniqueSkill: {
        name: "Burning Sun's Blessing II",
        description: "Increases HP by 11.6%. When using a skill on allies, increases their DEF by 14.5% for 2 turns. If they are above 50% HP, increases the effect by 50%."
    },
    mainSkill: {
        name: "Marakukaja",
        description: "Increase all allies DEF by 16.3% + 2.7% for every 500 DEF Wonder has to a maximum of 10.8% for 3 turns."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Grants all allies 48.6% ATK + 1471 shield for 2 turns."
    },
    recommended: [
        { name: "Rakukaja", description: "Increase 1 ally's DEF by 23.3% + 3.9% for every 500 DEF Wonder has to a maximum of 15.6% for 3 turns." },
        { name: "Rebellion", description: "Increase 1 ally's CRIT by 9.3% + 1.6% for every 10% CRIT Wonder has, up to 6.4% for 3 turns." },
        { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." }
    ],
    note: null
},
"Sandalphon": {
		"icon": "https://cdn.imgchest.com/files/yvdcwnzgppy.png",
		"rarity": 5,
		"element": "Almighty",
    uniqueSkill: {
        name: "Higher Protection III",
        description: "Increases DEF by 43.6%. When Sandalphon is present, increases all shielded allies' DEF by 42%, gains 25% of this effect when not present. Decreases the HP cost to 15% when using the signature skill."
    },
    mainSkill: {
        name: "Devoted Protection",
        description: "Grants all allies 25.5% ATK + 771 shield. Increases the main target's dmg dealt when they have shield by 20.4% for 2 turns."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Grants all allies 48.6% ATK + 1471 shield for 2 turns."
    },
    recommended: [
        { name: "Shield Boost", description: "Increase Shield Effect by 4.2%/6.0%/7.8%/9.7%." },
        { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
        { name: "Regenerate", description: "Restores 1.9%/2.7%/3.5% of Max HP at the start of each turn." }
    ],
    note: "Can provide 10.5% defense bonus through backup deployment."
},
"Isis": {
		"icon": "https://cdn.imgchest.com/files/y8xcnqv2884.png",
		"rarity": 3,
		"element": "Electric",
    uniqueSkill: {
        name: "Ankh of Abundance I",
        description: "Increases HP by 8.7%. When granting healing effects, the target recovers HP equal to 5% ATK for 2 turns starting next turn."
    },
    mainSkill: {
        name: "Diarama",
        description: "Restore HP equal to 35.6% ATK + 1077 to 1 ally."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Restore HP equal to 48.6% ATK + 1471 to all allies."
    },
    recommended: [
        { name: "Healing Boost", description: "Increases Healing Effect by 4.2%/6.0%/7.8%/9.7%." },
        { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
        { name: "Defense Boost", description: "Increases DEF by 8.8%/12.5%/16.3%." },
        { name: "Damage Reduction", description: "Decrease damage taken by 4.7%/6.7%/8.7%/10.8%." }
    ],
    note: "Attack enhancement applies to healing values. (Low priority due to limited impact)"
},
"Titania": {
		"icon": "https://cdn.imgchest.com/files/7mmc9nq35w7.png",
		"rarity": 5,
		"element": "Nuclear",
    uniqueSkill: {
        name: "Fairy Queen's Disturbance III",
        description: "Increases Healing Effect by 18%. After healing with a Persona skill, there is a 77.5% base chance to inflict 1 random enemy with a random Elemental Ailment and decreases their DEF by 9% for 2 turns."
    },
    mainSkill: {
        name: "Invigorating Caress",
        description: "Restores 18.0% ATK + 544 HP to all allies. Increases Healing Effect by 25% to allies under 50% HP. Restores 4 SP to all allies."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Restore HP equal to 48.6% ATK + 1471 HP to all allies."
    },
    recommended: [
        { name: "Healing Boost", description: "Increases Healing Effect by 4.2%/6.0%/7.8%/9.7%." },
        { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
        { name: "Defense Boost", description: "Increases DEF by 8.8%/12.5%/16.3%." },
        { name: "Damage Reduction", description: "Decrease damage taken by 4.7%/6.7%/8.7%/10.8%." }
    ],
    note: "Attack enhancement applies to healing values. (Low priority due to limited impact)"
},
"Parvati": {
		"icon": "https://cdn.imgchest.com/files/45xcv8pqee7.png",
		"rarity": 4,
		"element": "Psychokinesis",
    uniqueSkill: {
        name: "Mother Earth's Protection III",
        description: "Increases HP by 21.2%. After using Healing skill, increases the healed allies' ATK by 16% and DEF by 10.5% for 1 turn."
    },
    mainSkill: {
        name: "Diarama",
        description: "Restore HP equal to 35.6% ATK + 1077 to 1 ally."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Restore HP equal to 48.6% ATK + 1471 HP to all allies."
    },
    recommended: [
        { name: "Healing Boost", description: "Increases Healing Effect by 4.2%/6.0%/7.8%/9.7%." },
        { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
        { name: "Defense Boost", description: "Increases DEF by 8.8%/12.5%/16.3%." },
        { name: "Damage Reduction", description: "Decrease damage taken by 4.7%/6.7%/8.7%/10.8%." }
    ],
    note: "Core passive effect also triggers on healing through highlights. Attack enhancement applies to healing values. (Low priority due to limited impact)"
},
"Siegfried": {
		"icon": "https://cdn.imgchest.com/files/y2pck53d687.png",
		"rarity": 5,
		"element": "Physical",
    uniqueSkill: {
        name: "Fearless Hero III",
        description: "Increases ATK by 29.1%. At the start of battle, gains Dragon Blood. When using Phys skills, increases ATK by 10% for 3 turns. When using the main skill, boosts the effect of Dragon Blood, additionally increases damage by 28% and CRIT DMG by 28% when using Phys skills."
    },
    mainSkill: {
        name: "Dragon Slayer",
        description: "Deals 95.0% ATK Phys dmg to all enemies. If you don't have Dragon Blood, gain Dragon Blood. If you have Dragon Blood, boost Dragon Blood and refresh its duration."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deals 180.0% ATK as Phys dmg to all foes."
    },
    recommended: [],
    note: "Gains Dragon Blood at the start of battle just by being in the party."
},
"Apsaras": {
		"icon": "https://cdn.imgchest.com/files/46acqg83bg7.png",
		"rarity": 2,
		"element": "Ice",
    uniqueSkill: {
        name: "Gentle Chant I",
        description: "Increases DEF by 8.7%. When using a skill on allies, increases their DEF by 15.4% for 2 turns."
    },
    mainSkill: {
        name: "Rebellion",
        description: "Increase 1 ally's CRIT by 9.3% + 1.6% for every 10% CRIT Wonder has, up to 6.4% for 3 turns."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Increases all allies dmg dealt by 29.5% for 2 turns."
    },
    recommended: [
        { name: "Auto-Maraku", description: "Increase DEF for all allies by 6.5%/9.1%/11.8%/14.7% at the start of battle for 2 turns or until persona change." },
        { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
        { name: "Speed Master", description: "Increases SPD by 6/9/12/15 and decreases DEF by 0%/4%/8%/12%." }
    ],
    note: null
},
"King Frost": {
		"icon": "https://cdn.imgchest.com/files/y8xcnqv2q84.png",
		"rarity": 5,
		"element": "Ice",
    uniqueSkill: {
        name: "Frozen Adjudication III",
        description: "Increases DEF by 37.4%. After giving Shield to allies, increases the main target's DEF by 25% and Ice dmg bonus by 15% for 2 turns."
    },
    mainSkill: {
        name: "Snow Aegis",
        description: "Grants all allies 22.8% ATK + 690 shield for 2 turns. When the Shield is active increases DEF by 30%."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Grants all allies 48.6% ATK + 1471 shield for 2 turns."
    },
    recommended: [
        { name: "Auto-Maraku", description: "Increase DEF for all allies by 6.5%/9.1%/11.8%/14.7% at the start of battle for 2 turns or until persona change." },
        { name: "Shield Boost", description: "Increase Shield Effect by 4.2%/6.0%/7.8%/9.7%." },
        { name: "Speed Master", description: "Increases SPD by 6/9/12/15 and decreases DEF by 0%/4%/8%/12%." }
    ],
    note: null
},
"Lilith": {
		"icon": "https://cdn.imgchest.com/files/yd5cem9ggk4.png",
		"rarity": 5,
		"element": "Almighty",
    uniqueSkill: {
        name: "Midnight Seduction III",
        description: "Increases ATK by 29.1%. When using Ice, Wind, or Curse skill, increases that Elemental dmg by 30% and dmg resistance by 10% for 2 turns. When Lilith uses Ice, Wind, or Curse skill, evolves the signature skill, makes it deal 1 hit of that element's damage, heavily increases skill damage and gains 15% PEN."
    },
    mainSkill: {
        name: "Carnage Allure",
        description: "Deals 25.0% ATK Almighty dmg to all foes, then deals 37.5% ATK Curse dmg. Skill can evolves into [Ice] [Wind] [Curse] form: Deals 25.0% ATK Almighty dmg, then deals 101.0% ATK (Ice, Wind, Curse) dmg."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deals 90.0% ATK as Almighty dmg to all foes."
    },
    recommended: [
        { name: "Auto-Mataru", description: "Increase ATK for all allies by 4.2%/6.0%/7.9%/9.8% at the start of battle for 2 turns or until persona change." },
        { name: "Speed Master", description: "Increases SPD by 6/9/12/15 and decreases DEF by 0%/4%/8%/12%." }
    ],
    note: "Rarely used except for increasing Almighty damage with Wonder weapons like Mechanical Arbiter."
},
"Anubis": {
		"icon": "https://cdn.imgchest.com/files/yd5cem9awm4.png",
		"rarity": 5,
		"element": "Curse",
    uniqueSkill: {
        name: "Judge of Souls III",
        description: "Increases ATK by 29.1%. When dealing Bless damage, gains 2 stacks of Bless and there is a 50% fixed chance to inflict 1 stack of Curse to the main target. When dealing Curse damage the main target gains 2 stacks of Curse and there is a 50% fixed chance for you to gain 1 stack of Bless. Increases ATK by 27% when attacking enemies with Curse."
    },
    mainSkill: {
        name: "Afterlife Judgement",
        description: "Deals 165.0% ATK Curse dmg to 1 foe. When using this skill, each stack of Bless on you or each stack of Curse on the target increases DMG Dealt by 10%, up to 4 stacks."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deal 360% ATK as Curse dmg to 1 foe."
    },
    recommended: [
        { name: "Demonic Decree", description: "Deals 142.5% ATK Curse damage to 1 foe and inflicts 2 stack(s) of Curse." },
        { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." }
    ],
    note: "Curse damage is affected by Almighty damage."
},
"Pazuzu": {
		"icon": "https://cdn.imgchest.com/files/yq9c3vblje4.png",
		"rarity": 4,
		"element": "Curse",
    uniqueSkill: {
        name: "Eternal Curse II",
        description: "Increases ATK by 17.7%. After attacking foes with a Persona skill, there is a 60% fixed chance to inflict 1 stack of Curse on the main target. Immediately triggers all of the main target's Curse stacks."
    },
    mainSkill: {
        name: "Maciga",
        description: "Deals 66.5% ATK Curse dmg to all foes and has a chance to inflict 1 stack of Curse."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deals 180.0% ATK as Curse dmg to all foes."
    },
    recommended: [
        { name: "Demonic Decree", description: "Deals 142.5% ATK Curse damage to 1 foe and inflicts 2 stack(s) of Curse." },
        { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
        { name: "Agidyne", description: "Deals 121.7% ATK Fire damage to 1 foe and has a 67.6% chance of inflicting Burn for 2 turns." },
        { name: "Burn Boost", description: "Increases Burn accuracy by 8.8%/12.5%/16.3%." },
        { name: "Accuracy Boost", description: "Increase ailment accuracy by 7%/10%/13%/16.2%/19.4%." },
        { name: "Ambient Aid", description: "Increase ailment accuracy by 9.1%/13%/16.9% when it rains." }
    ],
    note: "Operated with burn effects through Agidyne + Curse damage settlement through core passive. Curse effect damage is affected by Almighty damage."
},
"Belphegor": {
		"icon": "https://cdn.imgchest.com/files/4jdcv62eab4.png",
		"rarity": 4,
		"element": "Ice",
    uniqueSkill: {
        name: "Cold Wave of Sloth II",
        description: "Increases Effect RES by 17%. After using a Persona skill on enemies, increases the main target's Ice dmg taken by 14.4% for 2 turns. If they are under 50% HP, additionally increases effect by 40%."
    },
    mainSkill: {
        name: "Rakunda",
        description: "Decrease DEF of 1 enemy by 38.8% for 3 turns."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deals 90.0% ATK Ice dmg to all foes and increase their dmg taken by 19.6% for 2 turns."
    },
    recommended: [
        { name: "Diamond Dust", description: "Deals 129.5% ATK Ice damage to 1 foe and has a 72.0% chance of inflicting Freeze for 2 turns." },
        { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
        { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
        { name: "Pinpoint", description: "Increases critical damage by 7%/10%/13%/16.2%." },
        { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
        { name: "Ice Boost", description: "Increases Ice damage by 4.7%/6.7%/8.7%/10.8%." }
    ],
    note: null
},
"Yatagarasu": {
		"icon": "https://cdn.imgchest.com/files/7lxcpxj5v27.png",
		"rarity": 3,
		"element": "Fire",
    uniqueSkill: {
        name: "Sun's Wrath III",
        description: "Increases ATK by 17.5%. When you don't have any debuffs, increases ATK by 30% and Fire dmg dealt by 16.5%."
    },
    mainSkill: {
        name: "Maragion",
        description: "Deals 60.8% ATK Fire dmg to all foes and has a 33.8% chance of inflicting Burn for 2 turns."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deals 180.0% ATK as Fire dmg to all foes."
    },
    recommended: [
        { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
        { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
        { name: "Pinpoint", description: "Increases critical damage by 7%/10%/13%/16.2%." },
        { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
        { name: "Fire Boost", description: "Increases Fire damage by 4.7%/6.7%/8.7%/10.8%." }
    ],
    note: "Adopted when granting Fire damage through Wonder."
},
"Girimehkala": {
		"icon": "https://cdn.imgchest.com/files/y2pck53eml7.png",
		"rarity": 3,
		"element": "Physical",
    uniqueSkill: {
        name: "Elephant's Gaze II",
        description: "Increases Effect Resistance by 17.4%. All allies take 20% less damage from enemies with any debuffs."
    },
    mainSkill: {
        name: "Matarunda",
        description: "Decreases ATK of all foes by 18.1% for 3 turns."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Grants all allies 48.6% ATK + 1471 shield for 2 turns."
    },
    recommended: [],
    note: "Adopted when damage reduction effects are needed."
},
"Cu Chulainn": {
		"icon": "https://cdn.imgchest.com/files/7kzcax9k657.png",
		"rarity": 5,
		"element": "Physical",
    uniqueSkill: {
        name: "Roaring Hound III",
        description: "Increases CRIT Rate by 17.5%. Inflicts [Mortal Barb] when dealing Critical, detonates this the next time you use the signature skill, additionally increases skill damage by 87% ATK. When detonating, there is a low chance of insta-kill."
    },
    mainSkill: {
        name: "Gae Bulg",
        description: "Deals 174.0% ATK Phys dmg to 1 foe, increases CRIT Rate by 4% for every stack of debuffs the foe has, up to 20% Crit Rate Bonus."
    },
    highlight: {
        name: "HIGHLIGHT",
        description: "Deal 360% ATK as Phys dmg to 1 foe."
    },
    recommended: [
        { name: "Attack Boost", description: "Increase ATK by 5.8%/8.3%/10.8%/13.5%/16.2%." },
        { name: "Apt Pupil", description: "Increases Critical Rate by 3.5%/5.0%/6.5%/8.1%." },
        { name: "Pinpoint", description: "Increases critical damage by 7%/10%/13%/16.2%." },
        { name: "Magic Ability", description: "Increase damage dealt by 4.7%/6.7%/8.7%/10.8%/13.0%." },
        { name: "Phys Boost", description: "Increase Physical damage by 4.7%/6.7%/8.7%/10.8%." }
    ],
    note: null
}
};

	
function handleDeepLink() {
    try {
        const params = new URLSearchParams(window.location.search);
        const guideType = params.get('guide');
        const guideName = params.get('name');

        if (!guideType || !guideName) return;

        let title = "P5X Wiki Guide";
        let description = "A comprehensive guide for Persona 5: The Phantom X.";
        let imageUrl = "https://cdn.imgchest.com/files/p7bwcnq5gq7.png"; // Default image
        let color = "#ff0000";

        if (guideType === 'persona' && personaData[guideName]) {
            const data = personaData[guideName];
            title = `Persona Guide: ${guideName}`;
            imageUrl = data.icon || imageUrl;
            description = `Rarity: ${'★'.repeat(data.rarity)}\nElement: ${data.element || 'N/A'}\n\n` +
                          `▶ Unique Skill: ${data.uniqueSkill.name}\n${data.uniqueSkill.description}\n\n` +
                          `▶ Main Skill: ${data.mainSkill.name}\n${data.mainSkill.description}`;
        } else if (guideType === 'confidant' && confidantData[guideName]) {
            const data = confidantData[guideName];
            title = `Confidant Guide: ${guideName}`;
            imageUrl = data.icon || imageUrl;
            description = `Key Unlocks:\n` +
                          (data.guide.skills || []).map(s => `• Rank ${s[0]}: ${s[1]}`).slice(0, 5).join('\n');
        }

        const head = document.head;
        const metaTags = [
            { property: 'og:title', content: title },
            { property: 'og:description', content: description },
            { property: 'og:image', content: imageUrl },
            { property: 'og:url', content: window.location.href },
            { property: 'og:type', content: 'website' },
            { name: 'theme-color', content: color }
        ];

        metaTags.forEach(tagInfo => {
            const meta = document.createElement('meta');
            for (const key in tagInfo) {
                meta.setAttribute(key, tagInfo[key]);
            }
            head.appendChild(meta);
        });
    } catch (e) {
        console.error("Error handling deep link:", e);
    }
}
handleDeepLink();
        document.addEventListener('DOMContentLoaded', () => {
            const guideCards = document.querySelectorAll('.guide-card');
            const contentPanels = document.querySelectorAll('.guide-content-panel');
const menuToggle = document.getElementById('menu-toggle');
const sidebar = document.getElementById('collapsible-sidebar');
const overlay = document.getElementById('main-overlay');
const quickNavOverlay = document.getElementById('quick-nav-overlay');
const quickNavCards = document.querySelectorAll('.quick-nav-card');
const wasDeepLinkHandled = processDeepLink();



function processDeepLink() {
    const params = new URLSearchParams(window.location.search);
    const guideType = params.get('guide');
    const guideName = params.get('name');
    const quickNavOverlay = document.getElementById('quick-nav-overlay');

    // If no guide parameters, return false to signal nothing was handled.
    if (!guideType || !guideName) {
        return false;
    }

    // 1. Hide the Quick Navigation Overlay
    if (quickNavOverlay) {
        quickNavOverlay.classList.add('hidden');
    }

    // 2. Activate the correct guide section panel
    const targetGuideId = `guide-${guideType}`;
    // Use a more specific selector to target only the sidebar cards
    const targetSidebarCard = document.querySelector(`.sidebar-nav .guide-card[data-target="${targetGuideId}"]`);
    
    if (targetSidebarCard) {
        targetSidebarCard.click();
    } else {
        // If the guide doesn't exist, we didn't handle the link.
        return false; 
    }

    // 3. Open the specific modal for the item
    setTimeout(() => {
        if (guideType === 'personas' && typeof openPersonaModal === 'function') {
            openPersonaModal(guideName);
        } else if (guideType === 'confidants' && typeof openConfidantModal === 'function') {
            openConfidantModal(guideName);
        }
    }, 100);

    // Return true to signal the deep link was successfully handled.
    return true;
}

		    const sidebarGuideCards = document.querySelectorAll('.sidebar-nav .guide-card');
    sidebarGuideCards.forEach(card => {
        card.addEventListener('click', () => {
            const targetId = card.dataset.target;

            // Deactivate all sidebar cards and content panels
            sidebarGuideCards.forEach(c => c.classList.remove('active'));
            contentPanels.forEach(p => p.classList.remove('active'));

            // Activate the clicked card and its corresponding panel
            card.classList.add('active');
            const targetPanel = document.getElementById(targetId);
            if (targetPanel) {
                targetPanel.classList.add('active');
            }
        });
    });

    if (!wasDeepLinkHandled && sidebarGuideCards.length > 0) {
        sidebarGuideCards[0].click();
    }

        processDeepLink();
		

function showCopyNotification(button) {
    if (button.classList.contains('copied')) return; // Prevent re-triggering
    button.classList.add('copied');
    setTimeout(() => {
        button.classList.remove('copied');
    }, 2000);
}

function setupCopyButton(buttonId, guideType) {
    const copyBtn = document.getElementById(buttonId);
    if (copyBtn) {
        copyBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            const guideName = this.dataset.name;
            if (!guideName) return;

            // The 'guideType' parameter here now directly matches the panel ID structure
            const baseUrl = window.location.origin + window.location.pathname;
            const shareUrl = `${baseUrl}?guide=${guideType}&name=${encodeURIComponent(guideName)}`;

            const textArea = document.createElement("textarea");
            textArea.value = shareUrl;
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                document.execCommand('copy');
                showCopyNotification(this);
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
            }
            document.body.removeChild(textArea);
        });
    }
}

// Updated the calls to use the plural form matching the section IDs
setupCopyButton('copyPersonaGuideBtn', 'personas');
setupCopyButton('copyConfidantGuideBtn', 'confidants');

function selectInitialGuide(targetId) {
    if (!targetId) return;

    const targetSidebarCard = document.querySelector(`.sidebar-nav .guide-card[data-target="${targetId}"]`);
    if (targetSidebarCard) {
        targetSidebarCard.click();
    }

    quickNavOverlay.classList.add('hidden');
}

quickNavCards.forEach(card => {
    card.addEventListener('click', () => {
        const targetId = card.dataset.target;
        selectInitialGuide(targetId);
    });
});


async function generateAndCopyImage(type, name, button) {
    const originalButtonText = button.textContent;
    button.textContent = 'Generating...';
    button.disabled = true;

    // Created a temporary, off-screen container for our card
    const cardContainer = document.createElement('div');
    cardContainer.id = 'temp-image-card-container';
    cardContainer.style.position = 'absolute';
    cardContainer.style.left = '-9999px';
    cardContainer.style.top = '0';
    document.body.appendChild(cardContainer);

    let elementToCapture;

    if (type === 'persona') {
        elementToCapture = buildPersonaCard(name);
    } else if (type === 'confidant') {
        const activeTab = document.querySelector('#confidantTabsContainer .tab.active');
        const tabType = activeTab ? activeTab.dataset.tab : 'guide';
        elementToCapture = buildConfidantCard(name, tabType);
    }
    
    if (!elementToCapture) {
        console.error("Could not build the image card. Data might be missing.");
        document.body.removeChild(cardContainer);
        button.textContent = 'Error!';
        setTimeout(() => {
            button.textContent = originalButtonText;
            button.disabled = false;
        }, 2000);
        return;
    }
    
    cardContainer.appendChild(elementToCapture);
    
    try {
        const canvas = await html2canvas(elementToCapture, {
            backgroundColor: null,
            useCORS: true,
            scale: 1.5,
        });

        canvas.toBlob(async (blob) => {
            if (blob) {
                try {
                    await navigator.clipboard.write([new ClipboardItem({ 'image/png': blob })]);
                    showCopyNotification(button); // Reuse your existing notification
                    button.textContent = 'Copied!';
                } catch (err) {
                    console.error('Failed to copy image to clipboard:', err);
                    button.textContent = 'Error!';
                }
            }
        }, 'image/png');

    } catch (error) {
        console.error('Image generation failed:', error);
        button.textContent = 'Error!';
    } finally {
        document.body.removeChild(cardContainer);
        setTimeout(() => {
            button.textContent = originalButtonText;
            button.disabled = false;
        }, 2000);
    }
}

function buildPersonaCard(personaName) {
    const data = personaData[personaName];
    if (!data) return null;

    const card = document.createElement('div');
    card.style.cssText = `
        background: linear-gradient(145deg, #1e1e1e, #101010);
        width: 850px;
        padding: 20px;
        color: #fff;
        font-family: 'Crimson Text', serif;
        border: 2px solid var(--primary-color, #ff0000);
        border-radius: 15px;
        box-sizing: border-box;
    `;

    const stars = '★'.repeat(data.rarity || 0).padEnd(5, '☆');

    card.innerHTML = `
        <div style="display: flex; align-items: center; border-bottom: 2px solid var(--primary-color, #ff0000); padding-bottom: 15px; margin-bottom: 20px;">
            <img src="${data.icon}" style="width: 100px; height: 100px; object-fit: contain; margin-right: 20px; filter: drop-shadow(0 0 5px var(--primary-color, #ff0000));">
            <div style="flex-grow: 1;">
                <h2 style="font-family: 'Cinzel', serif; font-size: 2.5rem; margin: 0; color: var(--primary-color, #ff0000);">${personaName}</h2>
                <p style="font-size: 1.5rem; color: #f6e05e; margin: 0;">${stars}</p>
            </div>
        </div>
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
            <div>
                <h4 style="font-family: 'Cinzel', serif; font-size: 1.3rem; color: var(--primary-color, #ff0000); border-bottom: 1px solid var(--primary-color-dark, #cc0000); padding-bottom: 5px; margin-bottom: 10px;">UNIQUE SKILL: ${data.uniqueSkill.name}</h4>
                <p style="font-size: 0.9rem; line-height: 1.6;">${data.uniqueSkill.description}</p>
                <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-top: 20px;">
                    <div style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 8px;">
                        <strong style="display: block; margin-bottom: 5px;">${data.mainSkill.name}</strong>
                        <p style="font-size: 0.9rem; margin:0;">${data.mainSkill.description}</p>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 8px;">
                        <strong style="display: block; margin-bottom: 5px;">${data.highlight.name}</strong>
                        <p style="font-size: 0.9rem; margin:0;">${data.highlight.description}</p>
                    </div>
                </div>
            </div>
            <div>
                <h4 style="font-family: 'Cinzel', serif; font-size: 1.3rem; color: var(--primary-color, #ff0000); border-bottom: 1px solid var(--primary-color-dark, #cc0000); padding-bottom: 5px; margin-bottom: 10px;">RECOMMENDED SKILLS</h4>
                ${data.recommended.map(skill => `
                    <div style="margin-bottom: 10px;">
                        <strong style="display: block;">${skill.name}</strong>
                        <p style="font-size: 0.9rem; color: #ccc; margin:0;">${skill.description}</p>
                    </div>
                `).join('')}
            </div>
        </div>
        <div style="text-align: right; margin-top: 20px; font-size: 12px; color: rgba(255,255,255,0.4); font-family: 'Inter', sans-serif;">
            mcburnr.github.io/p5xwiki.html
        </div>
    `;
    return card;
}

function buildConfidantCard(confidantName, tabType) {
    const data = confidantData[confidantName];
    if (!data) return null;

    const card = document.createElement('div');
    card.style.cssText = `
        background: linear-gradient(145deg, #1e1e1e, #101010);
        width: 1000px;
        padding: 20px;
        color: #fff;
        font-family: 'Crimson Text', serif;
        border: 2px solid var(--primary-color, #ff0000);
        border-radius: 15px;
        box-sizing: border-box;
    `;
    
    let contentHTML = '';
    if (tabType === 'guide' && data.guide) {
        // Multi-column layout for the 'guide' tab
        contentHTML = `
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                <div>
                    ${(data.guide.skills && data.guide.skills.length > 0) ? `
                        <h4 style="font-family: 'Cinzel', serif; font-size: 1.2rem; color: var(--primary-color, #ff0000); margin-bottom: 10px;">Confidant Skills</h4>
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                            ${data.guide.skills.map(row => `<tr style="border-bottom: 1px solid #444;"><td style="padding: 6px; vertical-align: top;"><b>Rank ${row[0]}</b></td><td style="padding: 6px;">${row[1]}</td></tr>`).join('')}
                        </table>` : ''
                    }
                     ${(data.guide.rankUpChoices && data.guide.rankUpChoices.length > 0) ? `
                        <h4 style="font-family: 'Cinzel', serif; font-size: 1.2rem; color: var(--primary-color, #ff0000); margin-top: 20px; margin-bottom: 10px;">Rank Up Choices</h4>
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                             ${data.guide.rankUpChoices.map(row => `<tr style="border-bottom: 1px solid #444;"><td style="padding: 6px; vertical-align: top;"><b>${row[0]}</b></td><td style="padding: 6px;">${row[1]}</td></tr>`).join('')}
                        </table>` : ''
                    }
                </div>
                <div>
                    ${(data.guide.hangouts && data.guide.hangouts.length > 0) ? `
                        <h4 style="font-family: 'Cinzel', serif; font-size: 1.2rem; color: var(--primary-color, #ff0000); margin-bottom: 10px;">Hangout Choices</h4>
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                             ${data.guide.hangouts.map(row => `<tr style="border-bottom: 1px solid #444;"><td style="padding: 6px; vertical-align: top;"><b>${row[0]}</b></td><td style="padding: 6px;">${row[1]}</td></tr>`).join('')}
                        </table>` : ''
                    }
                    ${(data.guide.gifts && data.guide.gifts.length > 0) ? `
                        <h4 style="font-family: 'Cinzel', serif; font-size: 1.2rem; color: var(--primary-color, #ff0000); margin-top: 20px; margin-bottom: 10px;">Gifts</h4>
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                            <thead><tr style="text-align: left; color: var(--primary-color, #ff0000);"><th style="padding: 6px;">Gift</th><th style="padding: 6px;">Points</th></tr></thead>
                            <tbody>${data.guide.gifts.map(row => `<tr style="border-bottom: 1px solid #444;"><td style="padding: 6px;">${row[0]}</td><td style="padding: 6px;">${row[1]}</td></tr>`).join('')}</tbody>
                        </table>` : ''
                    }
                </div>
            </div>`;
    } 
    else if (tabType === 'levels' && data.levels) {
        // Single-column layout for the 'levels' tab
        contentHTML = `
            <h4 style="font-family: 'Cinzel', serif; font-size: 1.2rem; color: var(--primary-color, #ff0000); margin-bottom: 10px;">Levels & Unlocks</h4>
            <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                 <thead><tr style="text-align: left; color: var(--primary-color, #ff0000);"><th style="padding: 8px;">Rank</th><th style="padding: 8px;">Unlock</th><th style="padding: 8px;">Effect</th></tr></thead>
                 <tbody>
                    ${data.levels.map(row => `<tr style="border-bottom: 1px solid #444;"><td style="padding: 8px; vertical-align: top;"><b>${row[0]}</b></td><td style="padding: 8px;">${row[1]}</td><td style="padding: 8px;">${row[2] || ''}</td></tr>`).join('')}
                 </tbody>
            </table>`;
    }

    card.innerHTML = `
        <div style="display: flex; align-items: center; border-bottom: 2px solid var(--primary-color, #ff0000); padding-bottom: 15px; margin-bottom: 20px;">
            <img src="${data.icon}" style="width: 100px; height: 100px; object-fit: cover; object-position: top; border-radius: 50%; margin-right: 20px; border: 3px solid var(--primary-color, #ff0000);">
            <h2 style="font-family: 'Cinzel', serif; font-size: 2.5rem; margin: 0; color: var(--primary-color, #ff0000);">${confidantName}</h2>
        </div>
        ${contentHTML}
        <div style="text-align: right; margin-top: 20px; font-size: 12px; color: rgba(255,255,255,0.4); font-family: 'Inter', sans-serif;">
            mcburnr.github.io/p5xwiki.html
        </div>
    `;
    return card;
}


const copyPersonaImageBtn = document.getElementById('copyPersonaImageBtn');
if (copyPersonaImageBtn) {
    copyPersonaImageBtn.addEventListener('click', function() {
        const personaName = document.getElementById('copyPersonaGuideBtn').dataset.name;
        if (personaName) {
            generateAndCopyImage('persona', personaName, this);
        }
    });
}

const copyConfidantImageBtn = document.getElementById('copyConfidantImageBtn');
if (copyConfidantImageBtn) {
    copyConfidantImageBtn.addEventListener('click', function() {
        const confidantName = document.getElementById('copyConfidantGuideBtn').dataset.name;
        if (confidantName) {
            generateAndCopyImage('confidant', confidantName, this);
        }
    });
}

function toggleSidebar() {
    menuToggle.classList.toggle('open');
    sidebar.classList.toggle('open');
    overlay.classList.toggle('show');
    document.body.classList.toggle('sidebar-open');
}

menuToggle.addEventListener('click', toggleSidebar);
overlay.addEventListener('click', toggleSidebar);

sidebar.querySelectorAll('.guide-card').forEach(card => {
    card.addEventListener('click', () => {
        if (sidebar.classList.contains('open')) {
            toggleSidebar();
        }
    });
});


            guideCards.forEach(card => {
                card.addEventListener('click', () => {
                    const targetId = card.dataset.target;

                    guideCards.forEach(c => c.classList.remove('active'));
                    contentPanels.forEach(p => p.classList.remove('active'));

                    card.classList.add('active');
                    const targetPanel = document.getElementById(targetId);
                    if (targetPanel) {
                        targetPanel.classList.add('active');
                    }
                });
            });

            if (guideCards.length > 0) {
                guideCards[0].click();
            }

            const accordionTriggers = document.querySelectorAll('.accordion-trigger');
            accordionTriggers.forEach(trigger => {
                trigger.addEventListener('click', () => {
                    const parentItem = trigger.parentElement;
                    parentItem.classList.toggle('active');
                });
            });
			
const calculatorSection = document.getElementById('guide-calculator');
if (calculatorSection) {
    const inputs = {
        char_atk: document.getElementById('char_atk'), weapon_atk: document.getElementById('weapon_atk'), atk_percent: document.getElementById('atk_percent'), atk_flat: document.getElementById('atk_flat'),
        atk_multiplier: document.getElementById('atk_multiplier'), elemental_multiplier: document.getElementById('elemental_multiplier'), enemy_damage_taken: document.getElementById('enemy_damage_taken'),
        enemy_def: document.getElementById('enemy_def'), add_def_coeff: document.getElementById('add_def_coeff'), pierce_rate: document.getElementById('pierce_rate'), def_reduction: document.getElementById('def_reduction'), winded: document.getElementById('winded'),
        crit_rate: document.getElementById('crit_rate'), crit_effect: document.getElementById('crit_effect'),
        skill_coeff: document.getElementById('skill_coeff'),
        weakness_coeff: document.getElementById('weakness_coeff'),
        final_dmg_bonus: document.getElementById('final_dmg_bonus'),
    };
    const outputs = {
        atk_power: document.getElementById('atk_power_result'), dmg_bonus: document.getElementById('dmg_bonus_result'), enemy_def: document.getElementById('enemy_def_result'), crit_calc: document.getElementById('crit_calc_result'),
        skill_coeff: document.getElementById('skill_coeff_result'),
        weakness_coeff: document.getElementById('weakness_coeff_result'),
        final_dmg_bonus: document.getElementById('final_dmg_bonus_result'),
        total_damage: document.getElementById('total_damage_result'),
    };

function calculateDamage() {
    const getVal = (id) => parseFloat(inputs[id].value) || 0;
    const getPercent = (id) => (parseFloat(inputs[id].value) || 0) / 100;

    // A: Attack Power
    const attackPower = (getVal('char_atk') + getVal('weapon_atk')) * (1 + getPercent('atk_percent')) + getVal('atk_flat');
    outputs.atk_power.textContent = attackPower.toFixed(2);

    // B: Damage Bonus
    const damageBonus = 1 + getPercent('atk_multiplier') + getPercent('elemental_multiplier') + getPercent('enemy_damage_taken');
    outputs.dmg_bonus.textContent = (damageBonus * 100).toFixed(2) + '%';
    
    // C: Enemy Defense
    const windedMultiplier = inputs.winded.value === 'winded' ? 0.88 : 1;
    const defenseCoefficient = (1 + getPercent('add_def_coeff')) * (1 - getPercent('pierce_rate')) - getPercent('def_reduction');
    const effectiveEnemyDef = getVal('enemy_def') * defenseCoefficient * windedMultiplier;
    const defenseDivisor = effectiveEnemyDef + 1400;
    const defenseMultiplier = defenseDivisor <= 0 ? 1 : 1 - (effectiveEnemyDef / defenseDivisor);
    outputs.enemy_def.textContent = defenseMultiplier.toFixed(4);

    // D: Critical Calculation (Corrected Average Damage Formula)
    const critRate = getPercent('crit_rate');
    const critEffect = getPercent('crit_effect');
    // (critRate * critEffect) is the damage contribution from crits.
    const critMultiplier = (1 - critRate) + (critRate * critEffect);
    outputs.crit_calc.textContent = (critMultiplier * 100).toFixed(2) + '%';

    // E: Skill Coefficient
    const skillCoeff = getPercent('skill_coeff');
    outputs.skill_coeff.textContent = (skillCoeff * 100).toFixed(2) + '%';

    // F: Weakness Coefficient
    const weaknessCoeff = parseFloat(inputs.weakness_coeff.value) || 1;
    outputs.weakness_coeff.textContent = (weaknessCoeff * 100).toFixed(2) + '%';

    // G: Final Damage Bonus
    const finalDmgBonus = 1 + getPercent('final_dmg_bonus');
    outputs.final_dmg_bonus.textContent = (finalDmgBonus * 100).toFixed(2) + '%';

    // Final Damage Calculation
    const baseDamage = attackPower * damageBonus * defenseMultiplier * critMultiplier * skillCoeff * weaknessCoeff * finalDmgBonus;
    const minDamage = baseDamage * 0.95;
    const maxDamage = baseDamage * 1.05;
    outputs.total_damage.textContent = `${Math.round(minDamage).toLocaleString()} ~ ${Math.round(maxDamage).toLocaleString()}`;
}

    Object.values(inputs).forEach(input => {
        if(input) input.addEventListener('input', calculateDamage);
    });
    
    calculateDamage();
}

const personaSection = document.getElementById('guide-personas');
if (personaSection) {
    const filtersWrapper = document.getElementById('persona-filters-wrapper');
    const filterPanelToggle = document.getElementById('filter-panel-toggle');
    const filterPositionToggle = document.getElementById('filter-position-toggle');

    // Function to apply the layout based on the 'position' string ('top' or 'side')
    const applyFilterLayout = (position) => {
        if (position === 'side') {
            personaSection.classList.remove('layout-top');
            personaSection.classList.add('layout-side');
        } else { // Default to 'top'
            personaSection.classList.remove('layout-side');
            personaSection.classList.add('layout-top');
        }
    };

    // --- On Page Load ---
    // 1. Get saved position from localStorage, defaulting to 'top' if not found.
    const savedPosition = localStorage.getItem('personaFilterPosition') || 'top';
    applyFilterLayout(savedPosition);

    // 2. Start with the filter panel collapsed by default.
    filtersWrapper.classList.add('collapsed');

    // --- Event Listeners ---
    // 3. Toggle the 'collapsed' class to show/hide the filter panel.
    filterPanelToggle.addEventListener('click', () => {
        filtersWrapper.classList.toggle('collapsed');
    });

    // 4. Toggle the layout class on the section and save the new preference.
    filterPositionToggle.addEventListener('click', () => {
        const isCurrentlySide = personaSection.classList.contains('layout-side');
        const newPosition = isCurrentlySide ? 'top' : 'side';
        applyFilterLayout(newPosition);
        localStorage.setItem('personaFilterPosition', newPosition);
    });
}

const personaGridContainer = document.getElementById('persona-grid-container');
const personaModal = document.getElementById('personaModal');
const personaModalTitle = document.getElementById('personaModalTitle');
const personaModalBody = document.querySelector('.persona-modal-body');
const closePersonaBtn = document.getElementById('closePersonaBtn');

const elementIcons = {
    "Physical": "https://cdn.imgchest.com/files/49zc2vk9qdy.png",
    "Gun": "https://cdn.imgchest.com/files/7kzcax8wja7.png",
    "Fire": "https://cdn.imgchest.com/files/4apc5vlwkq4.png",
    "Ice": "https://cdn.imgchest.com/files/y2pck5a5dv7.png",
    "Electric": "https://cdn.imgchest.com/files/739cxk5kjp7.png",
    "Wind": "https://cdn.imgchest.com/files/46acqgvgpe7.png",
    "Psychokinesis": "https://cdn.imgchest.com/files/yvdcwn9gkjy.png",
    "Nuclear": "https://cdn.imgchest.com/files/7ogcbxpwrxy.png",
    "Bless": "https://cdn.imgchest.com/files/4apc5vlpbe4.png",
    "Curse": "https://cdn.imgchest.com/files/4jdcv6zebw4.png",
    "Almighty": "https://cdn.imgchest.com/files/yq9c3va2w54.png"
};


function openPersonaModal(personaName) {
    const data = personaData[personaName];
    if (!data) return;
	document.getElementById('copyPersonaGuideBtn').dataset.name = personaName;
    personaModalTitle.textContent = personaName;

    let modalHTML = `
        <div class="persona-detail-card">
            <h4>Unique Skill: ${data.uniqueSkill.name}</h4>
            <p>${data.uniqueSkill.description}</p>
        </div>
        <div class="persona-skill-grid">
            <div class="persona-skill-item">
                <strong>${data.mainSkill.name}</strong>
                <p>${data.mainSkill.description}</p>
            </div>
            <div class="persona-skill-item">
                <strong>${data.highlight.name}</strong>
                <p>${data.highlight.description}</p>
            </div>
        </div>
        <div class="persona-detail-card persona-recommended-skills">
            <h4>Recommended Skills</h4>
            ${data.recommended.map(skill => `
                <div class="skill">
                    <strong>${skill.name}</strong>
                    <p>${skill.description}</p>
                </div>
            `).join('')}
        </div>
    `;
    
    if (data.note) {
        modalHTML += `<div class="persona-footer-note">${data.note}</div>`;
    }

    personaModalBody.innerHTML = modalHTML;
    personaModal.classList.add('show');
}

function closePersonaModal() {
    personaModal.classList.remove('show');
}

if (personaGridContainer) {
Object.keys(personaData).forEach(name => {
    const data = personaData[name];
    const card = document.createElement('div');
    card.className = 'persona-card';
    card.dataset.name = name;

    // Add a rarity-specific class to the card for styling
    if (data.rarity) {
        card.classList.add(`rarity-${data.rarity}`);
    }

    // Generate the HTML for the stars display
    let starsHTML = '';
    if (data.rarity) {
        for (let i = 1; i <= 5; i++) {
            // Add 'filled' class to stars up to the rarity level
            starsHTML += `<span class="persona-rarity-star ${i <= data.rarity ? 'filled' : ''}">★</span>`;
        }
    }

    const iconUrl = data.icon || 'https://cdn.imgchest.com/files/49zc2bpgvny.png';

    // The check for `data.element && elementIcons[data.element]` ensures this only runs if the data exists.
    card.innerHTML = `
        <div class="persona-card-icon-wrapper">
            <img src="${iconUrl}" alt="${name}" class="persona-card-icon">
            ${(data.element && elementIcons[data.element]) ? `
            <div class="persona-element-icon-container">
                <img src="${elementIcons[data.element]}" alt="${data.element}" class="persona-element-icon element-${data.element.toLowerCase().replace(/\s+/g, '')}">
            </div>
            ` : ''}
        </div>
        <div class="persona-card-details">
            <div class="persona-rarity">${starsHTML}</div>
            <div class="persona-card-name">${name}</div>
        </div>
    `;
    card.addEventListener('click', () => openPersonaModal(name));
    personaGridContainer.appendChild(card);
});
}

closePersonaBtn.addEventListener('click', closePersonaModal);
personaModal.addEventListener('click', (e) => {
    if (e.target === personaModal) {
        closePersonaModal();
    }
});

// START: Final Persona Filtering Logic with Element Filter
const personaSearchInput = document.getElementById('personaSearchInput');
const rarityFilter = document.getElementById('rarityFilter');
const rarityValueLabel = document.getElementById('rarityValue');
const rarityTicksContainer = document.querySelector('.rarity-ticks');
const elementFilterGrid = document.getElementById('element-filter-grid');
const allPersonaCards = document.querySelectorAll('#persona-grid-container .persona-card');

let currentElementFilter = 'All'; // State for the element filter

function filterPersonas() {
    // This query now runs every time, ensuring it always has the latest cards
    const allPersonaCards = document.querySelectorAll('#persona-grid-container .persona-card');
    if (!personaSearchInput || !rarityFilter || allPersonaCards.length === 0) return;

    const searchTerm = personaSearchInput.value.toLowerCase();
    const selectedRarity = parseInt(rarityFilter.value);

    allPersonaCards.forEach(card => {
        const data = personaData[card.dataset.name];
        // This check prevents errors if data is missing for a card
        if (!data) { 
            card.style.display = 'none'; 
            return; 
        }

        const rarityMatch = (selectedRarity === 6) || (data.rarity === selectedRarity);
        // This check safely handles personas without an element property
        const elementMatch = (currentElementFilter === 'All') || (data.element && data.element === currentElementFilter);

        let searchableText = card.dataset.name.toLowerCase();
        if(data.element) { searchableText += ` ${data.element.toLowerCase()}`; }
        if (data.uniqueSkill) { searchableText += ` ${data.uniqueSkill.name.toLowerCase()} ${data.uniqueSkill.description.toLowerCase()}`; }
        if (data.mainSkill) { searchableText += ` ${data.mainSkill.name.toLowerCase()} ${data.mainSkill.description.toLowerCase()}`; }
        
        const searchMatch = searchableText.includes(searchTerm);

        // Use 'grid' or 'block' for display, depending on your container's style
        card.style.display = (rarityMatch && searchMatch && elementMatch) ? 'block' : 'none';
    });
}

function updateActiveState() {
    if (!rarityFilter || !rarityValueLabel || !rarityTicksContainer) return;
    const value = parseInt(rarityFilter.value);
    
    // Update label with multiple stars
    if (value === 6) {
        rarityValueLabel.textContent = 'All';
    } else {
        rarityValueLabel.innerHTML = `<span class="font-bold text-yellow-400">${'★'.repeat(value)}</span>`;
    }

    // Update active tick indicator
    rarityTicksContainer.querySelectorAll('.rarity-tick').forEach(tick => {
        // Remove all possible active classes first
        tick.classList.remove('active-tick', 'active-tick-2', 'active-tick-3', 'active-tick-4', 'active-tick-5');
        
        const tickValue = parseInt(tick.dataset.value);
        if (tickValue === value) {
            // Add the correct specific active class
            if (value === 6) {
                tick.classList.add('active-tick'); // Generic active class for 'All'
            } else {
                tick.classList.add(`active-tick-${tickValue}`);
            }
        }
    });
}

        async function loadNewsArticles() {
            const NEWS_DATA_URL = 'https://api.allorigins.win/raw?url=https%3A%2F%2Fpersona5x.com%2Fnews%2Fdata%2Fnews.txt';
            const NEWS_BASE_URL = "https://persona5x.com/news/details/";
            const container = document.getElementById('news-articles-container');
            if (!container) return;
            try {
                const response = await fetch(NEWS_DATA_URL);
                if (!response.ok) throw new Error('Network response was not ok');
                const rawText = await response.text();
                const cleanText = rawText.replace(/,\s*([}\]])/g, "$1");
                const newsData = JSON.parse(cleanText);
                const articles = newsData.news;
                if (!articles || articles.length === 0) {
                    container.innerHTML = '<p class="text-center text-xl">No news articles found.</p>';
                    return;
                }
                const articlesHTML = articles.map(article => {
                    const articleUrl = `${NEWS_BASE_URL}${article.link}`;
                    const articleDate = `${article.year}.${article.month}.${article.day}`;
                    const category = article.category.charAt(0).toUpperCase() + article.category.slice(1);
                    return `
                        <div class="news-accordion-item">
                            <button class="news-accordion-trigger" data-url="${articleUrl}">
                                <span class="news-title">${article.text}</span>
                                <div class="news-meta">
                                   <span class="news-category-badge">${category}</span>
                                   <span class="news-date">${articleDate}</span>
                                </div>
                            </button>
                            <div class="news-accordion-content"></div>
                        </div>
                    `;
                }).join('');
                container.innerHTML = articlesHTML;
                addNewsAccordionListeners();
            } catch (error) {
                console.error("Failed to fetch or display news list:", error);
                container.innerHTML = '<p class="text-center text-xl text-red-500">Failed to load news. Please try again later.</p>';
            }
        }

function addNewsAccordionListeners() {
    document.querySelectorAll('.news-accordion-trigger').forEach(trigger => {
        trigger.addEventListener('click', async () => {
            const item = trigger.parentElement;
            const contentArea = item.querySelector('.news-accordion-content');

            // If content is already loaded, just toggle the accordion
            if (item.classList.contains('loaded')) {
                item.classList.toggle('active');
                return;
            }

            // --- Fetch content on the first click ---
            const articleUrl = trigger.dataset.url;
            contentArea.innerHTML = '<p class="p-4 text-center">Loading article...</p>';
            item.classList.add('active'); // Show loading message while fetching

            try {
                const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(articleUrl)}`;
                const response = await fetch(proxyUrl);
                if (!response.ok) throw new Error('Network response was not ok');
                
                const htmlText = await response.text();
                
                const parser = new DOMParser();
                const doc = parser.parseFromString(htmlText, 'text/html');
                
                const articleContent = doc.querySelector('.newsDetailTextBox');

                if (articleContent) {
                    // Get the clean text content *before* adding the button
                    const textToCopy = articleContent.textContent.trim();
                    
                    // Set the article's HTML content
                    contentArea.innerHTML = articleContent.innerHTML;

                    // --- Create and add the new "Copy Article" button ---
                    const copyBtn = document.createElement('button');
                    copyBtn.textContent = 'Copy Article';
                    // Reuse existing button styles and add our new margin style
                    copyBtn.className = 'copy-guide-btn copy-article-btn'; 

                    copyBtn.addEventListener('click', (e) => {
                        e.stopPropagation(); // Prevent the accordion from closing
                        navigator.clipboard.writeText(textToCopy);
                        showCopyNotification(copyBtn); // Reuse your existing notification function
                    });

                    // Add the copy button to the top of the content area
                    contentArea.prepend(copyBtn);

                } else {
                    contentArea.innerHTML = '<p class="p-4 text-center text-red-500">Could not find article content.</p>';
                }
                
                item.classList.add('loaded'); // Mark as loaded so we don't fetch it again

            } catch (error) {
                console.error('Failed to fetch article content:', error);
                contentArea.innerHTML = '<p class="p-4 text-center text-red-500">Failed to load article content.</p>';
            }
        });
    });
}
loadNewsArticles(); 

// Add event listeners
if (personaSearchInput) {
    personaSearchInput.addEventListener('input', filterPersonas);
}
if (rarityFilter) {
    rarityFilter.addEventListener('input', () => {
        updateActiveState();
        filterPersonas();
    });
}
if (rarityTicksContainer) {
    rarityTicksContainer.addEventListener('click', (e) => {
        const target = e.target.closest('.rarity-tick');
        if (target && target.dataset.value) {
            rarityFilter.value = target.dataset.value;
            rarityFilter.dispatchEvent(new Event('input', { bubbles: true }));
        }
    });
}
if (elementFilterGrid) {
    elementFilterGrid.addEventListener('click', (e) => {
        const target = e.target.closest('.element-filter-btn');
        if (target && target.dataset.element) {
            elementFilterGrid.querySelectorAll('.element-filter-btn').forEach(btn => btn.classList.remove('active'));
            target.classList.add('active');
            currentElementFilter = target.dataset.element;
            filterPersonas();
        }
    });
}

updateActiveState();


            const confidantGridContainer = document.querySelector('#guide-confidants .confidant-grid-container');
            const confidantModal = document.getElementById('confidantModal');
            const confidantModalTitle = document.getElementById('confidantModalTitle');
            const closeConfidantBtn = document.getElementById('closeConfidantBtn');
            const confidantTabsContainer = document.getElementById('confidantTabsContainer');
            const confidantTabContentContainer = document.getElementById('confidantTabContentContainer');

function openConfidantModal(confidantName) {
                const data = confidantData[confidantName];
                if (!data) return;
    document.getElementById('copyConfidantGuideBtn').dataset.name = confidantName;

                confidantModalTitle.textContent = confidantName;

                confidantTabsContainer.innerHTML = `
                    <button class="tab active" data-tab="guide">Guide</button>
                    <button class="tab" data-tab="levels">Levels/Unlocks</button>
                `;
                
                let guideContentHTML = '<div class="confidant-guide-content">';
                if (data.guide) {
                    if(data.guide.notes && data.guide.notes.length > 0) {
                        guideContentHTML += `<div class="confidant-notes">${data.guide.notes}</div>`;
                    }
                    if(data.guide.skills && data.guide.skills.length > 0) {
                        guideContentHTML += `
                            <div class="confidant-guide-section">
                                <h4>Confidant Skills</h4>
                                <table class="confidant-table">
                                    <thead><tr><th>Rank</th><th>Ability</th><th>Description</th></tr></thead>
                                    <tbody>${data.guide.skills.map(row => `<tr><td>${row[0]}</td><td>${row[1]}</td><td>${row[2] || ''}</td></tr>`).join('')}</tbody>
                                </table>
                            </div>`;
                    }
                    if(data.guide.socialStats && data.guide.socialStats.length > 0) {
                        guideContentHTML += `
                            <div class="confidant-guide-section">
                                <h4>Social Stat Requirements</h4>
                                <table class="confidant-table">
                                    <thead><tr><th>Rank Up</th><th>Requirement</th></tr></thead>
                                    <tbody>${data.guide.socialStats.map(row => `<tr><td>${row[0]}</td><td>${row[1]}</td></tr>`).join('')}</tbody>
                                </table>
                            </div>`;
                    }
                    if(data.guide.requirements && data.guide.requirements.length > 0) {
                         guideContentHTML += `
                            <div class="confidant-guide-section">
                                <h4>Fusion Requirements</h4>
                                <table class="confidant-table">
                                    <thead><tr><th>Rank</th><th>Requirement</th></tr></thead>
                                    <tbody>${data.guide.requirements.map(row => `<tr><td>${row[0]}</td><td>${row[1]}</td></tr>`).join('')}</tbody>
                                </table>
                            </div>`;
                    }
                     if(data.guide.hangouts && data.guide.hangouts.length > 0) {
                         guideContentHTML += `
                            <div class="confidant-guide-section">
                                <h4>Hangout Choices</h4>
                                <table class="confidant-table">
                                    <thead><tr><th>Place</th><th>Dialog Options</th></tr></thead>
                                    <tbody>${data.guide.hangouts.map(row => `<tr><td>${row[0]}</td><td>${row[1]}</td></tr>`).join('')}</tbody>
                                </table>
                            </div>`;
                    }
                    if(data.guide.rankUpChoices && data.guide.rankUpChoices.length > 0) {
                         guideContentHTML += `
                            <div class="confidant-guide-section">
                                <h4>Confidant Rank Up Choices</h4>
                                <table class="confidant-table">
                                    <thead><tr><th>Rank</th><th>Dialog Options</th></tr></thead>
                                    <tbody>${data.guide.rankUpChoices.map(row => `<tr><td>${row[0]}</td><td>${row[1]}</td></tr>`).join('')}</tbody>
                                </table>
                            </div>`;
                    }
                     if(data.guide.gifts && data.guide.gifts.length > 0) {
                         guideContentHTML += `
                            <div class="confidant-guide-section">
                                <h4>Gifts</h4>
                                <table class="confidant-table">
                                    <thead><tr><th>Gift</th><th>First Time Points</th><th>Favorite Points</th><th>General Points</th><th>Cost</th></tr></thead>
                                    <tbody>${data.guide.gifts.map(row => `<tr><td>${row[0]}</td><td>${row[1]}</td><td>${row[2]}</td><td>${row[3]}</td><td>${row[4]}</td></tr>`).join('')}</tbody>
                                </table>
                            </div>`;
                    }
                }
                guideContentHTML += '</div>';

                // --- Build Levels Tab Content ---
                const levelsTable = `
                    <table class="confidant-table">
                        <thead><tr><th>Rank</th><th>Unlocks/Reward</th><th>Effect</th></tr></thead>
                        <tbody>${(data.levels || []).map(row => `<tr><td>${row[0]}</td><td>${row[1]}</td><td>${row[2] || ''}</td></tr>`).join('')}</tbody>
                    </table>`;

                // Set initial content
                confidantTabContentContainer.innerHTML = `
                    <div class="tab-content active" id="confidant-tab-guide">${guideContentHTML}</div>
                    <div class="tab-content" id="confidant-tab-levels">${levelsTable}</div>
                `;

                confidantModal.classList.add('show');

                // Add tab switching logic for the modal
                const tabs = confidantTabsContainer.querySelectorAll('.tab');
                tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        tabs.forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');

                        const tabName = tab.dataset.tab;
                        confidantTabContentContainer.querySelectorAll('.tab-content').forEach(content => {
                            content.classList.remove('active');
                        });
                        const targetContent = document.getElementById(`confidant-tab-${tabName}`);
                        if (targetContent) {
                            targetContent.classList.add('active');
                        }
                    });
                });
            }

            function closeConfidantModal() {
                confidantModal.classList.remove('show');
            }

            if (confidantGridContainer) {
                const confidantNames = Object.keys(confidantData);
                
                if (confidantNames.length > 0) {
                    confidantNames.forEach(name => {
                        const confidant = confidantData[name];
                        const card = document.createElement('div');
                        card.className = 'confidant-grid-card';
                        
                        card.innerHTML = `
                            <img src="${confidant.icon || 'https://cdn.imgchest.com/files/7w6c29mozey.png'}" alt="${name}" class="confidant-grid-icon">
                            <div class="confidant-grid-name">${name}</div>
                        `;

                        card.addEventListener('click', () => openConfidantModal(name));
                        confidantGridContainer.appendChild(card);
                    });
                }
            }
            
            closeConfidantBtn.addEventListener('click', closeConfidantModal);
            confidantModal.addEventListener('click', (e) => {
                if (e.target === confidantModal) {
                    closeConfidantModal();
                }
            });
// --- ARCANA CARD TABS ---
            const arcanaTabs = document.querySelectorAll('#guide-arcana .arcana-tab');
            const arcanaContents = document.querySelectorAll('#guide-arcana .arcana-tab-content');

            arcanaTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetId = `arcana-content-${tab.dataset.tab}`;

                    arcanaTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');

                    arcanaContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === targetId) {
                            content.classList.add('active');
                        }
                    });
                });
            });

            // --- ARCANA SEARCH BAR ---
            const arcanaSearchInput = document.getElementById('arcanaSearchInput');
            if (arcanaSearchInput) {
                arcanaSearchInput.addEventListener('input', () => {
                    const searchTerm = arcanaSearchInput.value.toLowerCase();
                    const allArcanaCards = document.querySelectorAll('#guide-arcana .arcana-card');

                    allArcanaCards.forEach(card => {
                        const cardText = card.textContent.toLowerCase();
                        if (cardText.includes(searchTerm)) {
                            // Use 'flex' as it's the default display style for these cards
                            card.style.display = 'flex';
                        } else {
                            card.style.display = 'none';
                        }
                    });
                });
            }
});

// === DYNAMIC FORUM SCRIPT V10 (Consolidated & Stable) ===
document.addEventListener('DOMContentLoaded', () => {
    // Define elements from their original locations in the HTML
    const controlsWrapper = document.getElementById('guide-controls-wrapper');
    const sidebar = document.getElementById('guide-forum-sidebar');
    const forumContainer = document.getElementById('guide-forum-container');
    if (!forumContainer) return;

    // --- Element Selectors ---
    const forumTitle = document.getElementById('forum-title');
    const searchInput = document.getElementById('guide-search-input');
    const sortViewBtn = document.getElementById('sort-view-btn');
    const sortViewModal = document.getElementById('sort-view-modal');
    const tagFiltersContainer = document.getElementById('guide-tag-filters');
    const postListContainer = document.getElementById('guide-post-list');
    const paginationControls = document.getElementById('guide-pagination-controls');
    const postViewerContainer = document.getElementById('guide-post-viewer');
    const contentSplit = document.getElementById('guide-content-split');
    const quickNavModal = document.getElementById('quick-nav-modal');
    const categoriesContainer = document.getElementById('sidebar-categories-container'); // New container

    let allGuides = [];
    let currentPage = 1;
    let userPreferences = {
        forum: '', search: '', tags: new Set(),
        sort: 'date-desc', view: 'gallery', loading: 'side',
        collapse: 'expanded', sidebar: 'show', guidesPerPage: 10,
    };

    const placeholderIcon = "https://cdn.imgchest.com/files/yq9c3k5n2q4.png";
    const forumStructure = [
        { name: "Builds", icon: placeholderIcon, forums: [{ name: "Asia Builds", icon: placeholderIcon }, { name: "Global Builds", icon: placeholderIcon }] },
        { name: "Gameplay", icon: placeholderIcon, forums: [{ name: "Bosses", icon: placeholderIcon }, { name: "Guild Bosses", icon: placeholderIcon }, { name: "Sos-Astrolabe", icon: placeholderIcon }, { name: "Exploration", icon: placeholderIcon }, { name: "Events", icon: placeholderIcon }] },
        { name: "Other", icon: placeholderIcon, forums: [{ name: "Resources", icon: placeholderIcon }, { name: "Datamines", icon: placeholderIcon }] }
    ];

function handleResponsiveLayout() {
    const paginationControls = document.getElementById('guide-pagination-controls');
    const desktopParent = document.getElementById('guide-controls-content');
    const mobileParent = document.getElementById('guide-forum-main');
    
    // Find the search bar container to insert pagination after it on desktop
    const searchInputContainer = desktopParent ? desktopParent.querySelector('.relative.w-full.mb-4') : null;

    if (!paginationControls || !desktopParent || !mobileParent || !searchInputContainer) return;

    if (window.innerWidth <= 768) {
        // MOBILE VIEW: Move pagination to the main container to be styled at the bottom
        if (paginationControls.parentElement !== mobileParent) {
            mobileParent.appendChild(paginationControls);
        }
    } else {
        // DESKTOP VIEW: Move pagination back to its original spot in the filter controls
        if (paginationControls.parentElement !== desktopParent) {
            searchInputContainer.insertAdjacentElement('afterend', paginationControls);
        }
    }
}


async function initializeForum() {
    // Add the mobile header HTML dynamically if it doesn't exist
    if (!document.getElementById('mobile-forum-header')) {
        const mainForum = document.getElementById('guide-forum-main');
        if (mainForum) {
            const mobileHeaderHTML = `
                <div id="mobile-forum-header" style="display: none;">
                    <div class="mobile-header-bar">
                        <button id="mobile-category-switcher"></button>
                        <button id="mobile-search-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                        </button>
                    </div>
                    <div id="mobile-search-bar" class="hidden">
                        <input type="text" id="mobile-search-input" placeholder="Search forum posts...">
                        <button id="mobile-search-cancel">Cancel</button>
                    </div>
                    <div class="mobile-filter-bar">
                        <button id="mobile-filter-btn">⇅ Sort & View</button>
                        <div id="mobile-tags-container" tabindex="0">
                            <span>Tags ▾</span>
                        </div>
                    </div>
                </div>`;
            mainForum.insertAdjacentHTML('afterbegin', mobileHeaderHTML);
        }
    }

    // Move the original tag filters into the new mobile container
    const tagFiltersContainer = document.getElementById('guide-tag-filters');
    const mobileTagsContainer = document.getElementById('mobile-tags-container');
    if (tagFiltersContainer && mobileTagsContainer && !mobileTagsContainer.contains(tagFiltersContainer)) {
        mobileTagsContainer.appendChild(tagFiltersContainer);
    }

    // Move the sort modal to the body to ensure it's not trapped in a container
    const sortViewModal = document.getElementById('sort-view-modal');
    if (sortViewModal && sortViewModal.parentElement !== document.body) {
        document.body.appendChild(sortViewModal);
    }

    loadPreferences();
    renderSidebar();
    addEventListeners();

    // Call the new layout handler on initial load to position pagination correctly
    handleResponsiveLayout();

    try {
        const response = await fetch('guides.txt');
        if (!response.ok) throw new Error('Network response not ok.');
        allGuides = parseGuideText(await response.text());

        const firstForumLink = document.querySelector('#guide-forum-sidebar .sidebar-forum-link');
        if (firstForumLink) {
            firstForumLink.click();
            if (userPreferences.collapse === 'expanded') {
                const parentCategory = firstForumLink.closest('.sidebar-category');
                if (parentCategory) parentCategory.classList.remove('collapsed');
            }
        }
    } catch (error) {
        console.error('Failed to load guides:', error);
        postListContainer.innerHTML = `<p class="text-red-500">You may be wondering: Why doesn't the forum work? Well, here's the thing.<img src="https://preview.redd.it/ok-seriously-i-really-love-marvel-but-heres-the-thing-v0-57kwdotd4yde1.jpeg?auto=webp&s=1b87b7a2d203bfe20b5a9a3766a0881538756570"/></p>`;
    }
}





    function parseGuideText(text) {
        const guides = [];
        const guideEntries = text.split('[GUIDE]').slice(1);
        guideEntries.forEach(entry => {
            const guideData = {};
            const parts = entry.split('[END_GUIDE]')[0].trim();
            const contentSplit = parts.split('---');
            const mainContent = contentSplit[0];
            guideData.credits = contentSplit.length > 1 ? contentSplit[1].replace('CREDITS:', '').trim() : '';
            const lines = mainContent.split('\n');
            let contentBuffer = '';
            let isContent = false;
            lines.forEach(line => {
                const keyMatch = line.match(/^([A-Z_]+):\s*(.*)/);
                if (keyMatch) {
                    isContent = false;
                    const key = keyMatch[1];
                    const value = keyMatch[2].trim();
                    switch (key) {
                        case 'TITLE': guideData.title = value; break;
                        case 'FORUM': guideData.forum = value; break;
                        case 'CATEGORY': guideData.category = value; break;
                        case 'AUTHOR': guideData.author = value; break;
                        case 'AUTHOR_IMAGE': guideData.author_image = value; break;
                        case 'DATE': guideData.date = value; break;
                        case 'MAIN_IMAGE': guideData.main_image = value; break;
                        case 'TAGS': guideData.tags = value.split(',').map(t => t.trim()); break;
                        case 'CONTENT':
                            isContent = true;
                            contentBuffer += value + '\n';
                            break;
                    }
                } else if (isContent) { contentBuffer += line + '\n'; }
            });
            guideData.content = contentBuffer.trim();
            if (guideData.title) guides.push(guideData);
        });
        return guides;
    }

    function loadPreferences() {
        const prefs = JSON.parse(localStorage.getItem('guideForumPrefs'));
        if (prefs) {
            const { floatControls, floatPosition, ...safePrefs } = prefs;
            userPreferences = { ...userPreferences, ...safePrefs, tags: new Set() };
        }
        applyPreferences();
    }

    function savePreference(key, value) {
        userPreferences[key] = (key === 'guidesPerPage') ? parseInt(value, 10) : value;
        const { floatControls, floatPosition, ...prefsToSave } = userPreferences;
        localStorage.setItem('guideForumPrefs', JSON.stringify(prefsToSave));
    }
    
function applyPreferences() {
    const topControlsContainer = document.getElementById('top-controls-container');
    const sidebar = document.getElementById('guide-forum-sidebar');
    const controlsWrapper = document.getElementById('guide-controls-wrapper');
    const mainContent = document.getElementById('guide-forum-main');

    if (userPreferences.sidebar === 'hide') {
        // Move controls to the top and hide the sidebar container
        if (topControlsContainer && controlsWrapper) {
            topControlsContainer.appendChild(controlsWrapper);
        }
        sidebar.style.display = 'none';
        mainContent.style.width = '100%'; // Allow content to fill the space
    } else {
        // Move controls back to the sidebar and show it
        if (sidebar && controlsWrapper) {
            sidebar.appendChild(controlsWrapper);
        }
        sidebar.style.display = 'block';
        mainContent.style.width = ''; // Reset width
    }
    updateSortViewModal();
}

    function renderSidebar() {
        if (!categoriesContainer) return;
        categoriesContainer.innerHTML = forumStructure.map(category => `
            <div class="sidebar-category ${userPreferences.collapse === 'collapsed' ? 'collapsed' : ''}">
                <button class="sidebar-category-header">
                    <img src="${category.icon}" class="sidebar-category-icon" alt="${category.name} icon">
                    <span>${category.name}</span>
                    <svg class="sidebar-category-chevron" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                </button>
                <div class="sidebar-forum-list">
                    ${category.forums.map(forum => `
                        <div class="sidebar-forum-link" data-forum="${forum.name}">
                            <img src="${forum.icon}" class="sidebar-forum-icon" alt="${forum.name} icon">
                            <span>${forum.name}</span>
                        </div>
                    `).join('')}
                </div>
            </div>
        `).join('');
    }

function renderActiveForum() {
    const guidesInForum = allGuides.filter(g => g.forum === userPreferences.forum);
    const mobileCategorySwitcher = document.getElementById('mobile-category-switcher');

    if (mobileCategorySwitcher) {
        mobileCategorySwitcher.innerHTML = `<span class="truncate">${userPreferences.forum}</span>`;
    }

    const tagFiltersContainer = document.getElementById('guide-tag-filters');
    const uniqueTags = [...new Set(guidesInForum.flatMap(g => g.tags || []))];
    tagFiltersContainer.innerHTML = uniqueTags.map(tag =>
        `<button class="guide-tag-btn ${userPreferences.tags.has(tag) ? 'active' : ''}" data-tag="${tag}">${tag}</button>`
    ).join('');
    
    currentPage = 1;
    applyFiltersAndRenderPosts();
}

    function applyFiltersAndRenderPosts() {
        let guidesToRender = allGuides.filter(g => g.forum === userPreferences.forum);
        const searchTerm = userPreferences.search;
        if (searchTerm) {
            guidesToRender = guidesToRender.filter(g =>
                g.title.toLowerCase().includes(searchTerm) ||
                (g.content && g.content.toLowerCase().includes(searchTerm))
            );
        }
        if (userPreferences.tags.size > 0) {
            guidesToRender = guidesToRender.filter(g =>
                g.tags && Array.from(userPreferences.tags).every(t => g.tags.includes(t))
            );
        }
        guidesToRender.sort((a, b) => {
            const dateA = new Date(a.date);
            const dateB = new Date(b.date);
            if (userPreferences.sort === 'date-asc') return dateA - dateB;
            return dateB - dateA;
        });
        const startIndex = (currentPage - 1) * userPreferences.guidesPerPage;
        const endIndex = startIndex + userPreferences.guidesPerPage;
        const paginatedGuides = guidesToRender.slice(startIndex, endIndex);
        renderPosts(paginatedGuides);
        renderPagination(guidesToRender.length);
    }
    
    function renderPagination(totalGuides) {
        const totalPages = Math.ceil(totalGuides / userPreferences.guidesPerPage);
        paginationControls.innerHTML = '';
        if (totalPages <= 1) return;
        let paginationHTML = '';
        paginationHTML += `<button class="page-btn" data-page="${currentPage - 1}" ${currentPage === 1 ? 'disabled' : ''}>&laquo;</button>`;
        for (let i = 1; i <= totalPages; i++) {
            paginationHTML += `<button class="page-btn ${i === currentPage ? 'active' : ''}" data-page="${i}">${i}</button>`;
        }
        paginationHTML += `<button class="page-btn" data-page="${currentPage + 1}" ${currentPage === totalPages ? 'disabled' : ''}>&raquo;</button>`;
        paginationControls.innerHTML = paginationHTML;
    }

    function renderPosts(guides) {
        postListContainer.className = `w-full transition-all duration-300 ease-in-out view-${userPreferences.view}`;
        if (guides.length === 0) {
            postListContainer.innerHTML = '<p class="text-gray-500 p-4">No posts match the current filters.</p>';
            return;
        }
        postListContainer.innerHTML = guides.map(guide => `
            <div class="guide-post" data-title="${guide.title}">
                <img src="${guide.main_image || ''}" class="guide-post-image" onerror="this.style.display='none'">
                <div class="guide-post-content">
                    <h3 class="guide-post-title">${guide.title}</h3>
                    <p class="guide-post-meta">By ${guide.author || 'Unknown'} on ${guide.date || 'N/A'}</p>
                    <div class="guide-post-tags">
                        ${(guide.tags || []).map(tag => `<span class="guide-post-tag">${tag}</span>`).join('')}
                    </div>
                </div>
            </div>
        `).join('');
    }

function openGuide(guide) {
    if (!guide) return;
    
    const isMobile = window.innerWidth <= 768;
    const effectiveLoadingPref = isMobile ? 'full' : userPreferences.loading;

    const closeBtnHTML = `<button id="close-guide-btn" class="absolute top-4 right-4 text-3xl text-gray-400 hover:text-white">&times;</button>`;
    
    postViewerContainer.innerHTML = `
        <div class="relative p-4 md:p-0">
            ${effectiveLoadingPref === 'side' ? closeBtnHTML : ''}
            <h3>${guide.title}</h3>
            <p class="text-sm text-gray-400 -mt-2 mb-4">By ${guide.author || 'Unknown'} - ${guide.date || 'N/A'}</p>
            <div class="prose prose-invert max-w-none text-gray-300">${guide.content}</div>
            ${guide.credits ? `<div class="mt-6 pt-4 border-t border-gray-700 text-sm text-gray-500 italic">${guide.credits}</div>` : ''}
        </div>`;

    if (effectiveLoadingPref === 'side') {
        contentSplit.classList.add('side-loading');
    } else {
        contentSplit.classList.add('full-view-active');
        postListContainer.classList.add('hidden');
        paginationControls.classList.add('hidden');
        
        const mobileHeader = document.getElementById('mobile-forum-header');
        if (mobileHeader) mobileHeader.style.display = 'none';

        postViewerContainer.classList.remove('w-0', 'opacity-0');
        postViewerContainer.innerHTML = `<button id="close-guide-btn" class="p5-button m-4">&larr; Back to List</button>` + postViewerContainer.innerHTML;
    }
}

function closeGuide() {
    contentSplit.classList.remove('side-loading', 'full-view-active');
    postListContainer.classList.remove('hidden');
    paginationControls.classList.remove('hidden');
    
    const mobileHeader = document.getElementById('mobile-forum-header');
    if (mobileHeader) mobileHeader.style.display = 'block';

    postViewerContainer.innerHTML = '';
    postViewerContainer.classList.add('w-0', 'opacity-0');
    document.querySelectorAll('.guide-post.active').forEach(p => p.classList.remove('active'));
}
    
    function updateSortViewModal() {
        if (!sortViewModal) return;
        sortViewModal.querySelector(`input[name="sort"][value="${userPreferences.sort}"]`).checked = true;
        sortViewModal.querySelector(`input[name="view"][value="${userPreferences.view}"]`).checked = true;
        sortViewModal.querySelector(`input[name="loading"][value="${userPreferences.loading}"]`).checked = true;
        sortViewModal.querySelector(`input[name="collapse"][value="${userPreferences.collapse}"]`).checked = true;
        sortViewModal.querySelector(`input[name="sidebar"][value="${userPreferences.sidebar}"]`).checked = true;
        const perPageSelect = document.getElementById('guides-per-page-select');
        if (perPageSelect) perPageSelect.value = userPreferences.guidesPerPage;
    }

    function openQuickNav() {
        const quickNavGrid = document.getElementById('quick-nav-grid');
        quickNavGrid.innerHTML = forumStructure.flatMap(category => category.forums).map(forum => `
            <div class="quick-nav-link cursor-pointer" data-forum="${forum.name}">
                <img src="${forum.icon}" class="sidebar-forum-icon" alt="${forum.name} icon">
                <span class="font-bold text-white">${forum.name}</span>
            </div>
        `).join('');
        quickNavModal.classList.remove('hidden');
    }

    function closeQuickNav() {
        quickNavModal.classList.add('hidden');
    }

function addEventListeners() {
window.addEventListener('resize', handleResponsiveLayout);
    // Keep references to all elements, desktop and mobile
    const sidebar = document.getElementById('guide-forum-sidebar');
    const searchInput = document.getElementById('guide-search-input');
    const tagFiltersContainer = document.getElementById('guide-tag-filters');
    const paginationControls = document.getElementById('guide-pagination-controls');
    const postListContainer = document.getElementById('guide-post-list');
    const sortViewModal = document.getElementById('sort-view-modal');
    const quickNavModal = document.getElementById('quick-nav-modal');
    const forumTitle = document.getElementById('forum-title');

    const mobileSearchIcon = document.getElementById('mobile-search-icon');
    const mobileSearchBar = document.getElementById('mobile-search-bar');
    const mobileHeaderBar = document.querySelector('.mobile-header-bar');
    const mobileFilterBar = document.querySelector('.mobile-filter-bar');
    const mobileSearchInput = document.getElementById('mobile-search-input');
    const mobileSearchCancel = document.getElementById('mobile-search-cancel');
    const mobileCategorySwitcher = document.getElementById('mobile-category-switcher');
    const mobileFilterBtn = document.getElementById('mobile-filter-btn');

    // Desktop-only listeners
    if (sidebar) {
        sidebar.addEventListener('click', e => {
            const link = e.target.closest('.sidebar-forum-link');
            if (link) {
                userPreferences.forum = link.dataset.forum;
                userPreferences.tags.clear();
                sidebar.querySelectorAll('.sidebar-forum-link').forEach(l => l.classList.remove('active'));
                link.classList.add('active');
                closeGuide();
                renderActiveForum();
            }
            const header = e.target.closest('.sidebar-category-header');
            if (header) header.parentElement.classList.toggle('collapsed');
        });
    }
    if (searchInput) {
        searchInput.addEventListener('input', () => {
            userPreferences.search = searchInput.value.toLowerCase();
            currentPage = 1;
            applyFiltersAndRenderPosts();
        });
    }
    if (forumTitle) forumTitle.addEventListener('click', openQuickNav);

    // Mobile-only listeners
    if (mobileSearchIcon) {
        mobileSearchIcon.addEventListener('click', () => {
            mobileHeaderBar.classList.add('hidden');
            mobileFilterBar.classList.add('hidden');
            mobileSearchBar.classList.remove('hidden');
            mobileSearchInput.focus();
        });
    }
    if (mobileSearchCancel) {
        mobileSearchCancel.addEventListener('click', () => {
            mobileSearchBar.classList.add('hidden');
            mobileHeaderBar.classList.remove('hidden');
            mobileFilterBar.classList.remove('hidden');
            mobileSearchInput.value = '';
            mobileSearchInput.dispatchEvent(new Event('input'));
        });
    }
    if (mobileSearchInput) {
        mobileSearchInput.addEventListener('input', () => {
            userPreferences.search = mobileSearchInput.value.toLowerCase();
            currentPage = 1;
            applyFiltersAndRenderPosts();
        });
    }
    if (mobileCategorySwitcher) mobileCategorySwitcher.addEventListener('click', openQuickNav);
    if (mobileFilterBtn) mobileFilterBtn.addEventListener('click', () => sortViewModal.classList.toggle('hidden'));

    // Shared Listeners
    if (tagFiltersContainer) {
        tagFiltersContainer.addEventListener('click', e => {
            const tagBtn = e.target.closest('.guide-tag-btn');
            if (!tagBtn) return;
            const tag = tagBtn.dataset.tag;
            tagBtn.classList.toggle('active');
            if (userPreferences.tags.has(tag)) userPreferences.tags.delete(tag);
            else userPreferences.tags.add(tag);
            currentPage = 1;
            applyFiltersAndRenderPosts();
        });
    }
    if (paginationControls) {
        paginationControls.addEventListener('click', e => {
            const pageBtn = e.target.closest('.page-btn');
            if (pageBtn && !pageBtn.disabled) {
                currentPage = parseInt(pageBtn.dataset.page, 10);
                applyFiltersAndRenderPosts();
            }
        });
    }
    if (postListContainer) {
        postListContainer.addEventListener('click', e => {
            const post = e.target.closest('.guide-post');
            if (post) {
                const guide = allGuides.find(g => g.title === post.dataset.title);
                document.querySelectorAll('.guide-post.active').forEach(p => p.classList.remove('active'));
                post.classList.add('active');
                openGuide(guide);
            }
        });
    }
    if (sortViewModal) {
        sortViewModal.addEventListener('change', e => {
            if (e.target.matches('input[type="radio"]')) {
                savePreference(e.target.name, e.target.value);
                if (e.target.name !== 'sidebar') {
                    applyFiltersAndRenderPosts();
                } else {
                    applyPreferences();
                }
            }
            if (e.target.matches('#guides-per-page-select')) {
                savePreference('guidesPerPage', e.target.value);
                currentPage = 1;
                applyFiltersAndRenderPosts();
            }
        });
    }
    if (quickNavModal) {
        document.getElementById('quick-nav-close-btn').addEventListener('click', closeQuickNav);
        quickNavModal.addEventListener('click', e => {
            if (e.target.id === 'quick-nav-modal') closeQuickNav();
            const link = e.target.closest('.quick-nav-link');
            if (link) {
                const targetForumLink = document.querySelector(`#guide-forum-sidebar .sidebar-forum-link[data-forum="${link.dataset.forum}"]`);
                if (targetForumLink) targetForumLink.click();
                closeQuickNav();
            }
        });
    }

    // Global click listener
    document.addEventListener('click', e => {
        if (e.target.id === 'close-guide-btn' || e.target.closest('#close-guide-btn')) {
            closeGuide();
        }
        if (!e.target.closest('#sort-view-modal') && !e.target.closest('#mobile-filter-btn')) {
            sortViewModal.classList.add('hidden');
        }
    });
}


    initializeForum();
});


</script>
	
</body>
</html>
