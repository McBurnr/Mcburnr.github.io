<html lang="en">
<head>
    <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Persona 5: Phantom X - Wiki by McBurn</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Text:wght@400;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Crimson Text', serif;
            background: #0a0a0a;
            color: #fff;
            overflow-x: hidden;
            min-height: 100vh;
        }

/* UPDATE this rule */
.background {
    position: fixed;
    top: 0;
    left: 0;
    width: 200%;
    height: 100%;
    /* This is the only line that changes in this rule */
    background-image: var(--background-image);
    background-repeat: repeat-x;
    background-size: auto 100%;
    animation: scrollBackground 30s linear infinite;
    z-index: -1;
    opacity: 0.3;
}

        @keyframes scrollBackground {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

/* UPDATE this rule */
body {
    /* Initial padding to prevent content from hiding behind the new fixed header */
    padding-top: 240px; /* This is the fix: increased from 180px */
    transition: padding-top 0.5s ease-in-out;
}

body.header-retracted {
    /* Padding when header is collapsed */
    padding-top: 50px; 
}



.header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    padding: 1rem 2rem;
    background: linear-gradient(135deg, var(--gradient-primary), rgba(20, 20, 20, 0.95));
    box-shadow: 0 4px 20px var(--shadow-color-light);
    z-index: 50;
    transition: all 0.5s ease-in-out;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
}

/* UPDATE this rule */
#header-content-wrapper {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    width: 100%;
    gap: 1.5rem;
    max-height: 150px; /* This is the fix: increased from 100px */
    overflow: hidden;
    opacity: 1;
    transition: max-height 0.4s ease-in-out, opacity 0.3s ease-in-out, margin-bottom 0.4s ease-in-out;
}

#header-info {
    text-align: left;
    flex-shrink: 1;
}

.header h1 {
    font-size: 2.2rem;
    margin-bottom: 0.25rem;
}

.header p {
    font-size: 1rem;
    margin: 0;
}

#header-links {
    display: flex;
    flex-direction: column; /* This stacks the buttons vertically */
    align-items: flex-end;  /* This aligns them to the right */
    gap: 0.5rem;            /* This adds a small space between them */
}

.header-link-btn {
    display: inline-block;
    padding: 0.6rem 1rem;
    background-color: var(--primary-color);
    color: white;
    text-decoration: none;
    border-radius: 20px;
    font-family: 'Cinzel', serif;
    font-weight: 600;
    transition: all 0.3s ease;
    white-space: nowrap;
}

.header-link-btn:hover {
    background-color: var(--primary-color-dark);
    transform: translateY(-2px);
}

.search-container {
    max-height: 100px; /* For transition */
    opacity: 1;
    transition: max-height 0.4s ease-in-out, opacity 0.3s ease-in-out;
    width: 100%;
    max-width: 700px;
}

#toggleHeaderBtn {
    background: transparent;
    border: none;
    width: 60px;
    height: 30px;
    position: absolute;
    bottom: -15px; /* Hangs off the bottom edge */
    left: 50%;
    transform: translateX(-50%);
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: rgba(20, 20, 20, 0.8);
    border-radius: 0 0 15px 15px;
    border: 1px solid var(--primary-color);
    border-top: none;
}

#toggleHeaderBtn svg {
    fill: var(--primary-color);
    width: 32px;
    height: 32px;
    transition: transform 0.5s ease-in-out, fill 0.3s ease;
}

#toggleHeaderBtn:hover svg {
    fill: #fff;
}

/* Retracted State Styling */
.header.retracted {
    padding-top: 0.75rem; /* Adds a bit of space above the search bar */
    padding-bottom: 25px; /* Maintains space for the hanging button */
}

.header.retracted #header-content-wrapper {
    max-height: 0;
    opacity: 0;
    margin-bottom: 0;
}


.header.retracted #toggleHeaderBtn svg {
    transform: rotate(180deg);
}

        .header h1 {
            font-family: 'Cinzel', serif;
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary-color);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.2rem;
            color: #ccc;
            font-weight: 600;
        }

        .character-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 2rem;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .character-card {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.6s ease;
            background: linear-gradient(135deg, rgba(20, 20, 20, 0.8), rgba(40, 40, 40, 0.8));
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }

        .character-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 15px 35px var(--shadow-color-medium);
        }

        .character-portrait {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .character-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 60%, var(--gradient-primary));
            opacity: 0;
            transition: all 0.3s ease;
            display: flex;
            align-items: flex-end;
            padding: 1rem;
            border: 3px solid transparent;
            border-radius: 15px;
        }

        .character-card:hover .character-overlay {
            opacity: 1;
            border-color: var(--primary-color);
        }

        .character-name {
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            text-align: center;
            width: 100%;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.show {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(20, 20, 20, 0.95), rgba(40, 40, 40, 0.95));
            border: 2px solid var(--primary-color);
            border-radius: 20px;
            max-width: 90%;
            max-height: 90%;
            width: 800px;
            height: 600px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 50px var(--shadow-color-light);
            backdrop-filter: blur(10px);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 2px solid var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.2), rgba(60, 60, 60, 0.2));
            border-radius: 18px 18px 0 0;
        }

        .modal-title {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
        }

        .close-btn {
            background: var(--primary-color);
            border: none;
            color: white;
            font-size: 1.5rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .close-btn:hover {
            background: var(--primary-color-dark);
            transform: scale(1.1);
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid var(--primary-color);
            background: rgba(20, 20, 20, 0.3);
        }

        .tab {
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            color: #ccc;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            font-size: 1rem;
            font-weight: 600;
            text-transform: capitalize;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab:hover {
            color: var(--primary-color);
            background: rgba(139, 0, 0, 0.1);
        }

        .tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background: rgba(139, 0, 0, 0.2);
        }

        .tab-content {
            flex: 1;
            padding: 2rem;
            display: none;
            justify-content: center;
            align-items: center;
            overflow: auto;
        }

        .tab-content.active {
            display: flex;
        }

        .tab-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-image:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 40px var(--shadow-color-light);
        }

        .image-zoom-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s ease;
            cursor: pointer;
        }

        .image-zoom-overlay.show {
            display: flex;
            opacity: 1;
        }

        .zoomed-image {
            max-width: 95%;
            max-height: 95%;
            object-fit: contain;
            border-radius: 10px;
            box-shadow: 0 20px 60px rgba(139, 0, 0, 0.5);
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .image-zoom-overlay.show .zoomed-image {
            transform: scale(1);
        }

        .zoom-close-hint {
            position: absolute;
            top: 2rem;
            right: 2rem;
            color: var(--primary-color);
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            background: rgba(0, 0, 0, 0.7);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            border: 2px solid var(--primary-color);
        }

        .loading {
            color: var(--primary-color);
            font-size: 1.2rem;
            text-align: center;
        }

/* === Custom Cursor Styles (Forced) === */

/* 1. Universal Default Cursor */
/* The !important flag forces this rule to override default browser styles. */
* {
    cursor: url('p.png'), auto !important;
}

/* 2. Universal Pointer for Interactive Elements */
/* This rule also needs !important to ensure it overrides the rule above for clickable items. */
a,
button,
label,
input[type='checkbox'],
input[type='radio'],
input[type='submit'],
select,
[onclick],
.character-card,
.tab,
#toggleHeaderBtn,
.suggestion-item,
.patch-notes-btn,
.close-btn,
.tab-image,
.zoom-close-hint {
    cursor: url('p.png'), pointer !important;
}


/* Touch and Mobile Optimizations */
.character-card {
    touch-action: manipulation;
    -webkit-tap-highlight-color: var(--shadow-color-light);
}

.tab, .close-btn, .patch-notes-btn {
    touch-action: manipulation;
    -webkit-tap-highlight-color: var(--shadow-color-light);
    min-height: 44px; /* iOS recommended touch target size */
}

.tab-image {
    touch-action: manipulation;
}

/* Prevent zoom on double tap for specific elements */
.modal-content, .patch-notes-content {
    touch-action: pan-y pinch-zoom;
}

/* Improve scrolling on mobile */
.patch-notes-body, .tab-content {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
}

.search-container {
    position: relative;
    max-width: 600px;
    margin: 0 auto; /* Removed top margin */
    display: flex;
}

#searchInput {
    width: 100%;
    padding: 12px 20px;
    font-size: 1rem;
    font-family: 'Crimson Text', serif;
    color: #fff;
    background-color: #121212;
    border: 1px solid #303030;
    border-right: none;
    border-radius: 40px 0 0 40px;
    outline: none;
    transition: border-color 0.3s ease;
}

#searchInput:focus {
    border-color: var(--primary-color);
}

#searchButton {
    width: 65px;
    border: 1px solid #303030;
    background-color: #222;
    color: #fff;
    cursor: pointer;
    border-radius: 0 40px 40px 0;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.3s ease;
}

#searchButton:hover {
    background-color: #333;
}

#suggestionsContainer {
    position: absolute;
    top: calc(100% + 2px);
    left: 0;
    right: 65px; /* Match search button width */
    background-color: #121212;
    border: 1px solid #303030;
    border-top: none;
    border-radius: 0 0 10px 10px;
    max-height: 300px;
    overflow-y: auto;
    z-index: 10;
    display: none; /* Initially hidden */
}

.suggestion-item {
    padding: 12px 20px;
    color: #fff;
    cursor: pointer;
    font-family: 'Crimson Text', serif;
    font-size: 1rem;
}

.suggestion-item:hover {
    background-color: #333;
}


@media (max-width: 768px) {
    .header h1 { 
        font-size: 2rem; 
    }
    
    .header p {
        font-size: 1rem;
    }
    
    .character-grid { 
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); 
        gap: 1rem; 
        padding: 1rem; 
    }
    
    .character-card {
        border-radius: 10px;
    }
    
    .character-portrait {
        height: 200px;
    }
    
    .character-name {
        font-size: 0.9rem;
    }
    
    .modal-content { 
        width: 95%; 
        height: 85%; 
        margin: 2.5% auto;
        border-radius: 15px;
    }
    
    .modal-header {
        padding: 1rem;
        border-radius: 13px 13px 0 0;
    }
    
    .modal-title {
        font-size: 1.2rem;
    }
    
    .close-btn {
        width: 35px;
        height: 35px;
        font-size: 1.2rem;
    }
    
    .tabs { 
        flex-wrap: wrap; 
        justify-content: center;
    }
    
    .tab { 
        padding: 0.7rem 1rem; 
        font-size: 0.85rem;
        min-width: 80px;
        flex: 1;
        text-align: center;
    }
    
    .tab-content {
        padding: 1rem;
    }
    
    .tab-image {
        max-width: 100%;
        height: auto;
        object-fit: contain;
    }
    
    .patch-notes-btn {
        top: 1rem;
        right: 1rem;
        padding: 0.6rem 1rem;
        font-size: 0.8rem;
    }
    
    .patch-notes-content {
        width: 95%;
        max-height: 85%;
        margin: 2.5% auto;
    }
    
    .patch-notes-body {
        padding: 1.5rem;
    }
    
    .patch-version {
        font-size: 1.1rem;
    }
    
    .zoom-close-hint {
        top: 1rem;
        right: 1rem;
        font-size: 1rem;
        padding: 0.4rem 0.8rem;
    }
}

/* Additional mobile support for very small screens */
@media (max-width: 480px) {
    .header {
        padding: 1.5rem 0;
    }
    
    .header h1 {
        font-size: 1.8rem;
    }
    
    .character-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 0.8rem;
        padding: 0.8rem;
    }
    
    .character-portrait {
        height: 160px;
    }
    
    .character-name {
        font-size: 0.8rem;
    }
    
    .modal-content {
        width: 98%;
        height: 90%;
        margin: 5% auto;
    }
    
    .modal-header {
        padding: 0.8rem;
    }
    
    .modal-title {
        font-size: 1.1rem;
    }
    
    .tab {
        padding: 0.6rem 0.8rem;
        font-size: 0.8rem;
        min-width: 70px;
    }
    
    .tab-content {
        padding: 0.8rem;
    }
    
    .patch-notes-btn {
        padding: 14.5rem 0.8rem;
        font-size: 0.75rem;
    }
    
    .patch-notes-body {
        padding: 1rem;
    }
    
    .patch-version {
        font-size: 1rem;
    }
    
    .patch-date {
        font-size: 0.9rem;
    }
    
    .patch-list li {
        font-size: 0.9rem;
        margin-bottom: 0.6rem;
    }
}
/* Patch Notes Button */
.patch-notes-btn {
    /* Removed position: fixed, top, right, z-index, etc. */
    background: transparent;
    border: 2px solid var(--primary-color);
    color: #fff;
    padding: 0.6rem 1rem;
    border-radius: 20px;
    cursor: pointer;
    font-family: 'Cinzel', serif;
    font-size: 0.9rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
    white-space: nowrap; /* Prevents text from wrapping */
}

.patch-notes-btn:hover {
    background: var(--primary-color);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px var(--shadow-color-medium);
}

.patch-notes-btn span {
    font-size: 1rem;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.8));
}

/* Patch Notes Modal */
.patch-notes-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1500;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.patch-notes-modal.show {
    display: flex;
    opacity: 1;
}

.patch-notes-content {
    background: linear-gradient(135deg, rgba(20, 20, 20, 0.95), rgba(40, 40, 40, 0.95));
    border: 2px solid var(--primary-color);
    border-radius: 20px;
    max-width: 90%;
    max-height: 80%;
    width: 700px;
    display: flex;
    flex-direction: column;
    box-shadow: 0 20px 50px var(--shadow-color-light);
    backdrop-filter: blur(10px);
}

.patch-notes-body {
    flex: 1;
    padding: 2rem;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--primary-color) rgba(40, 40, 40, 0.3);
}

.patch-notes-body::-webkit-scrollbar {
    width: 8px;
}

.patch-notes-body::-webkit-scrollbar-track {
    background: rgba(40, 40, 40, 0.3);
    border-radius: 4px;
}

.patch-notes-body::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

.patch-notes-body::-webkit-scrollbar-thumb:hover {
    background: var(--primary-color-dark);
}

.patch-entry {
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid var(--shadow-color-light);
}

.patch-entry:last-child {
    border-bottom: none;
    margin-bottom: 0;
}

.patch-version {
    font-family: 'Cinzel', serif;
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--primary-color);
    margin-bottom: 0.5rem;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.patch-date {
    font-size: 1rem;
    color: #ccc;
    margin-bottom: 1rem;
    font-style: italic;
}

.patch-list {
    list-style: none;
    padding: 0;
}

.patch-list li {
    position: relative;
    padding-left: 1.5rem;
    margin-bottom: 0.8rem;
    color: #fff;
    line-height: 1.6;
}

.patch-list li::before {
    content: "â–¸";
    position: absolute;
    left: 0;
    color: var(--primary-color);
    font-weight: bold;
    font-size: 1.1rem;
}

/* Mobile Responsiveness for Patch Notes */
@media (max-width: 768px) {
    .patch-notes-btn {
        top: 1rem;
        right: 1rem;
        padding: 0.6rem 1rem;
        font-size: 0.8rem;
    }
    
    .patch-notes-content {
        width: 95%;
        max-height: 85%;
    }
    
    .patch-notes-body {
        padding: 1.5rem;
    }
    
    .patch-version {
        font-size: 1.1rem;
    }
}

/* === Custom Context Menu Styles === */
#customContextMenu {
    position: fixed;
    z-index: 3000;
    width: 280px;
    background: rgba(10, 10, 10, 0.9);
    border: 2px solid var(--primary-color);
    border-radius: 8px;
    box-shadow: 0 0 20px rgba(255, 68, 68, 0.4);
    backdrop-filter: blur(8px);
    padding: 6px;
    display: none; /* Initially hidden */
    transform: scale(0.98);
    opacity: 0;
    transition: transform 0.1s ease-out, opacity 0.1s ease-out;
    font-family: 'Cinzel', serif;
}

#customContextMenu.active {
    display: block;
    transform: scale(1);
    opacity: 1;
}

.context-menu-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.context-menu-item {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 12px 20px;
    color: #f0f0f0;
    font-size: 1rem;
    font-weight: 600;
    transition: all 0.15s ease-in-out;
    position: relative;
    overflow: hidden;
}

.context-menu-item:hover {
    background-color: var(--primary-color);
    color: #fff;
    transform: translateX(8px);
    border-radius: 4px;
}

.context-menu-item .icon {
    width: 20px;
    height: 20px;
    /* This will make your icons white to match the theme */
    filter: brightness(0) invert(1);
}

.context-menu-separator {
    height: 2px;
    background-color: var(--shadow-color-light);
    margin: 6px 15px;
}

/* REPLACE your theme definition block with this */
/* === Theme Color & Background Definitions === */
:root {
    --primary-color: #ff0000;
    --primary-color-dark: #cc0000;
    --gradient-primary: rgba(255, 0, 0, 0.9);
    --shadow-color-light: rgba(255, 0, 0, 0.3);
    --shadow-color-medium: rgba(255, 0, 0, 0.4);
    --background-image: url('https://cdn.imgchest.com/files/4apc5o8wzq4.png'); /* Default Red/Joker Background */
}
body.theme-blue {
    --primary-color: #0055ff;
    --primary-color-dark: #0033cc;
    --gradient-primary: rgba(0, 85, 255, 0.9);
    --shadow-color-light: rgba(0, 85, 255, 0.3);
    --shadow-color-medium: rgba(0, 85, 255, 0.4);
    --background-image: url('https://cdn.imgchest.com/files/4jdcv9p3ko4.png');
}
body.theme-green {
    --primary-color: #00ff00;
    --primary-color-dark: #00cc00;
    --gradient-primary: rgba(0, 255, 0, 0.9);
    --shadow-color-light: rgba(0, 255, 0, 0.3);
    --shadow-color-medium: rgba(0, 255, 0, 0.4);
    --background-image: url('https://cdn.imgchest.com/files/4z9cvxpkq27.png');
}
body.theme-yellow {
    --primary-color: #ffdd00;
    --primary-color-dark: #ccb100;
    --gradient-primary: rgba(255, 221, 0, 0.9);
    --shadow-color-light: rgba(255, 221, 0, 0.3);
    --shadow-color-medium: rgba(255, 221, 0, 0.4);
    --background-image: url('https://cdn.imgchest.com/files/4z9cvxpkae7.png');
}
body.theme-pink {
    --primary-color: #ff5599;
    --primary-color-dark: #cc447a;
    --gradient-primary: rgba(255, 85, 153, 0.9);
    --shadow-color-light: rgba(255, 85, 153, 0.3);
    --shadow-color-medium: rgba(255, 85, 153, 0.4);
    --background-image: url('URL_FOR_PANTHER_PINK_BACKGROUND');
}
body.theme-purple {
    --primary-color: #aa00ff;
    --primary-color-dark: #8800cc;
    --gradient-primary: rgba(170, 0, 255, 0.9);
    --shadow-color-light: rgba(170, 0, 255, 0.3);
    --shadow-color-medium: rgba(170, 0, 255, 0.4);
    --background-image: url('URL_FOR_NOIR_PURPLE_BACKGROUND');
}

/* === Theme Switcher Styles === */
#themeSwitcherContainer {
    display: flex;
    gap: 8px;
    justify-content: flex-end; /* Aligns the dots to the right */
    padding-top: 8px; /* Adds space from the patch notes button */
}
.theme-button {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    border: 2px solid #fff;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.theme-button:hover {
    transform: scale(1.15);
}
.theme-button.active {
    box-shadow: 0 0 10px 3px #fff;
    transform: scale(1.1);
}

/* === Notification Styles === */
#themeNotification {
    position: fixed;
    bottom: 25px;
    right: -100%; /* Start off-screen */
    background: rgba(10, 10, 10, 0.9);
    color: #fff;
    padding: 15px 25px;
    border-radius: 10px;
    border-left: 5px solid var(--primary-color);
    box-shadow: 0 5px 20px var(--shadow-color-medium);
    z-index: 4000;
    transition: right 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    font-family: 'Crimson Text', serif;
    backdrop-filter: blur(8px);
    max-width: 400px;
}
#themeNotification.show {
    right: 25px; /* Slide in */
}
#notificationFlavorText {
    font-size: 1.1rem;
    font-style: italic;
    color: var(--primary-color);
    font-weight: bold;
    text-shadow: 0 0 5px var(--primary-color);
}
#notificationMainText {
    font-size: 1rem;
    margin-top: 5px;
}

/* === FINAL UNIFIED SCROLLBAR STYLES === */

/* --- Firefox --- */
html {
    scrollbar-width: thin;
    scrollbar-color: var(--primary-color) rgba(40, 40, 40, 0.3);
}

/* --- WebKit (Chrome, Safari, Edge) --- */

/* Step 1: Define the scrollbar's size and track color */
html::-webkit-scrollbar {
    width: 10px;
}
html::-webkit-scrollbar-track {
    background: #0a0a0a;
}

/* Step 2: Define the thumb color for EACH theme */

/* Default Red Scrollbar */
html.theme-red::-webkit-scrollbar-thumb { background-color: #ff0000 !important; }
html.theme-red::-webkit-scrollbar-thumb:hover { background-color: #cc0000 !important; }

/* Fox Blue Scrollbar */
html.theme-blue::-webkit-scrollbar-thumb { background-color: #0055ff !important; }
html.theme-blue::-webkit-scrollbar-thumb:hover { background-color: #0033cc !important; }

/* Oracle Green Scrollbar */
html.theme-green::-webkit-scrollbar-thumb { background-color: #00ff00 !important; }
html.theme-green::-webkit-scrollbar-thumb:hover { background-color: #00cc00 !important; }

/* Skull Yellow Scrollbar */
html.theme-yellow::-webkit-scrollbar-thumb { background-color: #ffdd00 !important; }
html.theme-yellow::-webkit-scrollbar-thumb:hover { background-color: #ccb100 !important; }

/* Panther Pink Scrollbar */
html.theme-pink::-webkit-scrollbar-thumb { background-color: #ff5599 !important; }
html.theme-pink::-webkit-scrollbar-thumb:hover { background-color: #cc447a !important; }

/* Noir Purple Scrollbar */
html.theme-purple::-webkit-scrollbar-thumb { background-color: #aa00ff !important; }
html.theme-purple::-webkit-scrollbar-thumb:hover { background-color: #8800cc !important; }

    </style>
</head>
<body>
    <div class="background"></div>
    
<header class="header" id="mainHeader">
    <div id="header-content-wrapper">
        <div id="header-info">
            <h1>Persona 5: Phantom X Wiki</h1>
            <p>Webpage Designed by McBurn | Credits for Infographics in Images</p>
        </div>
        <div id="header-links">
            <a href="https://discord.gg/gachametaverse" class="header-link-btn">Join our Discord!</a>
            <button class="patch-notes-btn" id="patchNotesBtn">
                <span>ðŸ“‹</span>
                Patch Notes
            </button>
			<div id="themeSwitcherContainer">
    </div>
        </div>
    </div>
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="Search for a character...">
        <div id="suggestionsContainer"></div>
        <button id="searchButton" aria-label="Search">
            <svg focusable="false" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor">
                <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
            </svg>
        </button>
    </div>
    <button id="toggleHeaderBtn">
        <svg viewBox="0 0 24 24">
            <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path>
        </svg>
    </button>
</header>

    <div class="character-grid" id="characterGrid">
    </div>

    <div class="modal" id="characterModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle"></h2>
                <button class="close-btn" id="closeBtn">&times;</button>
            </div>
            <div class="tabs" id="tabsContainer"></div>
            <div class="tab-content-container" id="tabContentContainer"></div>
        </div>
    </div>

    <div class="image-zoom-overlay" id="imageZoomOverlay">
        <div class="zoom-close-hint">Click to close</div>
        <img class="zoomed-image" id="zoomedImage" src="" alt="">
    </div>


<!-- Patch Notes Modal -->
<div class="patch-notes-modal" id="patchNotesModal">
    <div class="patch-notes-content">
        <div class="modal-header">
            <h2 class="modal-title">Patch Notes</h2>
            <button class="close-btn" id="closePatchNotesBtn">&times;</button>
        </div>
        <div class="patch-notes-body">


            <div class="patch-entry">
                <h3 class="patch-version">1.0.5</h3>
                <p class="patch-date"> â€” 6/15/2025 1:19 PM</p>
                <ul class="patch-list">
                    <li>Added Custom Context Menu (PC)</li>
                    <li>Added Custom Cursor (PC)</li>
                    <li>Fixed an issue where Messa would sometimes be named Daddy</li>
                    <li>Tried to fix an issue where rarely (as reported) the background would be kawakami in a swimsuit</li>
                    <li>No comment... - F</li>
                </ul>
            </div>


            <div class="patch-entry">
                <h3 class="patch-version">1.0.4</h3>
                <p class="patch-date"> â€” 6/13/2025 6:45 PM</p>
                <ul class="patch-list">
                    <li>Added collapsable title menu</li>
                    <li>Updated and moved server and patch buttons</li>
                    <li>Added a search bar with suggestions</li>
                    <li>Updated character display modal to filter by search results</li>
                    <li>He still didn't fix the text going off the page! LMFAO - F</li>
                </ul>
            </div>

            <div class="patch-entry">
                <h3 class="patch-version">1.0.3</h3>
                <p class="patch-date"> â€” 6/13/2025 1:45 PM</p>
                <ul class="patch-list">
                    <li>Added Yukari Takeba</li>
                    <li>Added mobile support for scaling and touch responsiveness</li>
                    <li>Updated character portraits and info graphics</li>
                    <li>Improved modal animations and transitions</li>
                    <li>He's still too lazy to fix the text going off the page! LOL - F</li>
                </ul>
            </div>
            
            <div class="patch-entry">
                <h3 class="patch-version">1.0.2</h3>
                <p class="patch-date"> â€” 6/5/2025 6:18 AM</p>
                <ul class="patch-list">
                    <li>Added Makoto Yuki</li>
                    <li>Fixed image loading issues</li>
                    <li>Added this patch menu</li>
                    <li>Nobody can keep the oracle out! - F</li>
                </ul>
            </div>
            
            <div class="patch-entry">
                <h3 class="patch-version">1.0.1</h3>
                <p class="patch-date"> â€” 5/30/2025 1:40 PM</p>
                <ul class="patch-list">
                    <li>There is no Version 1.0.0 in Ba Sing Se</li>
                    <li>Added a cool animated background</li>
                    <li>Added all current characters as of this date</li>
                    <li>Implemented character info modals</li>
                    <li>Added image zoom functionality</li>
                    <li>Added safeguards in case futaba breaks in</li>
                </ul>
            </div>
        </div>
    </div>
</div>

    <script>
const charactersData = {
    "morgana": {
        "name": "Morgana (Mona)",
        "portrait": "https://cdn.imgchest.com/files/7kzcape3wz7.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/pyvdcmawkky.png",
            "awareness": "https://cdn.imgchest.com/files/6yxkc8bzw67.png",
            "weapons": "https://cdn.imgchest.com/files/b49zcdm23ry.png",
            "revelations": "https://cdn.imgchest.com/files/l4necdg8q94.png",
            "teams": "https://cdn.imgchest.com/files/p7bwc5akp57.png"
        }
    },
    "sepia": {
        "name": "Toshiya Sumi (Sepia)",
        "portrait": "https://cdn.imgchest.com/files/7ogcba8nwmy.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/pyq9c9d3j84.png",
            "awareness": "https://cdn.imgchest.com/files/myd5c6qewj4.png",
            "weapons": "https://cdn.imgchest.com/files/3yrgc2rnq34.png",
            "teams": "https://cdn.imgchest.com/files/j7mmcpo9b87.png"
        }
    },
    "soy": {
        "name": "Shun Kanou (Soy)",
        "portrait": "https://cdn.imgchest.com/files/7pjcqnxod27.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/j7mmcpoowk7.png",
            "awareness": "https://cdn.imgchest.com/files/e4gdcqddwd4.png",
            "weapons": "https://cdn.imgchest.com/files/my8xcoeevx4.png",
            "teams": "https://cdn.imgchest.com/files/84apca66qd4.png"
        }
    },
    "summer_moko": {
        "name": "Tomoko Noge (SUMMER Moko)",
        "portrait": "https://cdn.imgchest.com/files/7bwck6goee7.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/345xcx6zop7.png",
            "awareness": "https://cdn.imgchest.com/files/pyvdcmarlvy.png",
            "weapons": "https://cdn.imgchest.com/files/b49zcdma5oy.png",
            "teams": "https://cdn.imgchest.com/files/w7pjcgzaek7.png"
        }
    },
    "summer_closer": {
        "name": "Motoha Arai (Closer SUMMER)",
        "portrait": "https://cdn.imgchest.com/files/4nec8zwvnl4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/l4necdgoep4.png",
            "awareness": "https://cdn.imgchest.com/files/w7pjcgzmal7.png",
            "weapons": "https://cdn.imgchest.com/files/p7bwc5aj9l7.png",
            "teams": "https://cdn.imgchest.com/files/j7kzcqd8vr7.png"
        }
    },
    "closer": {
        "name": "Motoha Arai (Closer)",
        "portrait": "https://cdn.imgchest.com/files/7kzcag39eg7.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/7ogcbjnr8qy.png",
            "awareness": "https://cdn.imgchest.com/files/7bwck8o3gg7.png",
            "weapons": "https://cdn.imgchest.com/files/4nec82vbwo4.png",
            "teams": "https://cdn.imgchest.com/files/4nec82vbwo4.png"
        }
    },
    "puppet": {
        "name": "Miyu Sahara (Puppet)",
        "portrait": "https://cdn.imgchest.com/files/49zc2ngo9by.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/w7pjcgzmml7.png",
            "awareness": "https://cdn.imgchest.com/files/d7ogcogppoy.png",
            "weapons": "https://cdn.imgchest.com/files/my2pcv2aab7.png",
            "teams": "https://cdn.imgchest.com/files/l7lxc8e33o7.png"
        }
    },
    "phoebe": {
        "name": "Yumi Shiina (Phoebe)",
        "portrait": "https://cdn.imgchest.com/files/yxkczpjok27.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/84jdc5kz2w4.png",
            "awareness": "https://cdn.imgchest.com/files/pyq9c9dabb4.png",
            "weapons": "https://cdn.imgchest.com/files/myd5c6q39x4.png",
            "teams": "https://cdn.imgchest.com/files/3yrgc2r5bv4.png"
        }
    },
    "wind": {
        "name": "Riko Tanemura (Wind)",
        "portrait": "https://cdn.imgchest.com/files/yvdcwxbogoy.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/myd5c6q3xx4.png",
            "awareness": "https://cdn.imgchest.com/files/3yrgc2r5wv4.png",
            "weapons": "https://cdn.imgchest.com/files/j7mmcpoglv7.png",
            "revelations": "https://cdn.imgchest.com/files/k739cve5ow7.png",
            "teams": "https://cdn.imgchest.com/files/w7w6cdbngoy.png"
        }
    },
    "chord": {
        "name": "Ayaka Sakai (Chord)",
        "portrait": "https://cdn.imgchest.com/files/46acqlae3w7.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/my2pcv2azp7.png",
            "awareness": "https://cdn.imgchest.com/files/84jdc5kznw4.png",
            "weapons": "https://cdn.imgchest.com/files/49zc2mq3kjy.png",
            "teams": "https://cdn.imgchest.com/files/myd5c6q3jx4.png"
        }
    },
    "queen": {
        "name": "Makoto Niijima (Queen)",
        "portrait": "https://cdn.imgchest.com/files/4apc59dowg4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/g4z9c5e3ob7.png",
            "awareness": "https://cdn.imgchest.com/files/e4gdcqd95g4.png",
            "weapons": "https://cdn.imgchest.com/files/my8xcoeg3o4.png",
            "teams": "https://cdn.imgchest.com/files/345xcx6mdo7.png"
        }
    },
    "vino": {
        "name": "Chizuko Nagao (Vino)",
        "portrait": "https://cdn.imgchest.com/files/45xcvakwqn7.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/k46acxnvkm7.png",
            "awareness": "https://cdn.imgchest.com/files/pyvdcma9pxy.png",
            "weapons": "https://cdn.imgchest.com/files/6yxkc8bxaz7.png",
            "teams": "https://cdn.imgchest.com/files/b49zcdmkxmy.png"
        }
    },
    "okyann": {
        "name": "Kayo Tomiyama (Okyann)",
        "portrait": "https://cdn.imgchest.com/files/y8xcnal82w4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/w7pjcgzmox7.png",
            "awareness": "https://cdn.imgchest.com/files/d7ogcogpnry.png",
            "weapons": "https://cdn.imgchest.com/files/j7kzcqd83o7.png",
            "teams": "https://cdn.imgchest.com/files/my2pcv2arn7.png"
        }
    },
    "joker": {
        "name": "Ren Amamiya (Joker)",
        "portrait": "https://cdn.imgchest.com/files/4gdcx3vrow4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/3yrgc2r5oz4.png",
            "awareness": "https://cdn.imgchest.com/files/j7mmcpog8n7.png",
            "weapons": "https://cdn.imgchest.com/files/k739cve5mg7.png",
            "teams": "https://cdn.imgchest.com/files/w7w6cdbno3y.png"
        }
    },
    "messa": {
        "name": "Kira Kitazato (Messa)",
        "portrait": "https://cdn.imgchest.com/files/4z9cvq8xk87.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/345xcx6dgr7.png",
            "awareness": "https://cdn.imgchest.com/files/84apca6gkj4.png",
            "weapons": "https://cdn.imgchest.com/files/k46acxnk5r7.png",
            "teams": "https://cdn.imgchest.com/files/pyvdcmavemy.png"
        }
    },
    "rin": {
        "name": "Yaoling Li (Rin)",
        "portrait": "https://cdn.imgchest.com/files/ye3c2vp38o4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/l7lxc8en2g7.png",
            "awareness": "https://cdn.imgchest.com/files/84jdc5kn924.png",
            "weapons": "https://cdn.imgchest.com/files/pyq9c9dgnp4.png",
            "teams": "https://cdn.imgchest.com/files/pyq9c9dgnp4.png"
        }
    },
    "key": {
        "name": "Kiyoshi Kurotani (Key)",
        "portrait": "https://cdn.imgchest.com/files/7w6c29mozey.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/l7lxc8enxl7.png",
            "awareness": "https://cdn.imgchest.com/files/k739cve9kj7.png",
            "weapons": "https://cdn.imgchest.com/files/g4z9c5eo9g7.png",
            "teams": "https://cdn.imgchest.com/files/84apca6gmg4.png"
        }
    },
    "leon": {
        "name": "Reo Kamiyama (Leon)",
        "portrait": "https://cdn.imgchest.com/files/739cxznmge7.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/my8xcoemep4.png",
            "awareness": "https://cdn.imgchest.com/files/345xcx63697.png",
            "weapons": "https://cdn.imgchest.com/files/84apca6x6v4.png",
            "teams": "https://cdn.imgchest.com/files/6yxkc8bab67.png"
        }
    },
    "bui": {
        "name": "Yui (Bui)",
        "portrait": "https://cdn.imgchest.com/files/yrgcnxkoax4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/myd5c6qpoj4.png",
            "awareness": "https://cdn.imgchest.com/files/myd5c6qpom4.png",
            "weapons": "https://cdn.imgchest.com/files/k739cvew827.png",
            "teams": "https://cdn.imgchest.com/files/wye3cmr6le4.png"
        }
    },
    "panther": {
        "name": "Ann Takamaki (Panther)",
        "portrait": "https://cdn.imgchest.com/files/yd5ce5zlmd4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/my8xcoemqx4.png",
            "awareness": "https://cdn.imgchest.com/files/345xcx638m7.png",
            "weapons": "https://cdn.imgchest.com/files/84apca6xvd4.png",
            "teams": "https://cdn.imgchest.com/files/k46acxnwg87.png"
        }
    },
    "riddle": {
        "name": "Haruna Nishimori (Riddle)",
        "portrait": "https://cdn.imgchest.com/files/yq9c3k5nvq4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/e4gdcqdekl4.png",
            "awareness": "https://cdn.imgchest.com/files/345xcx63ld7.png",
            "weapons": "https://cdn.imgchest.com/files/pyvdcmapj6y.png",
            "teams": "https://cdn.imgchest.com/files/b49zcdmxrvy.png"
        }
    },
    "skull": {
        "name": "Ryuji Sakamoto (Skull)",
        "portrait": "https://cdn.imgchest.com/files/4gdcx3vrjw4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/pyvdcmapq5y.png",
            "awareness": "https://cdn.imgchest.com/files/b49zcdmxljy.png",
            "weapons": "https://cdn.imgchest.com/files/w7pjcgzrjj7.png",
            "teams": "https://cdn.imgchest.com/files/j7kzcqd2mp7.png"
        }
    },
    "marian": {
        "name": "Minami Miyashita (Marian)",
        "portrait": "https://cdn.imgchest.com/files/4z9cvq8xz87.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/7mmc9awqe37.png",
            "awareness": "https://cdn.imgchest.com/files/yrgcnxkbe94.png",
            "weapons": "https://cdn.imgchest.com/files/yd5ce5z9dr4.png",
            "teams": "https://cdn.imgchest.com/files/yq9c3k5bo64.png"
        }
    },
    "mont": {
        "name": "Kotone Montagne (Mont)",
        "portrait": "https://cdn.imgchest.com/files/ye3c2vp3qo4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/k46acxne9n7.png",
            "awareness": "https://cdn.imgchest.com/files/6yxkc8bodx7.png",
            "weapons": "https://cdn.imgchest.com/files/l4necdgv2b4.png",
            "teams": "https://cdn.imgchest.com/files/w7pjcgzo997.png"
        }
    },
    "fox": {
        "name": "Yusuke Kitagawa (Fox)",
        "portrait": "https://cdn.imgchest.com/files/7w6c29mo3ey.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/84jdc5k9bo4.png",
            "awareness": "https://cdn.imgchest.com/files/pyq9c9dn6j4.png",
            "weapons": "https://cdn.imgchest.com/files/myd5c6qlb64.png",
            "teams": "https://cdn.imgchest.com/files/3yrgc2ro6l4.png"
        }
    },
    "oracle": {
        "name": "Futaba Sakura (Oracle/Navi)",
        "portrait": "https://cdn.imgchest.com/files/739cxznmje7.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/4jdcvxzagr4.png",
            "awareness": "https://cdn.imgchest.com/files/7lxcpa3v9j7.png",
            "weapons": "https://cdn.imgchest.com/files/y2pckqamp97.png",
            "teams": "https://cdn.imgchest.com/files/y2pckqamp97.png"
        }
    },
    "cherish": {
        "name": "Masaki Ashiya (Cherish)",
        "portrait": "https://cdn.imgchest.com/files/7mmc9aw8697.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/7lxcpa3v3j7.png",
            "awareness": "https://cdn.imgchest.com/files/y2pckqama97.png",
            "weapons": "https://cdn.imgchest.com/files/7kzcap86887.png",
            "teams": "https://cdn.imgchest.com/files/7kzcap86887.png"
        }
    },
    "fleuret": {
        "name": "Seiji Shiratori (Fleuret)",
        "portrait": "https://cdn.imgchest.com/files/yrgcnxkojx4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/46acqlvrvx7.png",
            "awareness": "https://cdn.imgchest.com/files/4apc59lrlr4.png",
            "weapons": "https://cdn.imgchest.com/files/45xcvambml7.png",
            "teams": "https://cdn.imgchest.com/files/y8xcnagzgj4.png"
        }
    },
    "noir": {
        "name": "Haru Okumura (Noir)",
        "portrait": "https://cdn.imgchest.com/files/yd5ce5zlgd4.png",
        "info": {
            "skills_1": "https://cdn.imgchest.com/files/ye3c2voepe4.png",
            "skills_2": "https://cdn.imgchest.com/files/4z9cvq3g857.png",
            "awareness_1": "https://cdn.imgchest.com/files/739cxz5qn27.png",
            "awareness_2": "https://cdn.imgchest.com/files/7w6c29nkmjy.png",
            "weapons": "https://cdn.imgchest.com/files/7mmc9agbw67.png",
            "teams": "https://cdn.imgchest.com/files/4gdcx39gvb4.png",
            "mental_image": "https://cdn.imgchest.com/files/y8xcnagzl64.png",
            "build_strategy": "https://cdn.imgchest.com/files/45xcvambkj7.png"
        }
    },
    "howler": {
        "name": "Runa Dogenzaka (Howler)",
        "portrait": "https://cdn.imgchest.com/files/yq9c3k5n2q4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/4z9cvq3gak7.png",
            "awareness": "https://cdn.imgchest.com/files/ye3c2voexg4.png",
            "weapons": "https://cdn.imgchest.com/files/7w6c29nkevy.png",
            "teams": "https://cdn.imgchest.com/files/7w6c29nkevy.png",
            "mental_image": "https://cdn.imgchest.com/files/739cxz5qp37.png"
        }
    },
    "violet": {
        "name": "Kasumi Yoshizawa (Violet)",
        "portrait": "https://cdn.imgchest.com/files/yq9c3k95oo4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/4jdcvx5wqp4.png",
            "awareness": "https://cdn.imgchest.com/files/7lxcpa8gom7.png",
            "weapons": "https://cdn.imgchest.com/files/7kzcapqem67.png",
            "teams": "https://cdn.imgchest.com/files/7kzcapqem67.png",
            "mental_image": "https://cdn.imgchest.com/files/y2pckqv98v7.png"
        }
    },
    "windvast": {
        "name": "Riko Tanemura (Wind: Vast)",
        "portrait": "https://cdn.imgchest.com/files/7bwckao9xe7.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/4nec8gvekl4.png",
            "awareness": "https://cdn.imgchest.com/files/49zc2moawby.png",
            "weapons": "https://cdn.imgchest.com/files/yxkczbonr27.png",
            "teams": "https://cdn.imgchest.com/files/yxkczbonr27.png"
        }
    },
    "matoi": {
        "name": "Mio Natsukawa (Matoi)",
        "portrait": "https://cdn.imgchest.com/files/ye3c2jodrn4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/4nec8jome24.png",
            "awareness": "https://cdn.imgchest.com/files/yxkczmxgnv7.png",
            "extra": "https://cdn.imgchest.com/files/49zc2pkbapy.png",
            "weapons": "https://cdn.imgchest.com/files/yvdcwe9drby.png",
            "teams": "https://cdn.imgchest.com/files/yvdcwe9drby.png",
            "mental_image": "https://cdn.imgchest.com/files/46acq5vbov7.png"
        }
    },
    "crow": {
        "name": "Akechi Goro (Crow)",
        "portrait": "https://cdn.imgchest.com/files/7w6c2gnvb8y.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/4apc5kl3zz4.png",
            "awareness": "https://cdn.imgchest.com/files/y8xcnwgkxn4.png",
            "extra": "https://cdn.imgchest.com/files/45xcvgm9z67.png",
            "weapons": "https://cdn.imgchest.com/files/4z9cvn3wel7.png",
            "teams": "https://cdn.imgchest.com/files/4z9cvn3wel7.png",
            "mental_image": "https://cdn.imgchest.com/files/4gdcxl9p234.png"
        }
    },
    "turbo": {
        "name": "Mayumi Hashimoto (Turbo)",
        "portrait": "https://cdn.imgchest.com/files/739cxo56ev7.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/7mmc9lgrob7.png",
            "awareness_1": "https://cdn.imgchest.com/files/yrgcnw5zrm4.png",
            "awareness_2": "https://cdn.imgchest.com/files/yd5cex3rq84.png",
            "weapons": "https://cdn.imgchest.com/files/yq9c3paedl4.png",
            "teams": "https://cdn.imgchest.com/files/yq9c3paedl4.png",
            "mental_image": "https://cdn.imgchest.com/files/4jdcvrzjk34.png"
        }
    },
    "ange": {
        "name": "Manaka Nagao (Ange)",
        "portrait": "https://cdn.imgchest.com/files/y2pckxao2o7.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/7kzcao8bdn7.png",
            "awareness": "https://cdn.imgchest.com/files/7ogcbqpkgny.png",
            "weapons": "https://cdn.imgchest.com/files/7pjcq8mwzr7.png",
            "teams": "https://cdn.imgchest.com/files/7pjcq8mwzr7.png",
            "mental_image": "https://cdn.imgchest.com/files/7bwckvjdax7.png"
        }
    },
    "mont_figure_skater": {
        "name": "Kotone Montagne (Mont Figure Skater)",
        "portrait": "https://cdn.imgchest.com/files/45xcvgm9667.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/49zc2pkbmpy.png",
            "awareness": "https://cdn.imgchest.com/files/yvdcwe9daby.png",
            "weapons": "https://cdn.imgchest.com/files/46acq5vbnv7.png",
            "teams": "https://cdn.imgchest.com/files/46acq5vbnv7.png",
            "mental_image": "https://cdn.imgchest.com/files/4apc5kl36z4.png"
        }
    },
    "luce": {
        "name": "Shoki Ikenami (Luce)",
        "portrait": "https://cdn.imgchest.com/files/y8xcnwgken4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/4gdcxl9pd34.png",
            "awareness": "https://cdn.imgchest.com/files/4z9cvn3wvl7.png",
            "weapons": "https://cdn.imgchest.com/files/ye3c2jod2n4.png",
            "teams": "https://cdn.imgchest.com/files/ye3c2jod2n4.png",
            "mental_image": "https://cdn.imgchest.com/files/7w6c2gnv28y.png"
        }
    },
    "cattle": {
        "name": "Lufe (Cattle)",
        "portrait": "https://cdn.imgchest.com/files/yvdcw8ozwmy.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/4apc5noq5j4.png",
            "awareness": "https://cdn.imgchest.com/files/45xcvnwpvr7.png",
            "weapons": "https://cdn.imgchest.com/files/y8xcn98vn54.png",
            "teams": "https://cdn.imgchest.com/files/y8xcn98vn54.png"
        }
    },
    "yuki": {
        "name": "Yukimi Fujikawa (Yuki)",
        "portrait": "https://cdn.imgchest.com/files/4gdcx8rwlq4.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/4z9cvmxjng7.png",
            "awareness": "https://cdn.imgchest.com/files/ye3c2l3wjz4.png",
            "weapons": "https://cdn.imgchest.com/files/739cx8mboj7.png",
            "teams": "https://cdn.imgchest.com/files/7mmc9m8ql37.png"
        }
    },
    "makoto": {
        "name": "Makoto Yuki (Makoto)",
        "portrait": "https://cdn.imgchest.com/files/7lxcpz2jnr7.png",
        "info": {
            "skills": "https://cdn.imgchest.com/files/4nec82vbkk4.png",
            "awareness_1": "https://cdn.imgchest.com/files/7bwck8o3xw7.png",
            "awareness_2": "https://cdn.imgchest.com/files/7pjcq9ob5o7.png",
            "weapons": "https://cdn.imgchest.com/files/7ogcbjnr5vy.png",
            "teams": "https://cdn.imgchest.com/files/y2pcknr3z57.png",
            "mental_image": "https://cdn.imgchest.com/files/7kzcag395b7.png"
        }
    },
    "yukari": {
            "name": "Yukari Takeba",
            "portrait": "https://cdn.imgchest.com/files/yq9c3nan3l4.png",
            "info": {
            "skills_1": "https://cdn.imgchest.com/files/7ogcbnpdvoy.png",
            "skills_2": "https://cdn.imgchest.com/files/7bwckojwbl7.png",
            "awareness_1": "https://cdn.imgchest.com/files/49zc2okxz3y.png",
            "awareness_2": "https://cdn.imgchest.com/files/yvdcwo9p6ny.png",
            "weapons": "https://cdn.imgchest.com/files/45xcvwm3ew7.png",
            "teams": "https://cdn.imgchest.com/files/ye3c23o6bj4.png",
            "mental_image": "https://cdn.imgchest.com/files/4gdcxr9en54.png"
        }
    },
    "rin_lion_dance": {
            "name": "Yaoling Li (Rin Lion Dance)",
            "portrait": "https://cdn.imgchest.com/files/y8xcnwgk254.png",
            "info": {
            "skills": "https://cdn.imgchest.com/files/4gdcxl9poo4.png",
            "awareness": "https://cdn.imgchest.com/files/ye3c2jod8d4.png",
            "weapons": "https://cdn.imgchest.com/files/7w6c2gnvzry.png",
            "teams": "https://cdn.imgchest.com/files/7w6c2gnvzry.png",
            "mental_image": "https://cdn.imgchest.com/files/739cxo56gm7.png"
       }
   }
};
        
function displayCharacters(filter = '') {
    const grid = document.getElementById('characterGrid');
    const lowerCaseFilter = filter.toLowerCase();

    // Filter characters first, then sort
    const filteredCharacters = Object.entries(charactersData).filter(([key, character]) =>
        character.name.toLowerCase().includes(lowerCaseFilter)
    );

    const sortedCharacters = filteredCharacters.sort((a, b) =>
        a[1].name.localeCompare(b[1].name)
    );

    grid.innerHTML = ''; // Clear previous results

    if (sortedCharacters.length === 0) {
        grid.innerHTML = `<p style="color: #ccc; grid-column: 1 / -1; text-align: center; font-size: 1.2rem;">No characters found matching "${filter}".</p>`;
    } else {
        sortedCharacters.forEach(([key, character]) => {
            const card = document.createElement('div');
            card.className = 'character-card';
            card.onclick = () => openModal(key, character);

            card.innerHTML = `
                <img src="${character.portrait}" alt="${character.name}" class="character-portrait" loading="lazy">
                <div class="character-overlay">
                    <div class="character-name">${character.name}</div>
                </div>
            `;
            grid.appendChild(card);
        });
    }
}



// Patch Notes Functions
function openPatchNotes() {
    const modal = document.getElementById('patchNotesModal');
    modal.style.display = 'flex';
    setTimeout(() => modal.classList.add('show'), 10);
}

function closePatchNotes() {
    const modal = document.getElementById('patchNotesModal');
    modal.classList.remove('show');
    setTimeout(() => modal.style.display = 'none', 300);
}

// Add these event listeners to your existing DOMContentLoaded event listener
document.getElementById('patchNotesBtn').onclick = openPatchNotes;
document.getElementById('closePatchNotesBtn').onclick = closePatchNotes;
document.getElementById('patchNotesModal').onclick = (e) => {
    if (e.target.id === 'patchNotesModal') closePatchNotes();
};

// Update the existing keyboard event listener to include patch notes
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        closeZoom();
        closeModal();
        closePatchNotes(); // Add this line to your existing keyboard handler
    }
});

        function openModal(characterKey, character) {
            const modal = document.getElementById('characterModal');
            const modalTitle = document.getElementById('modalTitle');
            const tabsContainer = document.getElementById('tabsContainer');
            const tabContentContainer = document.getElementById('tabContentContainer');

            modalTitle.textContent = character.name;

            // Clear previous content
            tabsContainer.innerHTML = '';
            tabContentContainer.innerHTML = '';

            // Create tabs and content
            const infoEntries = Object.entries(character.info);
            
            infoEntries.forEach(([tabName, imageUrl], index) => {
                // Create tab button
                const tab = document.createElement('button');
                tab.className = `tab ${index === 0 ? 'active' : ''}`;
                tab.textContent = tabName;
                tab.onclick = () => switchTab(tabName);
                tabsContainer.appendChild(tab);

                // Create tab content
                const tabContent = document.createElement('div');
                tabContent.className = `tab-content ${index === 0 ? 'active' : ''}`;
                tabContent.id = `tab-${tabName}`;
                
                const img = document.createElement('img');
                img.src = imageUrl;
                img.alt = `${character.name} - ${tabName}`;
                img.className = 'tab-image';
                img.loading = 'lazy';
                img.onclick = () => zoomImage(imageUrl, `${character.name} - ${tabName}`);
                
                tabContent.appendChild(img);
                tabContentContainer.appendChild(tabContent);
            });

            // Show modal with fade in
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('show'), 10);
        }

        function switchTab(activeTabName) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.toggle('active', tab.textContent === activeTabName);
            });

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.toggle('active', content.id === `tab-${activeTabName}`);
            });
        }

        function closeModal() {
            const modal = document.getElementById('characterModal');
            modal.classList.remove('show');
            setTimeout(() => modal.style.display = 'none', 300);
        }

        function zoomImage(imageUrl, altText) {
            const zoomOverlay = document.getElementById('imageZoomOverlay');
            const zoomedImage = document.getElementById('zoomedImage');
            
            zoomedImage.src = imageUrl;
            zoomedImage.alt = altText;
            
            zoomOverlay.style.display = 'flex';
            setTimeout(() => zoomOverlay.classList.add('show'), 10);
        }

        function closeZoom() {
            const zoomOverlay = document.getElementById('imageZoomOverlay');
            zoomOverlay.classList.remove('show');
            setTimeout(() => {
                zoomOverlay.style.display = 'none';
                // Clear the image source to prevent memory issues
                document.getElementById('zoomedImage').src = '';
            }, 300);
        }

        // Event listeners
        document.getElementById('closeBtn').onclick = closeModal;
        document.getElementById('characterModal').onclick = (e) => {
            if (e.target.id === 'characterModal') closeModal();
        };

        // Keyboard support
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeZoom();
                closeModal();
            }
        });

        // Load characters when DOM is ready
document.addEventListener('DOMContentLoaded', function() {
    // Initial setup and original event listeners from your file
    console.log('DOM loaded, displaying characters...');
    displayCharacters(); // Initial display of all characters
    initMobileSupport(); // Initialize mobile-specific enhancements

    const zoomOverlay = document.getElementById('imageZoomOverlay');
    const zoomedImage = document.getElementById('zoomedImage');
    
    zoomOverlay.addEventListener('click', function(e) {
        if (e.target === zoomOverlay) closeZoom();
    });
    
    zoomedImage.addEventListener('click', function(e) {
        e.stopPropagation();
        closeZoom();
    });

    // Search functionality
    const searchInput = document.getElementById('searchInput');
    const suggestionsContainer = document.getElementById('suggestionsContainer');
    const searchButton = document.getElementById('searchButton');

    const performSearch = () => {
        const query = searchInput.value;
        displayCharacters(query);
        suggestionsContainer.style.display = 'none';
    };

    searchInput.addEventListener('input', () => {
        const query = searchInput.value;
        displayCharacters(query); // Filter grid as user types
        updateSuggestions(query);
    });

    searchInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            performSearch();
        }
    });
    
    searchButton.addEventListener('click', performSearch);

    function updateSuggestions(query) {
        suggestionsContainer.innerHTML = '';
        if (query.length === 0) {
            suggestionsContainer.style.display = 'none';
            return;
        }

        const lowerCaseQuery = query.toLowerCase();
        const suggestions = Object.values(charactersData)
            .map(char => char.name)
            .filter(name => name.toLowerCase().includes(lowerCaseQuery) && name.toLowerCase() !== lowerCaseQuery)
            .sort((a,b) => a.localeCompare(b));

        if (suggestions.length > 0) {
            suggestions.slice(0, 10).forEach(name => {
                const suggestionItem = document.createElement('div');
                suggestionItem.className = 'suggestion-item';
                suggestionItem.textContent = name;
                suggestionItem.addEventListener('click', () => {
                    searchInput.value = name;
                    performSearch();
                });
                suggestionsContainer.appendChild(suggestionItem);
            });
            suggestionsContainer.style.display = 'block';
        } else {
            suggestionsContainer.style.display = 'none';
        }
    }

    // Hide suggestions when clicking outside the search container
    document.addEventListener('click', (e) => {
        if (!e.target.closest('.search-container')) {
            suggestionsContainer.style.display = 'none';
        }
    });
    
    // Header retract/expand functionality
    const header = document.getElementById('mainHeader');
    const toggleHeaderBtn = document.getElementById('toggleHeaderBtn');

    if(header && toggleHeaderBtn) {
        toggleHeaderBtn.addEventListener('click', () => {
            document.body.classList.toggle('header-retracted');
            header.classList.toggle('retracted');
        });
    }
});


// Mobile touch improvements
function initMobileSupport() {
    // Prevent double-tap zoom on buttons and interactive elements
    const preventZoomElements = document.querySelectorAll('.tab, .close-btn, .patch-notes-btn, .character-card');
    
    preventZoomElements.forEach(element => {
        let lastTouchEnd = 0;
        element.addEventListener('touchend', function(event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, {passive: false});
    });

//=========================================================//
//                 CUSTOM CONTEXT MENU LOGIC                 //
//=========================================================//

const contextMenu = document.getElementById('customContextMenu');
let rightClickedElement = null;

// --- Helper Functions for Menu Actions ---

// Function to copy an image to the clipboard
// Note: This requires the image host (cdn.imgchest.com) to allow cross-origin requests.
// If it fails, it will fall back to copying the image URL.
async function copyImageToClipboard(imageUrl) {
    try {
        const response = await fetch(imageUrl);
        const blob = await response.blob();
        await navigator.clipboard.write([
            new ClipboardItem({ [blob.type]: blob })
        ]);
        alert('Image copied to clipboard!'); // Replace with a custom notification if you prefer
    } catch (error) {
        console.error('Failed to copy image:', error);
        // Fallback to copying the URL
        try {
            await navigator.clipboard.writeText(imageUrl);
            alert('Could not copy image directly, image URL copied instead!');
        } catch (urlError) {
            console.error('Failed to copy image URL:', urlError);
            alert('Failed to copy image and URL.');
        }
    }
}

// Function to save an image
// Note: This also depends on the host allowing cross-origin requests.
async function saveImage(imageUrl) {
    try {
        const response = await fetch(imageUrl);
        const blob = await response.blob();
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.style.display = 'none';
        a.href = url;
        // Extract filename from URL or create a generic one
        const filename = imageUrl.split('/').pop() || 'download.png';
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(url);
        document.body.removeChild(a);
    } catch (error) {
        console.error('Failed to save image directly:', error);
        // If direct download fails, open in a new tab as a fallback.
        window.open(imageUrl, '_blank');
    }
}


// --- Main Event Listener for Right-Clicks ---

document.addEventListener('contextmenu', (e) => {
    e.preventDefault(); // Prevent the default browser menu

    rightClickedElement = e.target;
    const isImage = rightClickedElement.tagName === 'IMG';
    
    // Clear previous menu and build the new one
    contextMenu.innerHTML = '';
    const menuList = document.createElement('ul');
    menuList.className = 'context-menu-list';

    let menuItems = [];

    // Add image-specific options if an image was clicked
    if (isImage) {
        menuItems.push(
            { type: 'item', label: 'Open Image in New Tab', icon: 'tab.svg', action: () => window.open(rightClickedElement.src, '_blank') },
            { type: 'item', label: 'Open Image Here', icon: 'open.svg', action: () => window.location.href = rightClickedElement.src },
            { type: 'item', label: 'Copy Image', icon: 'copy.svg', action: () => copyImageToClipboard(rightClickedElement.src) },
            { type: 'item', label: 'Save Image', icon: 'save.svg', action: () => saveImage(rightClickedElement.src) },
            { type: 'separator' }
        );
    }

    // Add general page options
    menuItems.push(
        { type: 'item', label: 'Reload Page', icon: 'reload.svg', action: () => location.reload() },
        { type: 'separator' },
        { type: 'item', label: 'Join our Server!', icon: 'discord.svg', action: () => window.open('https://discord.gg/gachametaverse', '_blank') },
        { type: 'item', label: 'Follow me on YouTube!', icon: 'yt.svg', action: () => window.open('https://www.youtube.com/@mcburn_', '_blank') },
        { type: 'separator' },
        { type: 'item', label: 'View Page Source', icon: 'Source.svg', action: () => window.open('https://www.youtube.com/@bladeciferBCM', '_blank') },
        { type: 'item', label: 'Inspect', icon: 'inspect.svg', action: () => window.open('https://x.com/NajoxP5X', '_blank') }
    );

    // Create and append HTML elements for each menu item
    menuItems.forEach(itemData => {
        if (itemData.type === 'item') {
            const li = document.createElement('li');
            li.className = 'context-menu-item';
            li.innerHTML = `<img src="${itemData.icon}" class="icon" alt=""><span>${itemData.label}</span>`;
            li.addEventListener('click', () => {
                itemData.action();
                contextMenu.classList.remove('active'); // Hide menu after action
            });
            menuList.appendChild(li);
        } else if (itemData.type === 'separator') {
            const separator = document.createElement('div');
            separator.className = 'context-menu-separator';
            menuList.appendChild(separator);
        }
    });

    contextMenu.appendChild(menuList);

    // Position and display the menu
    const { clientX: mouseX, clientY: mouseY } = e;
    const { normalizedX, normalizedY } = normalizePozition(mouseX, mouseY);
    contextMenu.style.top = `${normalizedY}px`;
    contextMenu.style.left = `${normalizedX}px`;
    contextMenu.classList.add('active');
});

// Hide menu when clicking anywhere else on the page
document.addEventListener('click', () => {
    contextMenu.classList.remove('active');
});

// Helper to prevent the menu from opening off-screen
function normalizePozition(mouseX, mouseY) {
    const { innerWidth: windowWidth, innerHeight: windowHeight } = window;
    const { offsetWidth: menuWidth, offsetHeight: menuHeight } = contextMenu;

    let normalizedX = mouseX;
    let normalizedY = mouseY;

    if (mouseX + menuWidth > windowWidth) {
        normalizedX = windowWidth - menuWidth - 10;
    }
    if (mouseY + menuHeight > windowHeight) {
        normalizedY = windowHeight - menuHeight - 10;
    }
    return { normalizedX, normalizedY };
}

//=========================================================//
//                   THEME SWITCHER LOGIC                  //
//=========================================================//

const themes = [
    { name: 'Joker Red', className: 'theme-red', color: '#ff0000', flavor: '>> Show me your true form!'},
    { name: 'Fox Blue', className: 'theme-blue', color: '#0055ff', flavor: '>> An aesthetic choice, indeed.'},
    { name: 'Oracle Green', className: 'theme-green', color: '#00ff00', flavor: '>> Key item get! Hacking into the mainframe...'},
    { name: 'Skull Yellow', className: 'theme-yellow', color: '#ffdd00', flavor: ">> For real?! This new look is awesome!"},
    { name: 'Panther Pink', className: 'theme-pink', color: '#ff5599', flavor: '>> A beautiful choice! It suits you.'},
    { name: 'Noir Purple', className: 'theme-purple', color: '#aa00ff', flavor: '>> How wonderful! A truly elegant palette.'}
];

const themeSwitcherContainer = document.getElementById('themeSwitcherContainer');
const body = document.body;
let notificationTimeout;

// --- Functions ---
// REPLACE your existing applyTheme function with this one
function applyTheme(themeClassName) {
    const htmlElement = document.documentElement; // The <html> element
    const bodyElement = document.body;

    // Remove any existing theme classes from BOTH html and body
    themes.forEach(t => {
        htmlElement.classList.remove(t.className);
        bodyElement.classList.remove(t.className);
    });

    // Add the new theme class to BOTH html and body
    htmlElement.classList.add(themeClassName);
    bodyElement.classList.add(themeClassName);

    localStorage.setItem('p5x-user-theme', themeClassName);

    // Update active state on buttons
    document.querySelectorAll('.theme-button').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.theme === themeClassName);
    });
}

function showThemeNotification(theme) {
    const notificationBox = document.getElementById('themeNotification');
    const flavorTextElem = document.getElementById('notificationFlavorText');
    const mainTextElem = document.getElementById('notificationMainText');

    // Set text and show
    flavorTextElem.textContent = theme.flavor;
    mainTextElem.textContent = 'Switched theme to: ' + theme.name;
    notificationBox.classList.add('show');

    // Clear previous timeout and set a new one
    clearTimeout(notificationTimeout);
    notificationTimeout = setTimeout(() => {
        notificationBox.classList.remove('show');
    }, 3000); // Message fades out after 3 seconds
}

// --- Initialization ---

// Create and append theme buttons
themes.forEach(theme => {
    const button = document.createElement('div');
    button.className = 'theme-button';
    button.style.backgroundColor = theme.color;
    button.dataset.theme = theme.className;
    button.title = theme.name; // Tooltip on hover

    button.addEventListener('click', () => {
        applyTheme(theme.className);
        showThemeNotification(theme);
    });

    themeSwitcherContainer.appendChild(button);
});

// On page load, apply the saved theme from localStorage
const savedTheme = localStorage.getItem('p5x-user-theme') || 'theme-red';
applyTheme(savedTheme);

    // Improve modal positioning on mobile orientation change
    window.addEventListener('orientationchange', function() {
        setTimeout(() => {
            const modal = document.getElementById('characterModal');
            const patchModal = document.getElementById('patchNotesModal');
            if (modal.classList.contains('show') || patchModal.classList.contains('show')) {
                // Force recalculation of modal positioning
                document.body.style.height = window.innerHeight + 'px';
                setTimeout(() => {
                    document.body.style.height = '';
                }, 100);
            }
        }, 500);
    });
}

//=========================================================//
//           FUTABA'S DEVTOOLS DETECTION TRAP              //
//=========================================================//
(function() {
    const redirectUrl = 'https://mcburnr.github.io/haha.html';
    const detectionThreshold = 160; // Time in milliseconds.

    let isRedirecting = false;

    // The main function to trigger the redirect
    function triggerRedirect() {
        if (isRedirecting) {
            return;
        }
        isRedirecting = true;
        // A little message from Futaba before the page changes!
        console.log('%c! INTRUSION DETECTED !', 'color: #00ff00; font-size: 24px; font-weight: bold; font-family: monospace;');
        console.log('%c>> Whoa, trying to peek under the hood? Naughty, naughty! Let me just... fix that for you. Heh. <<', 'color: #00ff00; font-family: monospace;');
        window.location.href = redirectUrl;
    }

    // --- TRAP 1: The Debugger Time Check ---
    // This runs periodically. If devtools are open, the 'debugger' line will cause a pause.
    // When execution resumes, we check how long the pause was.
    setInterval(() => {
        const startTime = performance.now();
        debugger;
        const endTime = performance.now();
        if (endTime - startTime > detectionThreshold) {
            triggerRedirect();
        }
    }, 1000);


    // --- TRAP 2: The Console Log Object Getter ---
    // We create a special object. When the console tries to display its properties,
    // it will execute the 'get' function, triggering our redirect.
    const devtoolsTrapElement = document.createElement('div');
    Object.defineProperty(devtoolsTrapElement, 'id', {
        get: function() {
            triggerRedirect();
            // Return a dummy value for the console to display
            return 'YOU-HAVE-BEEN-HACKED';
        }
    });

    setInterval(() => {
        // Periodically log our special object to the console.
        // This is silent if the console is closed, but springs the trap if it's open.
        console.log(devtoolsTrapElement);
        // We clear the console immediately to make the trap less obvious.
        console.clear();
    }, 1500);

})();

    </script>
	
	<!-- === Custom Context Menu === -->
<div id="customContextMenu">
    <!-- Menu items will be dynamically added here by JavaScript -->
</div>


<div id="themeNotification">
    <div id="notificationFlavorText"></div>
    <div id="notificationMainText"></div>
</div>

</body>
</html>